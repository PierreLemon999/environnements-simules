<!-- [MockupForge] Ce fichier HTML est une maquette geree par MockupForge, un outil de gestion et d'annotation de maquettes. Le contenu ci-dessous est la maquette a analyser, iterer ou implementer. Les elements de l'interface MockupForge (header, navigation, panneaux lateraux) ne font PAS partie de cette maquette et doivent etre ignores par les IA. -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arborescence v6 â€” Environnements Simules</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ===== Reset ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #f8f8f8;
  --surface: #ffffff;
  --accent: #2563eb;
  --accent-hover: #1d4ed8;
  --accent-light: #dbeafe;
  --text: #0c0a09;
  --text-secondary: #78716c;
  --text-muted: #a8a29e;
  --border: #e7e5e4;
  --border-light: #f0eeee;
  --success: #16a34a;
  --warning: #f59e0b;
  --danger: #dc2626;
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --green-bg: #f0fdf4;
  --green-border: #bbf7d0;
  --amber-bg: #fffbeb;
  --amber-border: #fde68a;
  --red-bg: #fef2f2;
  --red-border: #fecaca;
  --shadow-xs: 0 1px 2px rgba(0,0,0,.04);
  --shadow-sm: 0 1px 3px rgba(0,0,0,.08);
  --shadow-md: 0 4px 6px -1px rgba(0,0,0,.07), 0 2px 4px -2px rgba(0,0,0,.05);
  --shadow-lg: 0 20px 40px -4px rgba(0,0,0,.1);
  --font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  --mono: 'SF Mono', 'JetBrains Mono', 'Fira Code', ui-monospace, monospace;
  --transition: .2s cubic-bezier(.4,0,.2,1);
  --transition-fast: .15s cubic-bezier(.4,0,.2,1);
  --transition-smooth: .35s cubic-bezier(.22,1,.36,1);
}

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  font-size: 14px;
  line-height: 1.5;
  display: flex;
  height: 100vh;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===== Scrollbar ===== */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(0,0,0,.1); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,.18); }

/* ===== ANIMATIONS ===== */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes fadeUp {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes slideIn {
  from { opacity: 0; transform: translateY(-4px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes healthPulseWarn {
  0%, 100% { box-shadow: 0 0 0 2px var(--amber-bg); }
  50% { box-shadow: 0 0 0 4px var(--amber-bg), 0 0 6px rgba(245,158,11,.15); }
}
@keyframes healthPulseError {
  0%, 100% { box-shadow: 0 0 0 2px var(--red-bg); }
  50% { box-shadow: 0 0 0 4px var(--red-bg), 0 0 8px rgba(220,38,38,.2); }
}

/* ===== ICON SIDEBAR (48px) ===== */
.icon-sidebar {
  width: 48px;
  min-width: 48px;
  background: #1c1917;
  border-right: 1px solid rgba(255,255,255,.06);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px 0;
  gap: 2px;
  z-index: 10;
  animation: fadeIn .3s ease;
}
.icon-sidebar-logo {
  width: 30px;
  height: 30px;
  background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 700;
  font-size: 11px;
  margin-bottom: 16px;
  box-shadow: 0 1px 3px rgba(37,99,235,.3);
  flex-shrink: 0;
}
.icon-sidebar-btn {
  width: 32px;
  height: 32px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: rgba(255,255,255,.4);
  transition: all var(--transition-fast);
  position: relative;
}
.icon-sidebar-btn:hover {
  background: rgba(255,255,255,.08);
  color: rgba(255,255,255,.7);
}
.icon-sidebar-btn.active {
  background: rgba(37,99,235,.25);
  color: #93b4f8;
}
.icon-sidebar-btn svg { width: 18px; height: 18px; }
.icon-sidebar-spacer { flex: 1; }

/* Sidebar tooltip */
.icon-sidebar-btn[title] { position: relative; }
.icon-sidebar-btn::after {
  content: attr(title);
  position: absolute;
  left: calc(100% + 8px);
  top: 50%;
  transform: translateY(-50%) scale(.92);
  padding: 4px 10px;
  border-radius: var(--radius-sm);
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  background: #292524;
  color: #e7e5e4;
  pointer-events: none;
  opacity: 0;
  transition: all var(--transition-fast);
  z-index: 100;
}
.icon-sidebar-btn:hover::after {
  opacity: 1;
  transform: translateY(-50%) scale(1);
}

/* ===== TREE PANEL (resizable) ===== */
.tree-panel {
  width: 320px;
  min-width: 240px;
  max-width: 600px;
  background: var(--surface);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  animation: fadeIn .3s ease .05s both;
  position: relative;
}

/* Resize handle */
.resize-handle {
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 6px;
  cursor: col-resize;
  z-index: 100;
  background: transparent;
  transition: background var(--transition-fast);
}

.resize-handle::before {
  content: '';
  position: absolute;
  right: 2px;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 40px;
  background: transparent;
  border-radius: 2px;
  transition: all var(--transition-fast);
}

.resize-handle:hover::before {
  background: rgba(37,99,235,.2);
  background-image: repeating-linear-gradient(
    0deg,
    rgba(37,99,235,.4),
    rgba(37,99,235,.4) 2px,
    transparent 2px,
    transparent 4px
  );
}

.resize-handle.dragging {
  background: rgba(37,99,235,.08);
}

.resize-handle.dragging::before {
  background: rgba(37,99,235,.5);
  height: 100%;
  box-shadow: 0 0 8px rgba(37,99,235,.3);
}

/* Panel header */
.tree-header {
  padding: 14px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border);
  min-height: 52px;
}
.tree-header-title {
  font-size: 14px;
  font-weight: 600;
  letter-spacing: -.2px;
}
.tree-header-add {
  width: 28px;
  height: 28px;
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--text-muted);
  transition: all var(--transition-fast);
  border: 1px solid var(--border);
  background: var(--surface);
}
.tree-header-add:hover {
  background: rgba(0,0,0,.03);
  color: var(--text);
  border-color: #d4d4d4;
  transform: translateY(-1px);
  box-shadow: var(--shadow-xs);
}
.tree-header-add svg { width: 14px; height: 14px; }

/* ===== TABS ===== */
.tree-tabs-wrapper {
  display: flex;
  padding: 8px 12px;
  border-bottom: 1px solid var(--border);
  gap: 4px;
}
.tree-tab {
  padding: 6px 12px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  color: var(--text-muted);
  border-radius: var(--radius-sm);
  transition: all var(--transition);
  user-select: none;
  white-space: nowrap;
}
.tree-tab:hover:not(.active) { color: var(--text-secondary); background: rgba(0,0,0,.02); }
.tree-tab.active { color: #fff; background: var(--text); }

/* ===== TAB CONTENT PANELS ===== */
.tab-panel { display: none; flex-direction: column; flex: 1; overflow: hidden; }
.tab-panel.active { display: flex; animation: fadeIn .25s ease; }

/* ===== TAB 1: ARBORESCENCE ===== */

/* Quick stats bar */
.stats-bar {
  padding: 8px 12px;
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 11px;
  color: var(--text-secondary);
  border-bottom: 1px solid var(--border-light);
  background: #fafaf9;
  flex-shrink: 0;
}
.stats-item {
  display: flex;
  align-items: center;
  gap: 5px;
  font-weight: 500;
}
.stats-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}
.stats-dot.pages { background: var(--accent); }
.stats-dot.modals { background: #8b5cf6; }
.stats-dot.errors { background: var(--danger); }

/* Search wrapper */
.tree-search-wrapper {
  padding: 8px 12px;
  border-bottom: 1px solid var(--border-light);
  position: relative;
  flex-shrink: 0;
}
.tree-search {
  width: 100%;
  padding: 7px 10px 7px 32px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-family: var(--font);
  outline: none;
  background: #f5f5f4;
  color: var(--text);
  transition: all var(--transition-fast);
}
.tree-search::placeholder { color: var(--text-muted); }
.tree-search:focus {
  border-color: var(--accent);
  background: var(--surface);
  box-shadow: 0 0 0 3px rgba(37,99,235,.08);
}
.tree-search-icon {
  position: absolute;
  left: 22px;
  top: 50%;
  transform: translateY(-50%);
  width: 14px;
  height: 14px;
  color: var(--text-muted);
  pointer-events: none;
}

/* Tree content */
.tree-content {
  flex: 1;
  overflow-y: auto;
  padding: 4px 0;
}

/* Tree group */
.tree-group { margin-bottom: 1px; }
.tree-group-header {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 12px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-secondary);
  transition: background var(--transition-fast);
  user-select: none;
}
.tree-group-header:hover { background: rgba(0,0,0,.03); }
.tree-group-header .chevron {
  width: 14px;
  height: 14px;
  color: var(--text-muted);
  transition: transform var(--transition-smooth);
  flex-shrink: 0;
}
.tree-group-header .chevron.open { transform: rotate(90deg); }
.tree-group-header .group-icon {
  width: 16px;
  height: 16px;
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  flex-shrink: 0;
}
.tree-group-header .group-name {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.tree-group-header .group-count {
  font-weight: 400;
  color: var(--text-muted);
  font-size: 11px;
  flex-shrink: 0;
}

/* Tree items container */
.tree-group-items {
  overflow: hidden;
  transition: max-height var(--transition-smooth), opacity .25s ease;
  max-height: 800px;
  opacity: 1;
}
.tree-group-items.collapsed {
  max-height: 0;
  opacity: 0;
  pointer-events: none;
}

/* Staggered slide-in */
.tree-group-items:not(.collapsed) .tree-item,
.tree-group-items:not(.collapsed) .tree-modal-item,
.tree-group-items:not(.collapsed) .tree-more {
  animation: slideIn var(--transition-smooth) ease both;
}
.tree-group-items:not(.collapsed) > :nth-child(1) { animation-delay: 0s; }
.tree-group-items:not(.collapsed) > :nth-child(2) { animation-delay: .03s; }
.tree-group-items:not(.collapsed) > :nth-child(3) { animation-delay: .05s; }
.tree-group-items:not(.collapsed) > :nth-child(4) { animation-delay: .07s; }
.tree-group-items:not(.collapsed) > :nth-child(5) { animation-delay: .09s; }
.tree-group-items:not(.collapsed) > :nth-child(6) { animation-delay: .11s; }
.tree-group-items:not(.collapsed) > :nth-child(7) { animation-delay: .13s; }

/* Tree item (page) */
.tree-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px 6px 36px;
  cursor: pointer;
  font-size: 13px;
  color: var(--text-secondary);
  transition: all var(--transition-fast);
  position: relative;
}
.tree-item:hover { background: rgba(0,0,0,.03); color: var(--text); }
.tree-item.active {
  background: var(--accent-light);
  color: var(--accent);
  font-weight: 500;
}
.tree-item.active::before {
  content: '';
  position: absolute;
  left: 0; top: 2px; bottom: 2px;
  width: 2px;
  background: var(--accent);
  border-radius: 0 1px 1px 0;
}
.tree-item .page-icon {
  width: 15px;
  height: 15px;
  flex-shrink: 0;
  opacity: .5;
}
.tree-item.active .page-icon { opacity: .8; }
.tree-item .page-name {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Health dot */
.health-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  flex-shrink: 0;
}
.health-dot.ok { background: var(--success); box-shadow: 0 0 0 2px var(--green-bg); }
.health-dot.warn { background: var(--warning); box-shadow: 0 0 0 2px var(--amber-bg); animation: healthPulseWarn 2.5s cubic-bezier(.4,0,.6,1) infinite; }
.health-dot.error { background: var(--danger); box-shadow: 0 0 0 2px var(--red-bg); animation: healthPulseError 1.8s cubic-bezier(.4,0,.6,1) infinite; }

/* More button on hover */
.item-more {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  cursor: pointer;
  color: var(--text-muted);
  transition: all var(--transition-fast);
  flex-shrink: 0;
}
.tree-item:hover .item-more,
.tree-modal-item:hover .item-more { opacity: 1; }
.item-more:hover { background: rgba(0,0,0,.06); color: var(--text); }
.item-more svg { width: 14px; height: 14px; }

/* Modal sub-item */
.tree-modal-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 5px 12px 5px 52px;
  cursor: pointer;
  font-size: 12px;
  color: var(--text-muted);
  transition: all var(--transition-fast);
  position: relative;
}
.tree-modal-item:hover { background: rgba(0,0,0,.03); color: var(--text-secondary); }
.tree-modal-item .modal-icon {
  width: 13px;
  height: 13px;
  flex-shrink: 0;
  opacity: .45;
}
.tree-modal-item .modal-name {
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.modal-badge {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  padding: 1px 6px;
  border-radius: 10px;
  font-size: 10px;
  font-weight: 500;
  background: #f3e8ff;
  color: #7c3aed;
  flex-shrink: 0;
}
.modal-badge svg { width: 10px; height: 10px; }

/* "... et X autres pages" link */
.tree-more {
  padding: 5px 12px 5px 52px;
  font-size: 11px;
  color: var(--accent);
  cursor: pointer;
  transition: color var(--transition-fast);
  font-weight: 500;
}
.tree-more:hover { color: var(--accent-hover); text-decoration: underline; }

/* Breadcrumb at bottom */
.tree-breadcrumb {
  padding: 10px 12px;
  border-top: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--text-muted);
  background: #fafaf9;
  flex-shrink: 0;
}
.tree-breadcrumb .crumb { cursor: pointer; transition: color var(--transition-fast); }
.tree-breadcrumb .crumb:hover { color: var(--text-secondary); }
.tree-breadcrumb .crumb-active { color: var(--text); font-weight: 500; }
.tree-breadcrumb .crumb-sep { opacity: .4; }

/* ===== CONTEXT MENU ===== */
.context-menu {
  position: fixed;
  z-index: 999;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  box-shadow: 0 8px 30px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06);
  padding: 4px;
  min-width: 180px;
  display: none;
  animation: fadeUp .15s ease;
}
.context-menu.visible { display: block; }
.context-menu-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 7px 12px;
  font-size: 12px;
  color: var(--text-secondary);
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: all var(--transition-fast);
}
.context-menu-item:hover { background: var(--accent-light); color: var(--accent); }
.context-menu-item.danger:hover { background: var(--red-bg); color: var(--danger); }
.context-menu-item svg { width: 14px; height: 14px; opacity: .6; flex-shrink: 0; }
.context-menu-item:hover svg { opacity: 1; }
.context-menu-sep { height: 1px; background: var(--border); margin: 4px 8px; }

/* ===== TAB 2: LISTE ===== */

/* Filter chips */
.list-filters {
  padding: 8px 12px;
  display: flex;
  gap: 6px;
  border-bottom: 1px solid var(--border-light);
  flex-shrink: 0;
  flex-wrap: wrap;
}
.filter-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text-secondary);
  transition: all var(--transition-fast);
  user-select: none;
}
.filter-chip:hover { border-color: #d4d4d4; background: rgba(0,0,0,.02); }
.filter-chip.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}
.filter-chip .chip-count {
  font-size: 10px;
  padding: 0 5px;
  border-radius: 8px;
  background: rgba(0,0,0,.06);
  font-weight: 600;
}
.filter-chip.active .chip-count {
  background: rgba(255,255,255,.2);
}

/* Table */
.list-table-wrapper {
  flex: 1;
  overflow-y: auto;
}
.list-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}
.list-table thead {
  position: sticky;
  top: 0;
  z-index: 2;
  background: #fafaf9;
}
.list-table th {
  padding: 8px 10px;
  text-align: left;
  font-weight: 600;
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: .3px;
  border-bottom: 1px solid var(--border);
  white-space: nowrap;
  cursor: pointer;
  user-select: none;
  transition: color var(--transition-fast);
}
.list-table th:hover { color: var(--text-secondary); }
.list-table th .sort-arrow { font-size: 10px; margin-left: 2px; }
.list-table td {
  padding: 6px 10px;
  border-bottom: 1px solid var(--border-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 120px;
  color: var(--text-secondary);
}
.list-table tr { height: 32px; cursor: pointer; transition: background var(--transition-fast); }
.list-table tbody tr:hover { background: rgba(0,0,0,.02); }
.list-table tbody tr.active { background: var(--accent-light); }
.list-table .td-status { width: 32px; text-align: center; }
.list-table .td-name { font-weight: 500; color: var(--text); max-width: 130px; }
.list-table .td-section { max-width: 80px; }
.list-table .td-type { width: 70px; }
.list-table .td-date { width: 80px; font-variant-numeric: tabular-nums; }

.type-badge {
  display: inline-flex;
  align-items: center;
  padding: 1px 7px;
  border-radius: 10px;
  font-size: 10px;
  font-weight: 500;
}
.type-badge.page { background: var(--accent-light); color: var(--accent); }
.type-badge.modale { background: #f3e8ff; color: #7c3aed; }

/* ===== TAB 3: CARTE DU SITE ===== */
.sitemap-wrapper {
  flex: 1;
  overflow: hidden;
  position: relative;
  background: var(--bg);
}
.sitemap-canvas {
  width: 100%;
  height: 100%;
  position: relative;
  transition: transform .3s ease;
  transform-origin: center center;
}
.sitemap-node {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: 10px;
  font-weight: 500;
  background: var(--surface);
  border: 2px solid var(--border);
  border-radius: var(--radius-md);
  padding: 6px 10px;
  cursor: pointer;
  transition: all var(--transition-fast);
  box-shadow: var(--shadow-sm);
  z-index: 2;
  white-space: nowrap;
}
.sitemap-node:hover { transform: scale(1.05); box-shadow: var(--shadow-md); z-index: 3; }
.sitemap-node.center {
  font-size: 12px;
  font-weight: 700;
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
  padding: 10px 18px;
  border-radius: var(--radius-lg);
}
.sitemap-node.section {
  font-weight: 600;
  background: var(--surface);
  border-color: var(--accent);
  color: var(--accent);
}
.sitemap-node.modal {
  border-style: dashed;
  border-color: #a78bfa;
  font-size: 9px;
  padding: 4px 8px;
  color: #7c3aed;
}
.sitemap-node.error { border-color: var(--danger); }
.sitemap-node.warning { border-color: var(--warning); }

/* CSS lines connecting nodes */
.sitemap-line {
  position: absolute;
  background: var(--border);
  z-index: 1;
  transform-origin: 0 0;
}

/* Zoom controls */
.sitemap-zoom {
  position: absolute;
  bottom: 12px;
  right: 12px;
  display: flex;
  flex-direction: column;
  gap: 2px;
  z-index: 10;
}
.zoom-btn {
  width: 30px;
  height: 30px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  background: var(--surface);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-secondary);
  transition: all var(--transition-fast);
  box-shadow: var(--shadow-sm);
}
.zoom-btn:hover { background: rgba(0,0,0,.03); color: var(--text); transform: translateY(-1px); box-shadow: var(--shadow-md); }

/* Legend */
.sitemap-legend {
  position: absolute;
  bottom: 12px;
  left: 12px;
  display: flex;
  gap: 12px;
  font-size: 10px;
  color: var(--text-muted);
  background: rgba(255,255,255,.9);
  padding: 6px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  z-index: 10;
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
}
.legend-box {
  width: 16px;
  height: 10px;
  border: 2px solid var(--border);
  border-radius: 3px;
}
.legend-box.page { border-color: var(--accent); border-style: solid; }
.legend-box.modale { border-color: #a78bfa; border-style: dashed; }
.legend-box.erreur { border-color: var(--danger); border-style: solid; }

/* ===== MAIN PREVIEW AREA ===== */
.main-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-width: 0;
  animation: fadeIn .4s ease .1s both;
}
.preview-topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 20px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  min-height: 48px;
  gap: 16px;
}
.preview-breadcrumb {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  color: var(--text-muted);
}
.preview-breadcrumb .crumb {
  white-space: nowrap;
  cursor: pointer;
  transition: color var(--transition-fast);
}
.preview-breadcrumb .crumb:hover { color: var(--text-secondary); }
.preview-breadcrumb .crumb-active { color: var(--text); font-weight: 500; }
.preview-breadcrumb .crumb-sep { opacity: .4; font-size: 11px; }

.preview-actions { display: flex; gap: 6px; flex-shrink: 0; }
.preview-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: var(--surface);
  font-size: 12px;
  font-weight: 500;
  font-family: var(--font);
  cursor: pointer;
  color: var(--text-secondary);
  transition: all var(--transition-fast);
  white-space: nowrap;
  box-shadow: var(--shadow-xs);
}
.preview-btn:hover {
  background: rgba(0,0,0,.03);
  border-color: #d4d4d4;
  color: var(--text);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}
.preview-btn svg { width: 14px; height: 14px; }
.preview-btn.primary {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
  box-shadow: 0 1px 3px rgba(37,99,235,.3);
}
.preview-btn.primary:hover { background: var(--accent-hover); border-color: var(--accent-hover); box-shadow: 0 4px 12px rgba(37,99,235,.3); }

/* Preview viewport */
.preview-viewport {
  flex: 1;
  display: flex;
  background: #ebebeb;
  overflow: hidden;
  padding: 20px;
}
.browser-frame {
  flex: 1;
  background: var(--surface);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border: 1px solid rgba(0,0,0,.06);
}
.browser-chrome {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  background: #f5f5f4;
  border-bottom: 1px solid var(--border);
}
.browser-dots { display: flex; gap: 5px; flex-shrink: 0; }
.browser-dots span { width: 10px; height: 10px; border-radius: 50%; }
.browser-dots span:nth-child(1) { background: #ff5f57; }
.browser-dots span:nth-child(2) { background: #ffbd2e; }
.browser-dots span:nth-child(3) { background: #28c840; }
.browser-url-bar {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 12px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  font-size: 12px;
  font-family: var(--mono);
  color: var(--text-muted);
}
.url-protocol { color: var(--success); }
.url-domain { color: var(--text); font-weight: 500; }

.browser-content {
  flex: 1;
  overflow-y: auto;
  background: #f4f6f9;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
}
.preview-placeholder {
  text-align: center;
  color: var(--text-muted);
}
.preview-placeholder-icon {
  width: 48px;
  height: 48px;
  margin: 0 auto 12px;
  background: var(--border-light);
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
}
.preview-placeholder-icon svg { width: 24px; height: 24px; color: var(--text-muted); }
.preview-placeholder h3 {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 4px;
}
.preview-placeholder p {
  font-size: 12px;
  line-height: 1.5;
}

/* Simulated page skeleton */
.page-skeleton { width: 100%; max-width: 500px; }
.skel-bar {
  height: 10px;
  background: #e2e0de;
  border-radius: 4px;
  margin-bottom: 8px;
}
.skel-bar.title { height: 16px; width: 60%; margin-bottom: 16px; background: #d4d2cf; }
.skel-bar.w80 { width: 80%; }
.skel-bar.w60 { width: 60%; }
.skel-bar.w90 { width: 90%; }
.skel-bar.w45 { width: 45%; }
.skel-bar.w70 { width: 70%; }
.skel-block {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-top: 16px;
}
.skel-card {
  height: 60px;
  background: #e8e6e3;
  border-radius: var(--radius-sm);
}
</style>
</head>
<body>

<!-- ===== ICON SIDEBAR ===== -->
<aside class="icon-sidebar">
  <div class="icon-sidebar-logo">ES</div>

  <div class="icon-sidebar-btn" title="Tableau de bord">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1.5"/><rect x="14" y="3" width="7" height="7" rx="1.5"/><rect x="3" y="14" width="7" height="7" rx="1.5"/><rect x="14" y="14" width="7" height="7" rx="1.5"/></svg>
  </div>

  <div class="icon-sidebar-btn" title="Projets">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
  </div>

  <div class="icon-sidebar-btn active" title="Arborescence">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.66 0 3-4.03 3-9s-1.34-9-3-9m0 18c-1.66 0-3-4.03-3-9s1.34-9 3-9"/></svg>
  </div>

  <div class="icon-sidebar-btn" title="Analytique">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20V10M6 20V4M18 20v-6"/></svg>
  </div>

  <div class="icon-sidebar-btn" title="Parametres">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 11-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 11-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 110-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 114 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 110 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
  </div>

  <div class="icon-sidebar-spacer"></div>
</aside>

<!-- ===== TREE PANEL ===== -->
<div class="tree-panel" id="treePanel">
  <!-- Resize handle -->
  <div class="resize-handle" id="resizeHandle"></div>

  <!-- Header -->
  <div class="tree-header">
    <div class="tree-header-title">Salesforce &mdash; D&eacute;mo Q1</div>
    <div class="tree-header-add" title="Ajouter une page">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tree-tabs-wrapper">
    <div class="tree-tab active" data-tab="arborescence">Arborescence</div>
    <div class="tree-tab" data-tab="liste">Liste</div>
    <div class="tree-tab" data-tab="carte">Carte du site</div>
  </div>

  <!-- ===== TAB 1: ARBORESCENCE ===== -->
  <div class="tab-panel active" id="tab-arborescence">
    <!-- Stats bar -->
    <div class="stats-bar">
      <div class="stats-item"><span class="stats-dot pages"></span>86 pages</div>
      <div class="stats-item"><span class="stats-dot modals"></span>12 modales</div>
      <div class="stats-item"><span class="stats-dot errors"></span>3 erreurs</div>
    </div>

    <!-- Search -->
    <div class="tree-search-wrapper">
      <svg class="tree-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
      <input class="tree-search" type="text" placeholder="Filtrer les pages...">
    </div>

    <!-- Tree -->
    <div class="tree-content">

      <!-- Accueil (8) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#dbeafe;color:#2563eb;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
          </span>
          <span class="group-name">Accueil</span>
          <span class="group-count">(8)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Page d'accueil</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Tableau de bord</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Notifications</span>
            <span class="health-dot warn"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M8 2v4M16 2v4"/></svg>
            <span class="modal-name">Bienvenue</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 4 autres pages</div>
        </div>
      </div>

      <!-- Contacts (14) - EXPANDED (contains active item) -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron open" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#dcfce7;color:#16a34a;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4-4v2"/><circle cx="9" cy="7" r="4"/></svg>
          </span>
          <span class="group-name">Contacts</span>
          <span class="group-count">(14)</span>
        </div>
        <div class="tree-group-items">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Liste des contacts</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item active">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Fiche client</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Nouveau contact</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Historique</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Import contacts</span>
            <span class="health-dot error"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Confirmer suppression</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 8 autres pages</div>
        </div>
      </div>

      <!-- Opportunites (18) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#fef3c7;color:#d97706;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
          </span>
          <span class="group-name">Opportunit&eacute;s</span>
          <span class="group-count">(18)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Pipeline</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">D&eacute;tail opportunit&eacute;</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Pr&eacute;visions</span>
            <span class="health-dot warn"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Cr&eacute;er opportunit&eacute;</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 14 autres pages</div>
        </div>
      </div>

      <!-- Rapports (12) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#ede9fe;color:#7c3aed;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><path d="M12 20V10M6 20V4M18 20v-6"/></svg>
          </span>
          <span class="group-name">Rapports</span>
          <span class="group-count">(12)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Rapports g&eacute;n&eacute;raux</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Rapport personnalis&eacute;</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Export donn&eacute;es</span>
            <span class="health-dot error"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 9 autres pages</div>
        </div>
      </div>

      <!-- Parametres (6) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#f5f5f4;color:#78716c;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33"/></svg>
          </span>
          <span class="group-name">Param&egrave;tres</span>
          <span class="group-count">(6)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">G&eacute;n&eacute;ral</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">S&eacute;curit&eacute;</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 4 autres pages</div>
        </div>
      </div>

      <!-- Dashboard (10) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#e0f2fe;color:#0284c7;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          </span>
          <span class="group-name">Dashboard</span>
          <span class="group-count">(10)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Vue d'ensemble</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">KPI mensuels</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Filtrer p&eacute;riode</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 7 autres pages</div>
        </div>
      </div>

      <!-- Facturation (8) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#fce7f3;color:#db2777;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><rect x="1" y="4" width="22" height="16" rx="2"/><path d="M1 10h22"/></svg>
          </span>
          <span class="group-name">Facturation</span>
          <span class="group-count">(8)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Factures</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">D&eacute;tail facture</span>
            <span class="health-dot warn"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Nouveau paiement</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 5 autres pages</div>
        </div>
      </div>

      <!-- Support (10) - collapsed -->
      <div class="tree-group">
        <div class="tree-group-header" onclick="toggleGroup(this)">
          <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
          <span class="group-icon" style="background:#ccfbf1;color:#0d9488;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="10" height="10"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>
          </span>
          <span class="group-name">Support</span>
          <span class="group-count">(10)</span>
        </div>
        <div class="tree-group-items collapsed">
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">Tickets ouverts</span>
            <span class="health-dot ok"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-item">
            <svg class="page-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14,2 14,8 20,8"/></svg>
            <span class="page-name">D&eacute;tail ticket</span>
            <span class="health-dot error"></span>
            <span class="item-more" onclick="showContextMenu(event)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="12" cy="19" r="1"/></svg></span>
          </div>
          <div class="tree-modal-item">
            <svg class="modal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M3 9h18"/></svg>
            <span class="modal-name">Nouveau ticket</span>
            <span class="modal-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>Modale</span>
          </div>
          <div class="tree-more" onclick="expandMore(this)">... et 7 autres pages</div>
        </div>
      </div>

    </div><!-- /tree-content -->

    <!-- Breadcrumb -->
    <div class="tree-breadcrumb">
      <span class="crumb">Accueil</span>
      <span class="crumb-sep">/</span>
      <span class="crumb">Contacts</span>
      <span class="crumb-sep">/</span>
      <span class="crumb crumb-active">Fiche client</span>
    </div>
  </div><!-- /tab-arborescence -->

  <!-- ===== TAB 2: LISTE ===== -->
  <div class="tab-panel" id="tab-liste">
    <!-- Filter chips -->
    <div class="list-filters">
      <div class="filter-chip active" data-filter="all">Toutes <span class="chip-count">98</span></div>
      <div class="filter-chip" data-filter="page">Pages <span class="chip-count">86</span></div>
      <div class="filter-chip" data-filter="modale">Modales <span class="chip-count">12</span></div>
      <div class="filter-chip" data-filter="error">Erreurs <span class="chip-count">3</span></div>
    </div>

    <!-- Search -->
    <div class="tree-search-wrapper">
      <svg class="tree-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
      <input class="tree-search" type="text" placeholder="Rechercher dans la liste...">
    </div>

    <!-- Table -->
    <div class="list-table-wrapper">
      <table class="list-table">
        <thead>
          <tr>
            <th class="td-status">Statut</th>
            <th class="td-name">Nom <span class="sort-arrow">&#9660;</span></th>
            <th class="td-section">Section</th>
            <th class="td-type">Type</th>
            <th class="td-date">Modifi&eacute; le</th>
          </tr>
        </thead>
        <tbody>
          <tr class="active"><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Fiche client</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">25 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Liste des contacts</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">24 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Page d'accueil</td><td class="td-section">Accueil</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">24 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Pipeline</td><td class="td-section">Opportunit&eacute;s</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">23 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">D&eacute;tail opportunit&eacute;</td><td class="td-section">Opportunit&eacute;s</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">23 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Historique</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">22 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot error"></span></td><td class="td-name">Import contacts</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">22 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Nouveau contact</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge modale">Modale</span></td><td class="td-date">21 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Confirmer suppression</td><td class="td-section">Contacts</td><td class="td-type"><span class="type-badge modale">Modale</span></td><td class="td-date">21 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot warn"></span></td><td class="td-name">Pr&eacute;visions</td><td class="td-section">Opportunit&eacute;s</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">20 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Cr&eacute;er opportunit&eacute;</td><td class="td-section">Opportunit&eacute;s</td><td class="td-type"><span class="type-badge modale">Modale</span></td><td class="td-date">20 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Rapports g&eacute;n&eacute;raux</td><td class="td-section">Rapports</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">19 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot error"></span></td><td class="td-name">Export donn&eacute;es</td><td class="td-section">Rapports</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">19 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Vue d'ensemble</td><td class="td-section">Dashboard</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">18 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">KPI mensuels</td><td class="td-section">Dashboard</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">18 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Filtrer p&eacute;riode</td><td class="td-section">Dashboard</td><td class="td-type"><span class="type-badge modale">Modale</span></td><td class="td-date">17 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Factures</td><td class="td-section">Facturation</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">17 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot warn"></span></td><td class="td-name">D&eacute;tail facture</td><td class="td-section">Facturation</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">16 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot ok"></span></td><td class="td-name">Nouveau paiement</td><td class="td-section">Facturation</td><td class="td-type"><span class="type-badge modale">Modale</span></td><td class="td-date">16 f&eacute;v.</td></tr>
          <tr><td class="td-status"><span class="health-dot error"></span></td><td class="td-name">D&eacute;tail ticket</td><td class="td-section">Support</td><td class="td-type"><span class="type-badge page">Page</span></td><td class="td-date">15 f&eacute;v.</td></tr>
        </tbody>
      </table>
    </div>
  </div><!-- /tab-liste -->

  <!-- ===== TAB 3: CARTE DU SITE ===== -->
  <div class="tab-panel" id="tab-carte">
    <div class="sitemap-wrapper" id="sitemapWrapper">
      <div class="sitemap-canvas" id="sitemapCanvas">
        <!-- Lines drawn by JS -->
        <!-- Center node -->
        <div class="sitemap-node center" style="left:50%;top:50%;transform:translate(-50%,-50%);" data-id="center">Accueil</div>

        <!-- Section nodes radially placed -->
        <div class="sitemap-node section" style="left:50%;top:12%;transform:translate(-50%,-50%);" data-id="contacts">Contacts (14)</div>
        <div class="sitemap-node section" style="left:84%;top:28%;transform:translate(-50%,-50%);" data-id="opportunites">Opportunit&eacute;s (18)</div>
        <div class="sitemap-node section" style="left:88%;top:62%;transform:translate(-50%,-50%);" data-id="rapports">Rapports (12)</div>
        <div class="sitemap-node section" style="left:62%;top:88%;transform:translate(-50%,-50%);" data-id="parametres">Param&egrave;tres (6)</div>
        <div class="sitemap-node section" style="left:34%;top:88%;transform:translate(-50%,-50%);" data-id="dashboard">Dashboard (10)</div>
        <div class="sitemap-node section" style="left:10%;top:62%;transform:translate(-50%,-50%);" data-id="facturation">Facturation (8)</div>
        <div class="sitemap-node section" style="left:12%;top:28%;transform:translate(-50%,-50%);" data-id="support">Support (10)</div>

        <!-- Child pages off Contacts -->
        <div class="sitemap-node" style="left:38%;top:2%;transform:translate(-50%,-50%);">Fiche client</div>
        <div class="sitemap-node" style="left:62%;top:2%;transform:translate(-50%,-50%);">Liste contacts</div>
        <div class="sitemap-node modal" style="left:50%;top:2%;transform:translate(-50%,-50%);">Nouveau contact</div>

        <!-- Child pages off Opportunites -->
        <div class="sitemap-node" style="left:96%;top:18%;transform:translate(-50%,-50%);">Pipeline</div>
        <div class="sitemap-node warning" style="left:96%;top:36%;transform:translate(-50%,-50%);">Pr&eacute;visions</div>

        <!-- Child pages off Rapports -->
        <div class="sitemap-node error" style="left:98%;top:54%;transform:translate(-50%,-50%);">Export</div>
        <div class="sitemap-node" style="left:98%;top:72%;transform:translate(-50%,-50%);">G&eacute;n&eacute;raux</div>

        <!-- Child pages off Dashboard -->
        <div class="sitemap-node" style="left:24%;top:96%;transform:translate(-50%,-50%);">Vue ensemble</div>
        <div class="sitemap-node modal" style="left:44%;top:96%;transform:translate(-50%,-50%);">Filtrer</div>

        <!-- Child pages off Facturation -->
        <div class="sitemap-node" style="left:2%;top:52%;transform:translate(-50%,-50%);">Factures</div>
        <div class="sitemap-node modal" style="left:2%;top:72%;transform:translate(-50%,-50%);">Paiement</div>

        <!-- Child pages off Support -->
        <div class="sitemap-node error" style="left:2%;top:20%;transform:translate(-50%,-50%);">D&eacute;tail ticket</div>
        <div class="sitemap-node modal" style="left:2%;top:36%;transform:translate(-50%,-50%);">Nouveau ticket</div>
      </div>

      <!-- Legend -->
      <div class="sitemap-legend">
        <div class="legend-item"><span class="legend-box page"></span> Page</div>
        <div class="legend-item"><span class="legend-box modale"></span> Modale</div>
        <div class="legend-item"><span class="legend-box erreur"></span> Erreur</div>
      </div>

      <!-- Zoom controls -->
      <div class="sitemap-zoom">
        <button class="zoom-btn" onclick="zoomSitemap(0.1)">+</button>
        <button class="zoom-btn" onclick="zoomSitemap(-0.1)">&#8722;</button>
      </div>
    </div>
  </div><!-- /tab-carte -->

</div><!-- /tree-panel -->

<!-- ===== CONTEXT MENU ===== -->
<div class="context-menu" id="contextMenu">
  <div class="context-menu-item" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
    Aper&ccedil;u
  </div>
  <div class="context-menu-item" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4l-6 6M17 4h6v6"/><path d="M1 20l6-6M7 20H1v-6"/></svg>
    Recapturer
  </div>
  <div class="context-menu-item" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/></svg>
    Page d'accueil
  </div>
  <div class="context-menu-item" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
    D&eacute;tails sant&eacute;
  </div>
  <div class="context-menu-item" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
    Ouvrir &eacute;diteur
  </div>
  <div class="context-menu-sep"></div>
  <div class="context-menu-item danger" onclick="hideContextMenu()">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
    Supprimer
  </div>
</div>

<!-- ===== MAIN PREVIEW AREA ===== -->
<main class="main-area">
  <div class="preview-topbar">
    <div class="preview-breadcrumb">
      <span class="crumb">Salesforce</span>
      <span class="crumb-sep">/</span>
      <span class="crumb">Contacts</span>
      <span class="crumb-sep">/</span>
      <span class="crumb crumb-active">Fiche client</span>
    </div>
    <div class="preview-actions">
      <button class="preview-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        Comparer
      </button>
      <button class="preview-btn primary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4l-6 6M17 4h6v6"/><path d="M1 20l6-6M7 20H1v-6"/></svg>
        Recapturer
      </button>
    </div>
  </div>

  <div class="preview-viewport">
    <div class="browser-frame">
      <div class="browser-chrome">
        <div class="browser-dots"><span></span><span></span><span></span></div>
        <div class="browser-url-bar">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12" style="color:var(--success);flex-shrink:0;"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
          <span><span class="url-protocol">https://</span><span class="url-domain">demo.salesforce.com</span>/contacts/fiche-client</span>
        </div>
      </div>
      <div class="browser-content">
        <div class="page-skeleton">
          <div class="skel-bar title"></div>
          <div class="skel-bar w90"></div>
          <div class="skel-bar w70"></div>
          <div class="skel-bar w80"></div>
          <div class="skel-bar w45"></div>
          <div class="skel-bar w60"></div>
          <div class="skel-block">
            <div class="skel-card"></div>
            <div class="skel-card"></div>
            <div class="skel-card"></div>
            <div class="skel-card"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
/* ===== TAB SWITCHING ===== */
document.querySelectorAll('.tree-tab').forEach(function(tab) {
  tab.addEventListener('click', function() {
    // Deactivate all tabs
    document.querySelectorAll('.tree-tab').forEach(function(t) { t.classList.remove('active'); });
    document.querySelectorAll('.tab-panel').forEach(function(p) { p.classList.remove('active'); });
    // Activate clicked tab
    tab.classList.add('active');
    var tabId = 'tab-' + tab.getAttribute('data-tab');
    document.getElementById(tabId).classList.add('active');
  });
});

/* ===== TREE GROUP COLLAPSE/EXPAND ===== */
function toggleGroup(header) {
  var items = header.nextElementSibling;
  var chevron = header.querySelector('.chevron');
  if (items.classList.contains('collapsed')) {
    items.classList.remove('collapsed');
    chevron.classList.add('open');
  } else {
    items.classList.add('collapsed');
    chevron.classList.remove('open');
  }
}

/* ===== EXPAND MORE ITEMS ===== */
function expandMore(el) {
  el.style.display = 'none';
}

/* ===== CONTEXT MENU ===== */
var contextMenu = document.getElementById('contextMenu');

function showContextMenu(e) {
  e.stopPropagation();
  var rect = e.currentTarget.getBoundingClientRect();
  contextMenu.style.left = rect.right + 4 + 'px';
  contextMenu.style.top = rect.top + 'px';
  contextMenu.classList.add('visible');

  // Ensure menu doesn't go off-screen
  requestAnimationFrame(function() {
    var menuRect = contextMenu.getBoundingClientRect();
    if (menuRect.bottom > window.innerHeight) {
      contextMenu.style.top = (window.innerHeight - menuRect.height - 8) + 'px';
    }
    if (menuRect.right > window.innerWidth) {
      contextMenu.style.left = (rect.left - menuRect.width - 4) + 'px';
    }
  });
}

function hideContextMenu() {
  contextMenu.classList.remove('visible');
}

document.addEventListener('click', function(e) {
  if (!contextMenu.contains(e.target)) {
    hideContextMenu();
  }
});

/* ===== FILTER CHIPS (Tab 2) ===== */
document.querySelectorAll('.filter-chip').forEach(function(chip) {
  chip.addEventListener('click', function() {
    document.querySelectorAll('.filter-chip').forEach(function(c) { c.classList.remove('active'); });
    chip.classList.add('active');
    var filter = chip.getAttribute('data-filter');
    var rows = document.querySelectorAll('.list-table tbody tr');
    rows.forEach(function(row) {
      if (filter === 'all') {
        row.style.display = '';
      } else if (filter === 'page') {
        row.style.display = row.querySelector('.type-badge.page') ? '' : 'none';
      } else if (filter === 'modale') {
        row.style.display = row.querySelector('.type-badge.modale') ? '' : 'none';
      } else if (filter === 'error') {
        row.style.display = row.querySelector('.health-dot.error') ? '' : 'none';
      }
    });
  });
});

/* ===== TABLE ROW CLICK ===== */
document.querySelectorAll('.list-table tbody tr').forEach(function(row) {
  row.addEventListener('click', function() {
    document.querySelectorAll('.list-table tbody tr').forEach(function(r) { r.classList.remove('active'); });
    row.classList.add('active');
  });
});

/* ===== TREE ITEM CLICK ===== */
document.querySelectorAll('.tree-item').forEach(function(item) {
  item.addEventListener('click', function(e) {
    if (e.target.closest('.item-more')) return;
    document.querySelectorAll('.tree-item').forEach(function(i) { i.classList.remove('active'); });
    item.classList.add('active');
  });
});

/* ===== SITEMAP ZOOM ===== */
var currentZoom = 1;
function zoomSitemap(delta) {
  currentZoom = Math.max(0.5, Math.min(1.5, currentZoom + delta));
  document.getElementById('sitemapCanvas').style.transform = 'scale(' + currentZoom + ')';
}

/* ===== DRAW SITEMAP LINES ===== */
function drawSitemapLines() {
  var canvas = document.getElementById('sitemapCanvas');
  var wrapper = document.getElementById('sitemapWrapper');
  if (!canvas || !wrapper) return;

  // Remove old lines
  canvas.querySelectorAll('.sitemap-line').forEach(function(l) { l.remove(); });

  var nodes = canvas.querySelectorAll('.sitemap-node');
  var centerNode = canvas.querySelector('.sitemap-node.center');
  var sectionNodes = canvas.querySelectorAll('.sitemap-node.section');

  if (!centerNode || sectionNodes.length === 0) return;

  var canvasRect = canvas.getBoundingClientRect();

  function getCenter(el) {
    var r = el.getBoundingClientRect();
    return {
      x: r.left + r.width / 2 - canvasRect.left,
      y: r.top + r.height / 2 - canvasRect.top
    };
  }

  function drawLine(p1, p2, dashed) {
    var dx = p2.x - p1.x;
    var dy = p2.y - p1.y;
    var length = Math.sqrt(dx * dx + dy * dy);
    var angle = Math.atan2(dy, dx) * 180 / Math.PI;

    var line = document.createElement('div');
    line.className = 'sitemap-line';
    line.style.width = length + 'px';
    line.style.height = '1.5px';
    line.style.left = p1.x + 'px';
    line.style.top = p1.y + 'px';
    line.style.transform = 'rotate(' + angle + 'deg)';
    if (dashed) {
      line.style.background = 'none';
      line.style.borderTop = '1.5px dashed #d4d2cf';
      line.style.height = '0';
    }
    canvas.insertBefore(line, canvas.firstChild);
  }

  var cp = getCenter(centerNode);

  // Lines from center to section nodes
  sectionNodes.forEach(function(sn) {
    drawLine(cp, getCenter(sn), false);
  });

  // Lines from section nodes to child pages
  // We do a proximity-based approach: non-section, non-center nodes attach to nearest section
  var childNodes = [];
  nodes.forEach(function(n) {
    if (!n.classList.contains('center') && !n.classList.contains('section')) {
      childNodes.push(n);
    }
  });

  childNodes.forEach(function(child) {
    var childP = getCenter(child);
    var bestDist = Infinity;
    var bestSection = null;
    sectionNodes.forEach(function(sn) {
      var sp = getCenter(sn);
      var d = Math.sqrt((sp.x - childP.x) * (sp.x - childP.x) + (sp.y - childP.y) * (sp.y - childP.y));
      if (d < bestDist) {
        bestDist = d;
        bestSection = sn;
      }
    });
    if (bestSection) {
      drawLine(getCenter(bestSection), childP, child.classList.contains('modal'));
    }
  });
}

// Draw lines after DOM ready and on resize
window.addEventListener('load', function() {
  setTimeout(drawSitemapLines, 100);
});
window.addEventListener('resize', drawSitemapLines);

// Redraw when carte tab becomes active
document.querySelector('[data-tab="carte"]').addEventListener('click', function() {
  setTimeout(drawSitemapLines, 50);
});

/* ===== PANEL RESIZE ===== */
(function() {
  var treePanel = document.getElementById('treePanel');
  var resizeHandle = document.getElementById('resizeHandle');
  var isDragging = false;
  var startX = 0;
  var startWidth = 0;
  var minWidth = 240;
  var maxWidth = 600;

  resizeHandle.addEventListener('mousedown', function(e) {
    isDragging = true;
    startX = e.clientX;
    startWidth = treePanel.offsetWidth;
    resizeHandle.classList.add('dragging');
    document.body.style.cursor = 'col-resize';
    document.body.style.userSelect = 'none';
    e.preventDefault();
  });

  document.addEventListener('mousemove', function(e) {
    if (!isDragging) return;

    var deltaX = e.clientX - startX;
    var newWidth = startWidth + deltaX;

    // Constrain width
    if (newWidth < minWidth) newWidth = minWidth;
    if (newWidth > maxWidth) newWidth = maxWidth;

    treePanel.style.width = newWidth + 'px';
  });

  document.addEventListener('mouseup', function() {
    if (isDragging) {
      isDragging = false;
      resizeHandle.classList.remove('dragging');
      document.body.style.cursor = '';
      document.body.style.userSelect = '';
    }
  });
})();
</script>
</body>
</html>
