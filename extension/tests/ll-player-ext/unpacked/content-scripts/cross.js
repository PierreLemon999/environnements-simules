var cross=(function(){"use strict";var vn,Qt,dt;var Di={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},Hr={};function $i(s){return typeof s=="string"?Di[s.toLowerCase()]:s}function Bi(s,e){return Bi=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},Bi(s,e)}function xl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fi(s,e,t){return Fi=xl()?Reflect.construct:function(n,i,r){var o=[null];o.push.apply(o,i);var a=new(Function.bind.apply(n,o));return r&&Bi(a,r.prototype),a},Fi.apply(null,arguments)}function rn(s){if(s==null)return s;if(Array.isArray(s))return s.slice();if(typeof s=="object"){var e={};return Object.keys(s).forEach(function(t){e[t]=s[t]}),e}return s}function zi(s){return s===void 0?"undefined":s===null?"null":Array.isArray(s)?"[ "+s.map(function(e){return zi(e)}).join(", ")+" ]":typeof s=="object"?JSON.stringify(s):typeof s=="function"?"[Function: "+s.name+"]":typeof s=="boolean"||typeof s=="number"?s:"'"+s.toString()+"'"}function on(s){if(typeof s!="string"){for(var e=new Array(arguments.length),t=0;t<arguments.length;t++)e[t]=zi(arguments[t]);return e.join(" ")}for(var n=/%[sdj%]/g,i=1,r=arguments,o=r.length,a=String(s).replace(n,function(c){if(c==="%%")return"%";if(i>=o)return c;switch(c){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":try{return JSON.stringify(r[i++])}catch{return"[Circular]"}default:return c}}),l=r[i];i<o;l=r[++i])a+=l===null||typeof l!="object"?" "+l:" "+zi(l);return a}function Sl(s,e){var t=s.split(`
`);t[0]&&t[0].indexOf("call-stack-error")>=0&&t.shift();var n=t[e],i=null;if(n){var r=/^\s*(at|.*@)\s*(.+)?$/.exec(n);i=Array.isArray(r)&&r[2]?r[2]:n}return i}Object.keys(Di).forEach(function(s){Hr[Di[s]]=s});var Vi={};function Wi(s,e){if(e){if(Vi[e])return;Vi[e]=!0}console.error(s+`
`)}function Cl(s){return Vi[s]}function Il(){var s=[];return function(e,t){return t&&typeof t=="object"?s.indexOf(t)!==-1?"[Circular]":(s.push(t),t):t}}var Rl=(function(){function s(){}return s.prototype.write=function(e){e.level<30?console.log(e):e.level<40?console.info(e):e.level<50?console.warn(e):console.error(e),e.err&&e.err.stack&&console.error(e.err.stack),e.obj&&console.log(e.obj)},s})(),an=(function(){function s(t,n,i){var r,o,a,l,c=this;if(!(this instanceof s))return new s(t,n);if(n!==void 0&&(r=t,t=n,!(r instanceof s)))throw new TypeError("invalid Logger creation: do not pass a second arg");if(!t)throw new TypeError("options (object) is required");if(r){if(t.name)throw new TypeError("invalid options.name: child cannot set logger name")}else if(!t.name)throw new TypeError("options.name (string) is required");if(t.stream&&t.streams)throw new TypeError('cannot mix "streams" and "stream" options');if(t.streams&&!Array.isArray(t.streams))throw new TypeError("invalid options.streams: must be an array");if(t.serializers&&(typeof t.serializers!="object"||Array.isArray(t.serializers)))throw new TypeError("invalid options.serializers: must be an object");if(r&&i){this._level=r._level,this.streams=r.streams,this.serializers=r.serializers,this.src=r.src,o=this.fields={};var u=Object.keys(r.fields);for(l=0;l<u.length;l++)o[a=u[l]]=r.fields[a];var f=Object.keys(t);for(l=0;l<f.length;l++)o[a=f[l]]=t[a]}else{if(r){for(this._level=r._level,this.streams=[],l=0;l<r.streams.length;l++){var E=rn(r.streams[l]);this.streams.push(E)}this.serializers=rn(r.serializers),this.src=r.src,this.fields=rn(r.fields),t.level&&this.level(t.level)}else this._level=Number.POSITIVE_INFINITY,this.streams=[],this.serializers=null,this.src=!1,this.fields={};t.stream?this.addStream({type:"stream",stream:t.stream,level:t.level}):t.streams?t.streams.forEach(function(T){c.addStream(T,t.level)}):r&&t.level?this.level(t.level):r||this.addStream({type:"raw",stream:new Rl,level:t.level}),t.serializers&&this.addSerializers(t.serializers),t.src&&(this.src=!0),delete(o=rn(t)).stream,delete o.level,delete o.streams,delete o.serializers,delete o.src,this.serializers&&this._applySerializers(o),Object.keys(o).forEach(function(T){c.fields[T]=o[T]})}}var e=s.prototype;return e.addStream=function(t,n){n===void 0&&(n=30),(t=rn(t)).type="raw",t.level=$i(t.level||n),t.level<this._level&&(this._level=t.level),this.streams.push(t),delete this.haveNonRawStreams},e.addSerializers=function(t){var n=this;this.serializers||(this.serializers={}),Object.keys(t).forEach(function(i){var r=t[i];if(typeof r!="function")throw new TypeError(on('invalid serializer for "%s" field: must be a function',i));n.serializers[i]=r})},e.child=function(t,n){return new this.constructor(this,t||{},n)},e.level=function(t){if(t===void 0)return this._level;for(var n=$i(t),i=this.streams.length,r=0;r<i;r++)this.streams[r].level=n;this._level=n},e.levels=function(t,n){if(t===void 0)return this.streams.map(function(c){return c.level});var i;if(typeof t=="number"){if((i=this.streams[t])===void 0)throw new Error("invalid stream index: "+t)}else{for(var r=this.streams.length,o=0;o<r;o++){var a=this.streams[o];if(a.name===t){i=a;break}}if(!i)throw new Error(on('no stream with name "%s"',t))}if(n===void 0)return i.level;var l=$i(n);i.level=l,l<this._level&&(this._level=l)},e._applySerializers=function(t,n){var i=this;Object.keys(this.serializers).forEach(function(r){if(!(t[r]===void 0||n&&n[r]))try{t[r]=i.serializers[r](t[r])}catch(o){Wi(on(`bunyan: ERROR: Exception thrown from the "%s" Bunyan serializer. This should never happen. This is a bugin that serializer function.
%s`,r,o.stack||o)),t[r]=on('(Error in Bunyan log "%s" serializer broke field. See stderr for details.)',r)}})},e._emit=function(t,n){var i,r;if(this.haveNonRawStreams===void 0){for(this.haveNonRawStreams=!1,i=0;i<this.streams.length;i++)if(!this.streams[i].raw){this.haveNonRawStreams=!0;break}}if(n||this.haveNonRawStreams)try{r=JSON.stringify(t,Il())+`
`}catch(c){var o=c.stack.split(/\n/g,2).join(`
`);Wi('bunyan: ERROR: Exception in `JSON.stringify(rec)`. You can install the "safe-json-stringify" module to have Bunyan fallback to safer stringification. Record:\n'+(function(u,f){return f||(f="    "),f+u.split(/\r?\n/g).join(`
`+f)})(on(`%s
%s`,t,c.stack)),o),r=on(`(Exception in JSON.stringify(rec): %j. See stderr for details.)
`,c.message)}if(n)return r;var a=t.level;for(i=0;i<this.streams.length;i++){var l=this.streams[i];l.level<=a&&l.stream.write(t)}return r},s})();function An(s){return function(){var e=this;function t(o){var a;o[0]instanceof Error?(n={err:e.serializers&&e.serializers.err?e.serializers.err(o[0]):Zr.err(o[0])},a={err:!0},i=o.length===1?[n.err.message]:Array.prototype.slice.call(o,1)):typeof o[0]!="object"&&o[0]!==null||Array.isArray(o[0])?(n=null,i=Array.prototype.slice.call(o)):(n=o[0],i=o.length===1&&n.err&&n.err instanceof Error?[n.err.message]:Array.prototype.slice.call(o,1));var l=rn(e.fields);l.level=s;var c=n?rn(n):null;if(c&&(e.serializers&&e._applySerializers(c,a),Object.keys(c).forEach(function(f){l[f]=c[f]})),l.levelName=Hr[s],l.msg=i.length?on.apply(e,i):"",l.time||(l.time=new Date),e.src&&!l.src)try{throw new Error("call-stack-error")}catch(f){var u=f.stack?Sl(f.stack,2):"";u||Cl("src")||Wi("Unable to determine src line info","src"),l.src=u||""}return l.v=1,l}var n=null,i=arguments,r=null;if(arguments.length===0)return this._level<=s;this._level>s||(r=t(i),this._emit(r))}}function jr(s){var e=s.stack||s.toString();if(s.cause&&typeof s.cause=="function"){var t=s.cause();t&&(e+=`
Caused by: `+jr(t))}return e}an.prototype.trace=An(10),an.prototype.debug=An(20),an.prototype.info=An(30),an.prototype.warn=An(40),an.prototype.error=An(50),an.prototype.fatal=An(60);var Zr={err:function(s){return s&&s.stack?{message:s.message,name:s.name,stack:jr(s),code:s.code,signal:s.signal}:s}};function Al(){return Fi(an,[].slice.call(arguments))}var Ol=10,Gr=20,Ll=30,Ml=40,Nl=50,qr=60,Kr={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},Xr={};Object.keys(Kr).forEach(function(s){Xr[Kr[s]]=s});const Yr={levels:{trace:"color: DeepPink",debug:"color: GoldenRod",info:"color: DarkTurquoise",warn:"color: Purple",error:"color: Crimson",fatal:"color: Black"},def:"color: DimGray",msg:"color: SteelBlue",extra:"color: Tomato",src:"color: DimGray; font-style: italic; font-size: 0.9em"};class kl{constructor({logByLevel:e=!1,css:t=Yr}={}){this.logByLevel=e,this.css=t}write(e){const{level:t,childName:n,name:i,src:r,time:o,msg:a,obj:l,err:c,v:u,levelName:f,...E}=e;let T,k;const y=this.css.def,v=this.css.msg,w=this.css.src,_=this.css.extra,A=n!=null?i+"/"+n:i;let L=Xr[t];const B=(Array(6-L.length).join(" ")+L).toUpperCase();this.logByLevel?(t===Ol||t===Gr?L="log":t===qr&&(L="error"),k=console[L]??console.log):k=console.log,t<Gr?T=this.css.levels.trace:t<Ll?T=this.css.levels.debug:t<Ml?T=this.css.levels.info:t<Nl?T=this.css.levels.warn:t<qr?T=this.css.levels.error:T=this.css.levels.fatal;const N=(pe,F)=>Array(F+1-(pe+"").length).join("0")+pe,Q=E.length===0?"":Object.keys(E).reduce((pe,F)=>pe+`
%c%s: %c%s`,"")+`
`,P=[];P.push(`[LemonLearning] [%s:%s:%s:%s] %c%s%c: %s: %c%s ${Q} ${r!=null&&r.length>0?"%c%s":""}`),P.push(N(o.getHours(),2)),P.push(N(o.getMinutes(),2)),P.push(N(o.getSeconds(),2)),P.push(N(o.getMilliseconds(),4)),P.push(T),P.push(B),P.push(y),P.push(A),P.push(v),P.push(a);for(const pe in E)P.push(y),P.push(pe),P.push(_),P.push(JSON.stringify(E[pe]));r!=null&&r.length>0&&(P.push(w),P.push(r)),l!=null&&(P.push(`
`),P.push(l)),Pl()?(c?.message!=null&&(P.push(`
`),P.push(c.message)),c?.stack!=null&&c.stack!==""&&(P.push(`
`),P.push(c.stack))):c?.stack!=null&&c.stack!==""?(P.push(`
`),P.push(c.stack)):c?.message!=null&&(P.push(`
`),P.push(c.message)),k.apply(console,P)}static getDefaultCss(){return Yr}}function Pl(){return navigator.userAgent.includes("Firefox")}var Jr=Object.prototype.hasOwnProperty;function Ui(s,e){var t,n;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((n=s.length)===e.length)for(;n--&&Ui(s[n],e[n]););return n===-1}if(!t||typeof s=="object"){n=0;for(t in s)if(Jr.call(s,t)&&++n&&!Jr.call(e,t)||!(t in e)||!Ui(s[t],e[t]))return!1;return Object.keys(e).length===n}}return s!==s&&e!==e}const Dl=new Error("request for lock canceled");var $l=function(s,e,t,n){function i(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(n.next(u))}catch(f){o(f)}}function l(u){try{c(n.throw(u))}catch(f){o(f)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((n=n.apply(s,e||[])).next())})};class Bl{constructor(e,t=Dl){this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}acquire(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((n,i)=>{const r={resolve:n,reject:i,weight:e,priority:t},o=Qr(this._queue,a=>t<=a.priority);o===-1&&e<=this._value?this._dispatchItem(r):this._queue.splice(o+1,0,r)})}runExclusive(e){return $l(this,arguments,void 0,function*(t,n=1,i=0){const[r,o]=yield this.acquire(n,i);try{return yield t(r)}finally{o()}})}waitForUnlock(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,t)?Promise.resolve():new Promise(n=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),Fl(this._weightedWaiters[e-1],{resolve:n,priority:t})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){const t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){const t=this._weightedWaiters[e-1];t&&(t.forEach(n=>n.resolve()),this._weightedWaiters[e-1]=[])}else{const e=this._queue[0].priority;for(let t=this._value;t>0;t--){const n=this._weightedWaiters[t-1];if(!n)continue;const i=n.findIndex(r=>r.priority<=e);(i===-1?n:n.splice(0,i)).forEach((r=>r.resolve()))}}}_couldLockImmediately(e,t){return(this._queue.length===0||this._queue[0].priority<t)&&e<=this._value}}function Fl(s,e){const t=Qr(s,n=>e.priority<=n.priority);s.splice(t+1,0,e)}function Qr(s,e){for(let t=s.length-1;t>=0;t--)if(e(s[t]))return t;return-1}var zl=function(s,e,t,n){function i(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(u){try{c(n.next(u))}catch(f){o(f)}}function l(u){try{c(n.throw(u))}catch(f){o(f)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((n=n.apply(s,e||[])).next())})};class Vl{constructor(e){this._semaphore=new Bl(1,e)}acquire(){return zl(this,arguments,void 0,function*(e=0){const[,t]=yield this._semaphore.acquire(1,e);return t})}runExclusive(e,t=0){return this._semaphore.runExclusive(()=>e(),1,t)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const Fs=globalThis.browser?.runtime?.id==null?globalThis.chrome:globalThis.browser,qe=Wl();function Wl(){const s={local:zs("local"),session:zs("session"),sync:zs("sync"),managed:zs("managed")},e=y=>{const v=s[y];if(v==null){const w=Object.keys(s).join(", ");throw Error(`Invalid area "${y}". Options: ${w}`)}return v},t=y=>{const v=y.indexOf(":"),w=y.substring(0,v),_=y.substring(v+1);if(_==null)throw Error(`Storage key should be in the form of "area:key", but received "${y}"`);return{driverArea:w,driverKey:_,driver:e(w)}},n=y=>y+"$",i=(y,v)=>{const w={...y};return Object.entries(v).forEach(([_,A])=>{A==null?delete w[_]:w[_]=A}),w},r=(y,v)=>y??v??null,o=y=>typeof y=="object"&&!Array.isArray(y)?y:{},a=async(y,v,w)=>{const _=await y.getItem(v);return r(_,w?.fallback??w?.defaultValue)},l=async(y,v)=>{const w=n(v),_=await y.getItem(w);return o(_)},c=async(y,v,w)=>{await y.setItem(v,w??null)},u=async(y,v,w)=>{const _=n(v),A=o(await y.getItem(_));await y.setItem(_,i(A,w))},f=async(y,v,w)=>{if(await y.removeItem(v),w?.removeMeta){const _=n(v);await y.removeItem(_)}},E=async(y,v,w)=>{const _=n(v);if(w==null)await y.removeItem(_);else{const A=o(await y.getItem(_));[w].flat().forEach(L=>delete A[L]),await y.setItem(_,A)}},T=(y,v,w)=>y.watch(v,w);return{getItem:async(y,v)=>{const{driver:w,driverKey:_}=t(y);return await a(w,_,v)},getItems:async y=>{const v=new Map,w=new Map,_=[];y.forEach(L=>{let B,N;typeof L=="string"?B=L:"getValue"in L?(B=L.key,N={fallback:L.fallback}):(B=L.key,N=L.options),_.push(B);const{driverArea:Q,driverKey:P}=t(B),pe=v.get(Q)??[];v.set(Q,pe.concat(P)),w.set(B,N)});const A=new Map;return await Promise.all(Array.from(v.entries()).map(async([L,B])=>{(await s[L].getItems(B)).forEach(Q=>{const P=`${L}:${Q.key}`,pe=w.get(P),F=r(Q.value,pe?.fallback??pe?.defaultValue);A.set(P,F)})})),_.map(L=>({key:L,value:A.get(L)}))},getMeta:async y=>{const{driver:v,driverKey:w}=t(y);return await l(v,w)},getMetas:async y=>{const v=y.map(A=>{const L=typeof A=="string"?A:A.key,{driverArea:B,driverKey:N}=t(L);return{key:L,driverArea:B,driverKey:N,driverMetaKey:n(N)}}),w=v.reduce((A,L)=>(A[L.driverArea]??=[],A[L.driverArea].push(L),A),{}),_={};return await Promise.all(Object.entries(w).map(async([A,L])=>{const B=await Fs.storage[A].get(L.map(N=>N.driverMetaKey));L.forEach(N=>{_[N.key]=B[N.driverMetaKey]??{}})})),v.map(A=>({key:A.key,meta:_[A.key]}))},setItem:async(y,v)=>{const{driver:w,driverKey:_}=t(y);await c(w,_,v)},setItems:async y=>{const v={};y.forEach(w=>{const{driverArea:_,driverKey:A}=t("key"in w?w.key:w.item.key);v[_]??=[],v[_].push({key:A,value:w.value})}),await Promise.all(Object.entries(v).map(async([w,_])=>{await e(w).setItems(_)}))},setMeta:async(y,v)=>{const{driver:w,driverKey:_}=t(y);await u(w,_,v)},setMetas:async y=>{const v={};y.forEach(w=>{const{driverArea:_,driverKey:A}=t("key"in w?w.key:w.item.key);v[_]??=[],v[_].push({key:A,properties:w.meta})}),await Promise.all(Object.entries(v).map(async([w,_])=>{const A=e(w),L=_.map(({key:P})=>n(P));console.log(w,L);const B=await A.getItems(L),N=Object.fromEntries(B.map(({key:P,value:pe})=>[P,o(pe)])),Q=_.map(({key:P,properties:pe})=>{const F=n(P);return{key:F,value:i(N[F]??{},pe)}});await A.setItems(Q)}))},removeItem:async(y,v)=>{const{driver:w,driverKey:_}=t(y);await f(w,_,v)},removeItems:async y=>{const v={};y.forEach(w=>{let _,A;typeof w=="string"?_=w:"getValue"in w?_=w.key:"item"in w?(_=w.item.key,A=w.options):(_=w.key,A=w.options);const{driverArea:L,driverKey:B}=t(_);v[L]??=[],v[L].push(B),A?.removeMeta&&v[L].push(n(B))}),await Promise.all(Object.entries(v).map(async([w,_])=>{await e(w).removeItems(_)}))},clear:async y=>{await e(y).clear()},removeMeta:async(y,v)=>{const{driver:w,driverKey:_}=t(y);await E(w,_,v)},snapshot:async(y,v)=>{const _=await e(y).snapshot();return v?.excludeKeys?.forEach(A=>{delete _[A],delete _[n(A)]}),_},restoreSnapshot:async(y,v)=>{await e(y).restoreSnapshot(v)},watch:(y,v)=>{const{driver:w,driverKey:_}=t(y);return T(w,_,v)},unwatch(){Object.values(s).forEach(y=>{y.unwatch()})},defineItem:(y,v)=>{const{driver:w,driverKey:_}=t(y),{version:A=1,migrations:L={}}=v??{};if(A<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const B=async()=>{const F=n(_),[{value:je},{value:Re}]=await w.getItems([_,F]);if(je==null)return;const ye=Re?.v??1;if(ye>A)throw Error(`Version downgrade detected (v${ye} -> v${A}) for "${y}"`);if(ye===A)return;console.debug(`[@wxt-dev/storage] Running storage migration for ${y}: v${ye} -> v${A}`);const Et=Array.from({length:A-ye},(Me,Ot)=>ye+Ot+1);let Qe=je;for(const Me of Et)try{Qe=await L?.[Me]?.(Qe)??Qe}catch(Ot){throw new Ul(y,Me,{cause:Ot})}await w.setItems([{key:_,value:Qe},{key:F,value:{...Re,v:A}}]),console.debug(`[@wxt-dev/storage] Storage migration completed for ${y} v${A}`,{migratedValue:Qe})},N=v?.migrations==null?Promise.resolve():B().catch(F=>{console.error(`[@wxt-dev/storage] Migration failed for ${y}`,F)}),Q=new Vl,P=()=>v?.fallback??v?.defaultValue??null,pe=()=>Q.runExclusive(async()=>{const F=await w.getItem(_);if(F!=null||v?.init==null)return F;const je=await v.init();return await w.setItem(_,je),je});return N.then(pe),{key:y,get defaultValue(){return P()},get fallback(){return P()},getValue:async()=>(await N,v?.init?await pe():await a(w,_,v)),getMeta:async()=>(await N,await l(w,_)),setValue:async F=>(await N,await c(w,_,F)),setMeta:async F=>(await N,await u(w,_,F)),removeValue:async F=>(await N,await f(w,_,F)),removeMeta:async F=>(await N,await E(w,_,F)),watch:F=>T(w,_,(je,Re)=>F(je??P(),Re??P())),migrate:B}}}}function zs(s){const e=()=>{if(Fs.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if(Fs.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const n=Fs.storage[s];if(n==null)throw Error(`"browser.storage.${s}" is undefined`);return n},t=new Set;return{getItem:async n=>(await e().get(n))[n],getItems:async n=>{const i=await e().get(n);return n.map(r=>({key:r,value:i[r]??null}))},setItem:async(n,i)=>{i==null?await e().remove(n):await e().set({[n]:i})},setItems:async n=>{const i=n.reduce((r,{key:o,value:a})=>(r[o]=a,r),{});await e().set(i)},removeItem:async n=>{await e().remove(n)},removeItems:async n=>{await e().remove(n)},clear:async()=>{await e().clear()},snapshot:async()=>await e().get(),restoreSnapshot:async n=>{await e().set(n)},watch(n,i){const r=o=>{const a=o[n];a!=null&&(Ui(a.newValue,a.oldValue)||i(a.newValue??null,a.oldValue??null))};return e().onChanged.addListener(r),t.add(r),()=>{e().onChanged.removeListener(r),t.delete(r)}},unwatch(){t.forEach(n=>{e().onChanged.removeListener(n)}),t.clear()}}}class Ul extends Error{constructor(e,t,n){super(`v${t} migration failed for "${e}"`,n),this.key=e,this.version=t}}async function Hl(s){return qe.getItem(await it(s))}async function jl(s){const e=await Promise.all(s.map(async t=>it(t)));return qe.getItems(e).then(t=>t.map((n,i)=>({key:s[i],value:n.value})))}async function Zl(s){return qe.getMeta(await it(s))}async function Gl(s,e){return qe.setItem(await it(s),e)}async function ql(s){return qe.setItems(await Promise.all(s.map(async({key:e,value:t})=>({key:await it(e),value:t}))))}async function Kl(s){return qe.removeItem(await it(s))}async function Xl(s){return qe.removeItems(await Promise.all(s.map(async e=>it(e))))}async function Yl(s,e){return qe.removeMeta(await it(s),e)}async function Jl(s,e){return qe.setMeta(await it(s),e)}function Ql(s,e){let t,n=!1;return(async()=>{const r=await it(s);n||(t=qe.watch(r,e))})(),()=>{n=!0,t?.()}}async function ec(s,e){return qe.defineItem(await it(s),e)}async function tc(){let s;return s===void 0&&(s=await qe.getItem("sync:test").then(()=>!0).catch(e=>{if(e.message==="Please set webextensions.storage.sync.enabled to true in about:config")return!1;throw e})),s}async function it(s){return await tc()?s:s.replace("sync:","local:")}const xt={...qe,getItem:Hl,setItem:Gl,getItems:jl,getMeta:Zl,setItems:ql,removeItem:Kl,removeItems:Xl,removeMeta:Yl,setMeta:Jl,watch:Ql,defineItem:ec},eo="LemonDebuggerLevel";var to=(s=>(s.FATAL="fatal",s.ERROR="error",s.WARN="warn",s.INFO="info",s.DEBUG="debug",s.TRACE="trace",s.SILENT="silent",s))(to||{});let Hi=null;const Ue=Al({name:"default",streams:[{level:"trace",stream:new kl({logByLevel:!0})}],serializers:Zr,src:!0});Ue.level("silent");const H={trace:On,debug:On,info:On,warn:On,error:On,fatal:On};function On(){console.warn("[LemonLearning] The logger should be setup before it can be used")}async function nc(){if(H.trace=Ue.trace.bind(Ue),H.debug=Ue.debug.bind(Ue),H.info=Ue.info.bind(Ue),H.warn=Ue.warn.bind(Ue),H.error=Ue.error.bind(Ue),H.fatal=Ue.fatal.bind(Ue),Hi===null){console.error("[LemonLearning] The logger levelStorage should never be null at that point. Cannot set the logger level");return}const s=await Hi.get();s!==null&&Ue.level(s)}function sc(){ic(),nc()}function ic(){Hi={get:async()=>{const s=await xt.getItem(`local:${eo}`);return typeof s=="string"&&rc(s)?s:null},set:async s=>{await xt.setItem(`local:${eo}`,s)}}}function rc(s){return Object.values(to).includes(s)}let ji;function oc(s){ji=s}function ac(){if(ji===void 0)throw new Error("You must call 'setBackground' before calling 'isBackgroundScript'. This must be done in the entry file");return ji}sc(),oc(!1);function lp(s){return s}const no=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,Ln=no;class zt{constructor(e=1){this.score=e,this.history=[]}get value(){return this.score}increment(e,t,n){const i=this.score+e;this.trace({value:e,before:this.score,after:i,type:"increment",source:t,context:n}),this.score=i}incrementWithScore(e,t,n){this.increment(e.value,t,n)}multiply(e,t,n){const i=this.score*e;this.trace({value:e,before:this.score,after:i,type:"multiply",source:t,context:n}),this.score=i}multiplyWithScore(e,t,n){this.multiply(e.value,t,n)}copy(){return new zt(this.score)}trace({value:e,before:t,after:n,type:i,source:r,context:o}){this.history.push({value:e,before:t,after:n,type:i,source:r,context:o})}}class Vs{constructor(e,t){this._element=e,this._score=t instanceof zt?t:new zt(t)}get score(){return this._score}get element(){return this._element}}const lc="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ze=(s=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(s|=0));for(;s--;)e+=lc[t[s]&63];return e};const so={width:0,height:0,top:0,left:0,right:0,bottom:0,x:0,y:0},Ws=no;class cc extends Error{constructor(e){super(e),this.name="CrossFrameCommunicationError"}}class io extends cc{constructor(e){super(`Message timed out after ${e}ms`),this.name="MessageTimedOutBeforeResponse"}}var de;(function(s){s.assertEqual=i=>i;function e(i){}s.assertIs=e;function t(i){throw new Error}s.assertNever=t,s.arrayToEnum=i=>{const r={};for(const o of i)r[o]=o;return r},s.getValidEnumValues=i=>{const r=s.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of r)o[a]=i[a];return s.objectValues(o)},s.objectValues=i=>s.objectKeys(i).map(function(r){return i[r]}),s.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const r=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&r.push(o);return r},s.find=(i,r)=>{for(const o of i)if(r(o))return o},s.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,r=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(r)}s.joinValues=n,s.jsonStringifyReplacer=(i,r)=>typeof r=="bigint"?r.toString():r})(de||(de={}));var Zi;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(Zi||(Zi={}));const W=de.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Vt=s=>{switch(typeof s){case"undefined":return W.undefined;case"string":return W.string;case"number":return isNaN(s)?W.nan:W.number;case"boolean":return W.boolean;case"function":return W.function;case"bigint":return W.bigint;case"symbol":return W.symbol;case"object":return Array.isArray(s)?W.array:s===null?W.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?W.promise:typeof Map<"u"&&s instanceof Map?W.map:typeof Set<"u"&&s instanceof Set?W.set:typeof Date<"u"&&s instanceof Date?W.date:W.object;default:return W.unknown}},R=de.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),uc=s=>JSON.stringify(s,null,2).replace(/"([^"]+)":/g,"$1:");class Ke extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(r){return r.message},n={_errors:[]},i=r=>{for(const o of r.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(t(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return i(this),n}static assert(e){if(!(e instanceof Ke))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,de.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Ke.create=s=>new Ke(s);const Mn=(s,e)=>{let t;switch(s.code){case R.invalid_type:s.received===W.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case R.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,de.jsonStringifyReplacer)}`;break;case R.unrecognized_keys:t=`Unrecognized key(s) in object: ${de.joinValues(s.keys,", ")}`;break;case R.invalid_union:t="Invalid input";break;case R.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${de.joinValues(s.options)}`;break;case R.invalid_enum_value:t=`Invalid enum value. Expected ${de.joinValues(s.options)}, received '${s.received}'`;break;case R.invalid_arguments:t="Invalid function arguments";break;case R.invalid_return_type:t="Invalid function return type";break;case R.invalid_date:t="Invalid date";break;case R.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:de.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case R.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case R.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case R.custom:t="Invalid input";break;case R.invalid_intersection_types:t="Intersection results could not be merged";break;case R.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case R.not_finite:t="Number must be finite";break;default:t=e.defaultError,de.assertNever(s)}return{message:t}};let ro=Mn;function hc(s){ro=s}function Us(){return ro}const Hs=s=>{const{data:e,path:t,errorMaps:n,issueData:i}=s,r=[...t,...i.path||[]],o={...i,path:r};if(i.message!==void 0)return{...i,path:r,message:i.message};let a="";const l=n.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...i,path:r,message:a}},dc=[];function $(s,e){const t=Us(),n=Hs({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===Mn?void 0:Mn].filter(i=>!!i)});s.common.issues.push(n)}class De{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if(i.status==="aborted")return ne;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const i of t){const r=await i.key,o=await i.value;n.push({key:r,value:o})}return De.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:r,value:o}=i;if(r.status==="aborted"||o.status==="aborted")return ne;r.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(n[r.value]=o.value)}return{status:e.value,value:n}}}const ne=Object.freeze({status:"aborted"}),Nn=s=>({status:"dirty",value:s}),Ve=s=>({status:"valid",value:s}),Gi=s=>s.status==="aborted",qi=s=>s.status==="dirty",ss=s=>s.status==="valid",is=s=>typeof Promise<"u"&&s instanceof Promise;function js(s,e,t,n){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(s)}function oo(s,e,t,n,i){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}typeof SuppressedError=="function"&&SuppressedError;var G;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message})(G||(G={}));var rs,os;class pt{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ao=(s,e)=>{if(ss(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ke(s.common.issues);return this._error=t,this._error}}};function re(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:i}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{var l,c;const{message:u}=s;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??n)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??t)!==null&&c!==void 0?c:a.defaultError}},description:i}}class ae{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Vt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Vt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new De,ctx:{common:e.parent.common,data:e.data,parsedType:Vt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(is(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vt(e)},r=this._parseSync({data:e,path:i.path,parent:i});return ao(i,r)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vt(e)},i=this._parse({data:e,path:n.path,parent:n}),r=await(is(i)?i:Promise.resolve(i));return ao(n,r)}refine(e,t){const n=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,r)=>{const o=e(i),a=()=>r.addIssue({code:R.custom,...n(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof t=="function"?t(n,i):t),!1))}_refinement(e){return new at({schema:this,typeName:J.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return gt.create(this,this._def)}nullable(){return jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ot.create(this,this._def)}promise(){return $n.create(this,this._def)}or(e){return us.create([this,e],this._def)}and(e){return hs.create(this,e,this._def)}transform(e){return new at({...re(this._def),schema:this,typeName:J.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new gs({...re(this._def),innerType:this,defaultValue:t,typeName:J.ZodDefault})}brand(){return new Yi({typeName:J.ZodBranded,type:this,...re(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ys({...re(this._def),innerType:this,catchValue:t,typeName:J.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return vs.create(this,e)}readonly(){return bs.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const fc=/^c[^\s-]{8,}$/i,pc=/^[0-9a-z]+$/,mc=/^[0-9A-HJKMNP-TV-Z]{26}$/,gc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,yc=/^[a-z0-9_-]{21}$/i,vc=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,bc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,wc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ki;const Ec=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,_c=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Tc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,lo="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",xc=new RegExp(`^${lo}$`);function co(s){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Sc(s){return new RegExp(`^${co(s)}$`)}function uo(s){let e=`${lo}T${co(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Cc(s,e){return!!((e==="v4"||!e)&&Ec.test(s)||(e==="v6"||!e)&&_c.test(s))}class rt extends ae{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==W.string){const r=this._getOrReturnCtx(e);return $(r,{code:R.invalid_type,expected:W.string,received:r.parsedType}),ne}const n=new De;let i;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(i=this._getOrReturnCtx(e,i),$(i,{code:R.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="max")e.data.length>r.value&&(i=this._getOrReturnCtx(e,i),$(i,{code:R.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="length"){const o=e.data.length>r.value,a=e.data.length<r.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?$(i,{code:R.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):a&&$(i,{code:R.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),n.dirty())}else if(r.kind==="email")bc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"email",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="emoji")Ki||(Ki=new RegExp(wc,"u")),Ki.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"emoji",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="uuid")gc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"uuid",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="nanoid")yc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"nanoid",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid")fc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"cuid",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid2")pc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"cuid2",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="ulid")mc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"ulid",code:R.invalid_string,message:r.message}),n.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),$(i,{validation:"url",code:R.invalid_string,message:r.message}),n.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"regex",code:R.invalid_string,message:r.message}),n.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),n.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:{startsWith:r.value},message:r.message}),n.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:{endsWith:r.value},message:r.message}),n.dirty()):r.kind==="datetime"?uo(r).test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:"datetime",message:r.message}),n.dirty()):r.kind==="date"?xc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:"date",message:r.message}),n.dirty()):r.kind==="time"?Sc(r).test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{code:R.invalid_string,validation:"time",message:r.message}),n.dirty()):r.kind==="duration"?vc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"duration",code:R.invalid_string,message:r.message}),n.dirty()):r.kind==="ip"?Cc(e.data,r.version)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"ip",code:R.invalid_string,message:r.message}),n.dirty()):r.kind==="base64"?Tc.test(e.data)||(i=this._getOrReturnCtx(e,i),$(i,{validation:"base64",code:R.invalid_string,message:r.message}),n.dirty()):de.assertNever(r);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(i=>e.test(i),{validation:t,code:R.invalid_string,...G.errToObj(n)})}_addCheck(e){return new rt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...G.errToObj(e)})}url(e){return this._addCheck({kind:"url",...G.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...G.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...G.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...G.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...G.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...G.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...G.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...G.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...G.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...G.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...G.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...G.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...G.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...G.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...G.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...G.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...G.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...G.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...G.errToObj(t)})}nonempty(e){return this.min(1,G.errToObj(e))}trim(){return new rt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new rt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new rt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}rt.create=s=>{var e;return new rt({checks:[],typeName:J.ZodString,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...re(s)})};function Ic(s,e){const t=(s.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=t>n?t:n,r=parseInt(s.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return r%o/Math.pow(10,i)}class Wt extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==W.number){const r=this._getOrReturnCtx(e);return $(r,{code:R.invalid_type,expected:W.number,received:r.parsedType}),ne}let n;const i=new De;for(const r of this._def.checks)r.kind==="int"?de.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:R.invalid_type,expected:"integer",received:"float",message:r.message}),i.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),i.dirty()):r.kind==="multipleOf"?Ic(e.data,r.value)!==0&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),$(n,{code:R.not_finite,message:r.message}),i.dirty()):de.assertNever(r);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,i){return new Wt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(i)}]})}_addCheck(e){return new Wt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:G.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:G.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:G.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:G.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&de.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Wt.create=s=>new Wt({checks:[],typeName:J.ZodNumber,coerce:s?.coerce||!1,...re(s)});class Ut extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==W.bigint){const r=this._getOrReturnCtx(e);return $(r,{code:R.invalid_type,expected:W.bigint,received:r.parsedType}),ne}let n;const i=new De;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),i.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),$(n,{code:R.not_multiple_of,multipleOf:r.value,message:r.message}),i.dirty()):de.assertNever(r);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,i){return new Ut({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(i)}]})}_addCheck(e){return new Ut({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ut.create=s=>{var e;return new Ut({checks:[],typeName:J.ZodBigInt,coerce:(e=s?.coerce)!==null&&e!==void 0?e:!1,...re(s)})};class as extends ae{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==W.boolean){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.boolean,received:n.parsedType}),ne}return Ve(e.data)}}as.create=s=>new as({typeName:J.ZodBoolean,coerce:s?.coerce||!1,...re(s)});class ln extends ae{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==W.date){const r=this._getOrReturnCtx(e);return $(r,{code:R.invalid_type,expected:W.date,received:r.parsedType}),ne}if(isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return $(r,{code:R.invalid_date}),ne}const n=new De;let i;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(i=this._getOrReturnCtx(e,i),$(i,{code:R.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(i=this._getOrReturnCtx(e,i),$(i,{code:R.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):de.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ln({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:G.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:G.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ln.create=s=>new ln({checks:[],coerce:s?.coerce||!1,typeName:J.ZodDate,...re(s)});class Zs extends ae{_parse(e){if(this._getType(e)!==W.symbol){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.symbol,received:n.parsedType}),ne}return Ve(e.data)}}Zs.create=s=>new Zs({typeName:J.ZodSymbol,...re(s)});class ls extends ae{_parse(e){if(this._getType(e)!==W.undefined){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.undefined,received:n.parsedType}),ne}return Ve(e.data)}}ls.create=s=>new ls({typeName:J.ZodUndefined,...re(s)});class cs extends ae{_parse(e){if(this._getType(e)!==W.null){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.null,received:n.parsedType}),ne}return Ve(e.data)}}cs.create=s=>new cs({typeName:J.ZodNull,...re(s)});class kn extends ae{constructor(){super(...arguments),this._any=!0}_parse(e){return Ve(e.data)}}kn.create=s=>new kn({typeName:J.ZodAny,...re(s)});class cn extends ae{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ve(e.data)}}cn.create=s=>new cn({typeName:J.ZodUnknown,...re(s)});class St extends ae{_parse(e){const t=this._getOrReturnCtx(e);return $(t,{code:R.invalid_type,expected:W.never,received:t.parsedType}),ne}}St.create=s=>new St({typeName:J.ZodNever,...re(s)});class Gs extends ae{_parse(e){if(this._getType(e)!==W.undefined){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.void,received:n.parsedType}),ne}return Ve(e.data)}}Gs.create=s=>new Gs({typeName:J.ZodVoid,...re(s)});class ot extends ae{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==W.array)return $(t,{code:R.invalid_type,expected:W.array,received:t.parsedType}),ne;if(i.exactLength!==null){const o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&($(t,{code:o?R.too_big:R.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&($(t,{code:R.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&($(t,{code:R.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new pt(t,o,t.path,a)))).then(o=>De.mergeArray(n,o));const r=[...t.data].map((o,a)=>i.type._parseSync(new pt(t,o,t.path,a)));return De.mergeArray(n,r)}get element(){return this._def.type}min(e,t){return new ot({...this._def,minLength:{value:e,message:G.toString(t)}})}max(e,t){return new ot({...this._def,maxLength:{value:e,message:G.toString(t)}})}length(e,t){return new ot({...this._def,exactLength:{value:e,message:G.toString(t)}})}nonempty(e){return this.min(1,e)}}ot.create=(s,e)=>new ot({type:s,minLength:null,maxLength:null,exactLength:null,typeName:J.ZodArray,...re(e)});function Pn(s){if(s instanceof be){const e={};for(const t in s.shape){const n=s.shape[t];e[t]=gt.create(Pn(n))}return new be({...s._def,shape:()=>e})}else return s instanceof ot?new ot({...s._def,type:Pn(s.element)}):s instanceof gt?gt.create(Pn(s.unwrap())):s instanceof jt?jt.create(Pn(s.unwrap())):s instanceof mt?mt.create(s.items.map(e=>Pn(e))):s}class be extends ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=de.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==W.object){const c=this._getOrReturnCtx(e);return $(c,{code:R.invalid_type,expected:W.object,received:c.parsedType}),ne}const{status:n,ctx:i}=this._processInputParams(e),{shape:r,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof St&&this._def.unknownKeys==="strip"))for(const c in i.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=r[c],f=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new pt(i,f,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof St){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")a.length>0&&($(i,{code:R.unrecognized_keys,keys:a}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const f=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new pt(i,f,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const f=await u.key,E=await u.value;c.push({key:f,value:E,alwaysSet:u.alwaysSet})}return c}).then(c=>De.mergeObjectSync(n,c)):De.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return G.errToObj,new be({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var i,r,o,a;const l=(o=(r=(i=this._def).errorMap)===null||r===void 0?void 0:r.call(i,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=G.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new be({...this._def,unknownKeys:"strip"})}passthrough(){return new be({...this._def,unknownKeys:"passthrough"})}extend(e){return new be({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new be({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:J.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new be({...this._def,catchall:e})}pick(e){const t={};return de.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new be({...this._def,shape:()=>t})}omit(e){const t={};return de.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new be({...this._def,shape:()=>t})}deepPartial(){return Pn(this)}partial(e){const t={};return de.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}),new be({...this._def,shape:()=>t})}required(e){const t={};return de.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let r=this.shape[n];for(;r instanceof gt;)r=r._def.innerType;t[n]=r}}),new be({...this._def,shape:()=>t})}keyof(){return ho(de.objectKeys(this.shape))}}be.create=(s,e)=>new be({shape:()=>s,unknownKeys:"strip",catchall:St.create(),typeName:J.ZodObject,...re(e)}),be.strictCreate=(s,e)=>new be({shape:()=>s,unknownKeys:"strict",catchall:St.create(),typeName:J.ZodObject,...re(e)}),be.lazycreate=(s,e)=>new be({shape:s,unknownKeys:"strip",catchall:St.create(),typeName:J.ZodObject,...re(e)});class us extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function i(r){for(const a of r)if(a.result.status==="valid")return a.result;for(const a of r)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=r.map(a=>new Ke(a.ctx.common.issues));return $(t,{code:R.invalid_union,unionErrors:o}),ne}if(t.common.async)return Promise.all(n.map(async r=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let r;const o=[];for(const l of n){const c={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!r&&(r={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const a=o.map(l=>new Ke(l));return $(t,{code:R.invalid_union,unionErrors:a}),ne}}get options(){return this._def.options}}us.create=(s,e)=>new us({options:s,typeName:J.ZodUnion,...re(e)});const Ct=s=>s instanceof fs?Ct(s.schema):s instanceof at?Ct(s.innerType()):s instanceof ps?[s.value]:s instanceof Ht?s.options:s instanceof ms?de.objectValues(s.enum):s instanceof gs?Ct(s._def.innerType):s instanceof ls?[void 0]:s instanceof cs?[null]:s instanceof gt?[void 0,...Ct(s.unwrap())]:s instanceof jt?[null,...Ct(s.unwrap())]:s instanceof Yi||s instanceof bs?Ct(s.unwrap()):s instanceof ys?Ct(s._def.innerType):[];class qs extends ae{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==W.object)return $(t,{code:R.invalid_type,expected:W.object,received:t.parsedType}),ne;const n=this.discriminator,i=t.data[n],r=this.optionsMap.get(i);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):($(t,{code:R.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ne)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const r of t){const o=Ct(r.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,r)}}return new qs({typeName:J.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...re(n)})}}function Xi(s,e){const t=Vt(s),n=Vt(e);if(s===e)return{valid:!0,data:s};if(t===W.object&&n===W.object){const i=de.objectKeys(e),r=de.objectKeys(s).filter(a=>i.indexOf(a)!==-1),o={...s,...e};for(const a of r){const l=Xi(s[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(t===W.array&&n===W.array){if(s.length!==e.length)return{valid:!1};const i=[];for(let r=0;r<s.length;r++){const o=s[r],a=e[r],l=Xi(o,a);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return t===W.date&&n===W.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class hs extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(r,o)=>{if(Gi(r)||Gi(o))return ne;const a=Xi(r.value,o.value);return a.valid?((qi(r)||qi(o))&&t.dirty(),{status:t.value,value:a.data}):($(n,{code:R.invalid_intersection_types}),ne)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([r,o])=>i(r,o)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}hs.create=(s,e,t)=>new hs({left:s,right:e,typeName:J.ZodIntersection,...re(t)});class mt extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.array)return $(n,{code:R.invalid_type,expected:W.array,received:n.parsedType}),ne;if(n.data.length<this._def.items.length)return $(n,{code:R.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ne;!this._def.rest&&n.data.length>this._def.items.length&&($(n,{code:R.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new pt(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(r).then(o=>De.mergeArray(t,o)):De.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new mt({...this._def,rest:e})}}mt.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mt({items:s,typeName:J.ZodTuple,rest:null,...re(e)})};class ds extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.object)return $(n,{code:R.invalid_type,expected:W.object,received:n.parsedType}),ne;const i=[],r=this._def.keyType,o=this._def.valueType;for(const a in n.data)i.push({key:r._parse(new pt(n,a,n.path,a)),value:o._parse(new pt(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?De.mergeObjectAsync(t,i):De.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof ae?new ds({keyType:e,valueType:t,typeName:J.ZodRecord,...re(n)}):new ds({keyType:rt.create(),valueType:e,typeName:J.ZodRecord,...re(t)})}}class Ks extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.map)return $(n,{code:R.invalid_type,expected:W.map,received:n.parsedType}),ne;const i=this._def.keyType,r=this._def.valueType,o=[...n.data.entries()].map(([a,l],c)=>({key:i._parse(new pt(n,a,n.path,[c,"key"])),value:r._parse(new pt(n,l,n.path,[c,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return ne;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(c.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return ne;(c.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(c.value,u.value)}return{status:t.value,value:a}}}}Ks.create=(s,e,t)=>new Ks({valueType:e,keyType:s,typeName:J.ZodMap,...re(t)});class un extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==W.set)return $(n,{code:R.invalid_type,expected:W.set,received:n.parsedType}),ne;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&($(n,{code:R.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&($(n,{code:R.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const r=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return ne;u.status==="dirty"&&t.dirty(),c.add(u.value)}return{status:t.value,value:c}}const a=[...n.data.values()].map((l,c)=>r._parse(new pt(n,l,n.path,c)));return n.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,t){return new un({...this._def,minSize:{value:e,message:G.toString(t)}})}max(e,t){return new un({...this._def,maxSize:{value:e,message:G.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}un.create=(s,e)=>new un({valueType:s,minSize:null,maxSize:null,typeName:J.ZodSet,...re(e)});class Dn extends ae{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==W.function)return $(t,{code:R.invalid_type,expected:W.function,received:t.parsedType}),ne;function n(a,l){return Hs({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Us(),Mn].filter(c=>!!c),issueData:{code:R.invalid_arguments,argumentsError:l}})}function i(a,l){return Hs({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Us(),Mn].filter(c=>!!c),issueData:{code:R.invalid_return_type,returnTypeError:l}})}const r={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof $n){const a=this;return Ve(async function(...l){const c=new Ke([]),u=await a._def.args.parseAsync(l,r).catch(T=>{throw c.addIssue(n(l,T)),c}),f=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(f,r).catch(T=>{throw c.addIssue(i(f,T)),c})})}else{const a=this;return Ve(function(...l){const c=a._def.args.safeParse(l,r);if(!c.success)throw new Ke([n(l,c.error)]);const u=Reflect.apply(o,this,c.data),f=a._def.returns.safeParse(u,r);if(!f.success)throw new Ke([i(u,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Dn({...this._def,args:mt.create(e).rest(cn.create())})}returns(e){return new Dn({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Dn({args:e||mt.create([]).rest(cn.create()),returns:t||cn.create(),typeName:J.ZodFunction,...re(n)})}}class fs extends ae{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}fs.create=(s,e)=>new fs({getter:s,typeName:J.ZodLazy,...re(e)});class ps extends ae{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return $(t,{received:t.data,code:R.invalid_literal,expected:this._def.value}),ne}return{status:"valid",value:e.data}}get value(){return this._def.value}}ps.create=(s,e)=>new ps({value:s,typeName:J.ZodLiteral,...re(e)});function ho(s,e){return new Ht({values:s,typeName:J.ZodEnum,...re(e)})}class Ht extends ae{constructor(){super(...arguments),rs.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{expected:de.joinValues(n),received:t.parsedType,code:R.invalid_type}),ne}if(js(this,rs)||oo(this,rs,new Set(this._def.values)),!js(this,rs).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return $(t,{received:t.data,code:R.invalid_enum_value,options:n}),ne}return Ve(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ht.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ht.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}rs=new WeakMap,Ht.create=ho;class ms extends ae{constructor(){super(...arguments),os.set(this,void 0)}_parse(e){const t=de.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==W.string&&n.parsedType!==W.number){const i=de.objectValues(t);return $(n,{expected:de.joinValues(i),received:n.parsedType,code:R.invalid_type}),ne}if(js(this,os)||oo(this,os,new Set(de.getValidEnumValues(this._def.values))),!js(this,os).has(e.data)){const i=de.objectValues(t);return $(n,{received:n.data,code:R.invalid_enum_value,options:i}),ne}return Ve(e.data)}get enum(){return this._def.values}}os=new WeakMap,ms.create=(s,e)=>new ms({values:s,typeName:J.ZodNativeEnum,...re(e)});class $n extends ae{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==W.promise&&t.common.async===!1)return $(t,{code:R.invalid_type,expected:W.promise,received:t.parsedType}),ne;const n=t.parsedType===W.promise?t.data:Promise.resolve(t.data);return Ve(n.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}}$n.create=(s,e)=>new $n({type:s,typeName:J.ZodPromise,...re(e)});class at extends ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===J.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:o=>{$(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),i.type==="preprocess"){const o=i.transform(n.data,r);if(n.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return ne;const l=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return l.status==="aborted"?ne:l.status==="dirty"||t.value==="dirty"?Nn(l.value):l});{if(t.value==="aborted")return ne;const a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?ne:a.status==="dirty"||t.value==="dirty"?Nn(a.value):a}}if(i.type==="refinement"){const o=a=>{const l=i.refinement(a,r);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ne:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?ne:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ss(o))return o;const a=i.transform(o.value,r);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>ss(o)?Promise.resolve(i.transform(o.value,r)).then(a=>({status:t.value,value:a})):o);de.assertNever(i)}}at.create=(s,e,t)=>new at({schema:s,typeName:J.ZodEffects,effect:e,...re(t)}),at.createWithPreprocess=(s,e,t)=>new at({schema:e,effect:{type:"preprocess",transform:s},typeName:J.ZodEffects,...re(t)});class gt extends ae{_parse(e){return this._getType(e)===W.undefined?Ve(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gt.create=(s,e)=>new gt({innerType:s,typeName:J.ZodOptional,...re(e)});class jt extends ae{_parse(e){return this._getType(e)===W.null?Ve(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}jt.create=(s,e)=>new jt({innerType:s,typeName:J.ZodNullable,...re(e)});class gs extends ae{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===W.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}gs.create=(s,e)=>new gs({innerType:s,typeName:J.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...re(e)});class ys extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return is(i)?i.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Ke(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ke(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ys.create=(s,e)=>new ys({innerType:s,typeName:J.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...re(e)});class Xs extends ae{_parse(e){if(this._getType(e)!==W.nan){const n=this._getOrReturnCtx(e);return $(n,{code:R.invalid_type,expected:W.nan,received:n.parsedType}),ne}return{status:"valid",value:e.data}}}Xs.create=s=>new Xs({typeName:J.ZodNaN,...re(s)});const Rc=Symbol("zod_brand");class Yi extends ae{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class vs extends ae{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?ne:r.status==="dirty"?(t.dirty(),Nn(r.value)):this._def.out._parseAsync({data:r.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?ne:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,t){return new vs({in:e,out:t,typeName:J.ZodPipeline})}}class bs extends ae{_parse(e){const t=this._def.innerType._parse(e),n=i=>(ss(i)&&(i.value=Object.freeze(i.value)),i);return is(t)?t.then(i=>n(i)):n(t)}unwrap(){return this._def.innerType}}bs.create=(s,e)=>new bs({innerType:s,typeName:J.ZodReadonly,...re(e)});function fo(s,e={},t){return s?kn.create().superRefine((n,i)=>{var r,o;if(!s(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,l=(o=(r=a.fatal)!==null&&r!==void 0?r:t)!==null&&o!==void 0?o:!0,c=typeof a=="string"?{message:a}:a;i.addIssue({code:"custom",...c,fatal:l})}}):kn.create()}const Ac={object:be.lazycreate};var J;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(J||(J={}));const Oc=(s,e={message:`Input not instance of ${s.name}`})=>fo(t=>t instanceof s,e),po=rt.create,mo=Wt.create,Lc=Xs.create,Mc=Ut.create,go=as.create,Nc=ln.create,kc=Zs.create,Pc=ls.create,Dc=cs.create,$c=kn.create,Bc=cn.create,Fc=St.create,zc=Gs.create,Vc=ot.create,Wc=be.create,Uc=be.strictCreate,Hc=us.create,jc=qs.create,Zc=hs.create,Gc=mt.create,qc=ds.create,Kc=Ks.create,Xc=un.create,Yc=Dn.create,Jc=fs.create,Qc=ps.create,eu=Ht.create,tu=ms.create,nu=$n.create,yo=at.create,su=gt.create,iu=jt.create,ru=at.createWithPreprocess,ou=vs.create;var p=Object.freeze({__proto__:null,defaultErrorMap:Mn,setErrorMap:hc,getErrorMap:Us,makeIssue:Hs,EMPTY_PATH:dc,addIssueToContext:$,ParseStatus:De,INVALID:ne,DIRTY:Nn,OK:Ve,isAborted:Gi,isDirty:qi,isValid:ss,isAsync:is,get util(){return de},get objectUtil(){return Zi},ZodParsedType:W,getParsedType:Vt,ZodType:ae,datetimeRegex:uo,ZodString:rt,ZodNumber:Wt,ZodBigInt:Ut,ZodBoolean:as,ZodDate:ln,ZodSymbol:Zs,ZodUndefined:ls,ZodNull:cs,ZodAny:kn,ZodUnknown:cn,ZodNever:St,ZodVoid:Gs,ZodArray:ot,ZodObject:be,ZodUnion:us,ZodDiscriminatedUnion:qs,ZodIntersection:hs,ZodTuple:mt,ZodRecord:ds,ZodMap:Ks,ZodSet:un,ZodFunction:Dn,ZodLazy:fs,ZodLiteral:ps,ZodEnum:Ht,ZodNativeEnum:ms,ZodPromise:$n,ZodEffects:at,ZodTransformer:at,ZodOptional:gt,ZodNullable:jt,ZodDefault:gs,ZodCatch:ys,ZodNaN:Xs,BRAND:Rc,ZodBranded:Yi,ZodPipeline:vs,ZodReadonly:bs,custom:fo,Schema:ae,ZodSchema:ae,late:Ac,get ZodFirstPartyTypeKind(){return J},coerce:{string:(s=>rt.create({...s,coerce:!0})),number:(s=>Wt.create({...s,coerce:!0})),boolean:(s=>as.create({...s,coerce:!0})),bigint:(s=>Ut.create({...s,coerce:!0})),date:(s=>ln.create({...s,coerce:!0}))},any:$c,array:Vc,bigint:Mc,boolean:go,date:Nc,discriminatedUnion:jc,effect:yo,enum:eu,function:Yc,instanceof:Oc,intersection:Zc,lazy:Jc,literal:Qc,map:Kc,nan:Lc,nativeEnum:tu,never:Fc,null:Dc,nullable:iu,number:mo,object:Wc,oboolean:()=>go().optional(),onumber:()=>mo().optional(),optional:su,ostring:()=>po().optional(),pipeline:ou,preprocess:ru,promise:nu,record:qc,set:Xc,strictObject:Uc,string:po,symbol:kc,transformer:yo,tuple:Gc,undefined:Pc,union:Hc,unknown:Bc,void:zc,NEVER:ne,ZodIssueCode:R,quotelessJson:uc,ZodError:Ke});const au=p.object({data:p.unknown(),target:p.object({portId:p.string()}).optional(),replyPort:p.object({portId:p.string()}).optional()}).strict();function vo(s){return au.safeParse(s).success}const lu=p.union([p.object({success:p.literal(!0)}),p.object({success:p.literal(!1),error:p.string()})]);class bo{constructor(){this.runtime=Ws.runtime}async sendMessage(e){try{const t=await this.runtime.sendMessage(e),n=lu.safeParse(t);if(!n.success)throw new Error("Invalid response format");const i=n.data;if(!i.success)throw new Error(i.error)}catch(t){throw t instanceof Error?new Error(`Error sending message: ${t.message}`):new Error("Unexpected error while sending message to background script")}}addMessageListener(e){this.runtime.onMessage.addListener(e)}removeMessageListener(e){this.runtime.onMessage.removeListener(e)}}function cu(s){const e=s.getAttribute("src");return e===null||e.trim()===""}function uu(s){return s.src}class wo{createSendToCurrentFrameMessage(e,t){return{type:"SEND_TO_CURRENT_FRAME",data:e,replyPort:t?.transfer()}}createSendToParentFrameMessage(e,t){return{type:"SEND_TO_PARENT_FRAME",data:e,replyPort:t?.transfer()}}createSendToChildFrameMessage(e,t,n){return{type:"SEND_TO_CHILD_FRAME",data:t,targetFrame:{src:uu(e)},replyPort:n?.transfer()}}createSendToPortMessage(e,t){return{type:"SEND_TO_PORT",target:{portId:e},data:t}}createRegisterPortMessage(e){return{type:"REGISTER_PORT",portId:e}}createPortStartedMessage(e){return{type:"PORT_STARTED",portId:e}}createPortClosedMessage(e){return{type:"PORT_CLOSED",portId:e}}}class Bn{constructor(e,t){this.id=e,this.pairPortId=t,this.messageFactory=new wo,this.bgCfcClient=new bo,this.onMessageCallbacks=new Set,this.stopListening=null,this.isStarted=!1,this.isClosed=!1,this.isTransferred=!1,this.registerPort(),this.initListening()}static fromId(e){const[t,n]=e.split(":"),i=`${t}:${n==="1"?"2":"1"}`;return new Bn(e,i)}registerPort(){const e=this.messageFactory.createRegisterPortMessage(this.id);this.bgCfcClient.sendMessage(e).catch(t=>{H.error(`Error registering port: ${t}`)})}initListening(){const e=t=>{vo(t)&&t.target?.portId===this.id&&this.onMessageCallbacks.forEach(n=>{n(t.data)})};this.bgCfcClient.addMessageListener(e),this.stopListening=()=>{this.bgCfcClient.removeMessageListener(e)}}start(){if(this.isStarted||this.isClosed||this.isTransferred)return;const e=this.messageFactory.createPortStartedMessage(this.id);this.bgCfcClient.sendMessage(e).catch(t=>{H.error(`Error notifying port start: ${t}`)}),this.isStarted=!0}close(){if(this.isClosed)return;const e=this.messageFactory.createPortClosedMessage(this.id);this.bgCfcClient.sendMessage(e).catch(t=>{H.error(`Error notifying port close: ${t}`)}),this.isClosed=!0,this.stopListening?.(),this.stopListening=null}postMessage(e){if(this.isTransferred||this.isClosed){H.error("Cannot post message: port is closed or transferred.");return}const t=this.messageFactory.createSendToPortMessage(this.pairPortId,e);this.bgCfcClient.sendMessage(t).catch(n=>{H.error(`Error sending message to port: ${n}`)})}addMessageListener(e,t){if(this.isTransferred)return H.error("Cannot add message listener: port is transferred."),()=>{};this.onMessageCallbacks.add(e);const n=()=>{this.onMessageCallbacks.delete(e)};return t?.addEventListener("abort",n),n}getId(){return this.id}transfer(){if(this.isClosed)throw new Error(`Cannot transfer port "${this.id}": port is closed.`);return this.isTransferred=!0,{portId:this.id}}}class Eo{constructor(){this.channelId=ze(),this.port1=Bn.fromId(`${this.channelId}:1`),this.port2=Bn.fromId(`${this.channelId}:2`)}getPort1(){return this.port1}getPort2(){return this.port2}}class Ji extends Error{constructor(){super("replyPort must be an instance of BgScriptCrossFrameChannelPort")}}class hu{constructor(){this.bgCfcClient=new bo,this.messageFactory=new wo}async requestFromFrame(e,t){return new Promise((n,i)=>{const r=new Eo;r.getPort1().start();const o=500;let a=!1;const l=setTimeout(()=>{a||(a=!0,r.getPort1().close(),i(new io(o)))},o);r.getPort1().addMessageListener(async c=>{a||(a=!0,r.getPort1().close(),n(c),clearTimeout(l))}),this.sendToChildFrame(e,t,r.getPort2())})}sendToCurrentFrame(e,t){(async()=>{if(!this.validateReplyPort(t))throw new Ji;const n=this.messageFactory.createSendToCurrentFrameMessage(e,t);await this.bgCfcClient.sendMessage(n)})().catch(n=>{H.error(`Error broadcasting message to current frame ("${window.location.href}"): ${n.message}`)})}validateReplyPort(e){return e==null||e instanceof Bn}sendToParentFrame(e,t){(async()=>{if(!this.validateReplyPort(t))throw new Ji;const n=this.messageFactory.createSendToParentFrameMessage(e,t);await this.bgCfcClient.sendMessage(n)})().catch(n=>{H.error(`Error sending message to parent frame from frame "${window.location.href}": ${n.message}`)})}sendToChildFrame(e,t,n){(async()=>{if(!this.validateReplyPort(n))throw new Ji;if(cu(e)){H.trace(`Skipped sending message to a child frame with empty src from "${window.location.href}": frames with empty src do not have active content scripts.`);return}const i=this.messageFactory.createSendToChildFrameMessage(e,t,n);await this.bgCfcClient.sendMessage(i)})().catch(i=>{H.error(`Error sending message to child frame with src "${e.src}": ${i.message}`)})}addMessageListener(e,t){const n=r=>{vo(r)&&r.target==null&&e(r.data,r.replyPort?Bn.fromId(r.replyPort.portId):void 0)};Ws.runtime.onMessage.addListener(n);const i=()=>{Ws.runtime.onMessage.removeListener(n)};return t?.addEventListener("abort",()=>{i()}),i}createChannel(){return new Eo}}class Fn{constructor(e){this.port=e}start(){this.port.start()}close(){this.port.close()}postMessage(e){this.port.postMessage(e)}addMessageListener(e,t){const n=i=>{e(i.data)};return this.port.addEventListener("message",n,{signal:t}),()=>{this.port.removeEventListener("message",n)}}getUnderlyingPort(){return this.port}}class du{constructor(){this.messageChannel=new MessageChannel,this.port1=new Fn(this.messageChannel.port1),this.port2=new Fn(this.messageChannel.port2)}getPort1(){return this.port1}getPort2(){return this.port2}}class fu{constructor(){this.blockedOrigins=new Set([/walkme\.cloud\.sap/i])}isAllowed(e){return!this.isOriginBlocked(e)}isOriginBlocked(e){return e.origin?Array.from(this.blockedOrigins).some(t=>t.test(e.origin)):!1}}class pu{constructor(){this.messageEventFilter=new fu}async requestFromFrame(e,t){return new Promise((n,i)=>{const r=new MessageChannel;r.port1.start();const o=500;let a=!1;const l=setTimeout(()=>{a||(a=!0,r.port1.close(),i(new io(o)))},o);r.port1.addEventListener("message",c=>{a||(a=!0,r.port1.close(),n(c.data),clearTimeout(l))}),e.contentWindow?.postMessage(t,"*",[r.port2])})}sendToCurrentFrame(e,t){if(t!=null&&!(t instanceof Fn)){H.error("Failed to send message to current frame: replyPort must be an instance of WindowMessageCrossFrameChannelPort");return}window.postMessage(e,"*",t?[t.getUnderlyingPort()]:[])}sendToParentFrame(e,t){if(t!=null&&!(t instanceof Fn)){H.error("Failed to send message to parent: replyPort must be an instance of WindowMessageCrossFrameChannelPort");return}window.parent.postMessage(e,"*",t?[t.getUnderlyingPort()]:[])}sendToChildFrame(e,t,n){if(n!=null&&!(n instanceof Fn)){H.error("Failed to send message to frame: replyPort must be an instance of WindowMessageCrossFrameChannelPort");return}e.contentWindow?.postMessage(t,"*",n?[n.getUnderlyingPort()]:[])}addMessageListener(e,t){const n=i=>{this.messageEventFilter.isAllowed(i)&&e(i.data,i.ports[0]!=null?new Fn(i.ports[0]):void 0)};return window.addEventListener("message",n,{signal:t}),()=>{window.removeEventListener("message",n)}}createChannel(){return new du}}const Mr=class Mr{static getInstance(){return this.cfcInstance==null&&(mu()?this.cfcInstance=new hu:this.cfcInstance=new pu),this.cfcInstance}static async requestFromFrame(e,t){return this.getInstance().requestFromFrame(e,t)}static sendToCurrentFrame(e,t){this.getInstance().sendToCurrentFrame(e,t)}static sendToParentFrame(e,t){this.getInstance().sendToParentFrame(e,t)}static sendToChildFrame(e,t,n){this.getInstance().sendToChildFrame(e,t,n)}static addMessageListener(e,t){return this.getInstance().addMessageListener(e,t)}static createChannel(){return this.getInstance().createChannel()}};Mr.cfcInstance=null;let we=Mr;function mu(){return Ws?.runtime?.id!==void 0}const gu={action:null,value:null};let _o=class{constructor(e,t=null,n=null){this.source=null,this.id=ze(),this._window=e,this._payload=t??gu,this._inResponseTo=n}get to(){return this._window.getId()}get inResponseTo(){return this._inResponseTo}get from(){return this.source}setAction(e){if(this._payload!==null)Object.assign(this._payload,{action:e});else throw new Error("Payload is null")}setValue(e){if(this._payload!==null)Object.assign(this._payload,{value:e});else throw new Error("Payload is null")}setPayload(e){this._payload=e}async send(e=!0){const t=()=>{const n=JSON.stringify({action:"CROSS_ACTION",from:this.source,to:this._window.getId(),messageId:this.id,inResponseTo:this._inResponseTo,payload:this._payload});return we.sendToCurrentFrame(n),null};return e?new Promise(n=>{const i=this._window.onMessage(r=>{"inResponseTo"in r&&r.inResponseTo===this.id&&(n(r),i())});t()}):t()}},yu=class{constructor(e,t,n,i=null){this.to=null,this.id=e,this.from=t,this.payload=n,this.inResponseTo=i}get value(){return this.payload.value??null}setAction(e){throw new Error("Can't change the action on a response.")}setValue(e){throw new Error("Can't change the value on a response.")}setPayload(e){throw new Error("Can't change the payload of a response.")}async send(e){throw new Error("A response can't be sent. If you want to respond to this message, use the createResponse method.")}createResponse(e){const t=It.getWindowById(this.from);if(t==null)throw new Error("Window not found");return new _o(t,e,this.id)}};var ws=(s=>(s.CROSS_ACTION="CROSS_ACTION",s.CROSS_RESPONSE="CROSS_RESPONSE",s.CROSS_DETERMINE_DEPTH="CROSS_DETERMINE_DEPTH",s.SET_DEPTH="SET_DEPTH",s.CROSS_DOM_MUTATION="CROSS_DOM_MUTATION",s.SET_POST_MESSAGES_PARAMS="SET_POST_MESSAGES_PARAMS",s))(ws||{});function To(s){if(typeof s=="object")return s;if(typeof s=="string"&&s!=="")try{return JSON.parse(s)}catch{return null}return null}const Jt=class Jt{constructor(e,t=0){this.listeners=[],this.id=e,this.depth=t,Jt.windows.push(this),we.addMessageListener(async n=>{const i=To(n);if(i==null||i.action!==ws.CROSS_RESPONSE||i.to!=null||i.from!==this.id)return;const{messageId:r,from:o,inResponseTo:a,payload:l}=i,c=new yu(r,o,l,a);this.listeners.forEach(u=>u(c))})}getId(){return this.id}getDepth(){return this.depth}async send(e,t=!0){return this.message(e).send(t)}message(e=null){return new _o(this,e)}onMessage(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}}stream(e,t){return this.onMessage(n=>{n.payload.streamId===e&&t(n)})}destroy(){const e=Jt.windows.indexOf(this);e>=0&&Jt.windows.splice(e,1)}static destroyAll(){Jt.windows=[]}static init(){we.addMessageListener(async e=>{try{const t=To(e),{action:n}=t;switch(n){case ws.CROSS_DETERMINE_DEPTH:{const i=this.getWindowById(t.crossId);i!=null?(H.debug(`Received CROSS_DETERMINE_DEPTH message, sending SET_DEPTH message to window. (crossId: ${t.crossId})`),i.send({action:ws.SET_DEPTH,value:t.depth},!1)):(H.debug(`Received CROSS_DETERMINE_DEPTH message, creating CrossWindow instance. (crossId: ${t.crossId})`),new Jt(t.crossId,t.depth).send({action:ws.SET_DEPTH,value:t.depth},!1));break}}}catch{}})}static getWindows(e){return e!=null?this.windows.filter(e):this.windows}static getWindow(e){return this.windows.find(e)}static getWindowById(e){return this.getWindow(t=>t.getId()===e)??null}static broadcast(e){this.windows.forEach(t=>{t.send(e,!1)})}};Jt.windows=[];let It=Jt;function Xe(s){const e=s?.tagName.toLowerCase()??"";return s instanceof HTMLIFrameElement||s instanceof HTMLFrameElement||["iframe","frame"].includes(e)}const Ys={label:null,icon:"info",size:"medium",color:"#157ad8",text_color:"#fff",position:"right",z_index:2147483647,offset:{x:0,y:0}};let xo=(vn=class{constructor(e,t=null){this.target=null,this.element=null,this.window=null,this.beaconId=null,this._onMountedQueu=[],this.target=e,this.window=It.getWindowById(e.crossId),this.options={...vn.defaultOptions,...t??{}},this.window?.send({action:"CREATE_BEACON",value:{targetId:e.resultId,options:this.options}}).then(n=>{this.beaconId=n?.value?.beaconId??null;const i=n?.value?.boxing??so;if(this.target==null)throw new Error("Target is null");if(this.target.iframes.filter(Xe).forEach(r=>{const o=r.getBoundingClientRect();i.top+=o.top,i.bottom+=o.top,i.left+=o.left,i.right+=o.left}),this.beaconId==null)throw new Error("Beacon ID is null");this.element=new Ts(this.beaconId,this.target.crossId,i,n?.value?.DOM??{},this.target?.iframes),this._onMountedQueu.forEach(r=>{r()})})}render(){if(this.beaconId==null){this._onMountedQueu.push(()=>{this.render()});return}this.window?.send({action:"BEACON_CONTROL",value:{beaconId:this.beaconId,action:"render"}},!1)}unmount(){if(this.target!==null&&this.target.destroy(),this.beaconId==null){const e=this._onMountedQueu.indexOf(this.render);e>=0&&this._onMountedQueu.splice(e,1);return}this.window?.send({action:"BEACON_CONTROL",value:{beaconId:this.beaconId,action:"unmount"}},!1)}onClick(e,t){return this.element==null?(this._onMountedQueu.push(()=>{this.onClick(e,t)}),()=>{}):(this.element.onClick(e,!1),()=>{})}onMouseEnter(e,t){return this.element==null?(this._onMountedQueu.push(()=>{this.onMouseEnter(e,t)}),()=>{}):(this.element.onHover(e,!1),()=>{})}onMouseLeave(e,t){return this.element==null?(this._onMountedQueu.push(()=>{this.onMouseLeave(e,t)}),()=>{}):(this.element.onMouseLeave(e,!1),()=>{})}},vn.defaultOptions=Ys,vn);function vu(){return{listeners:new Map,on(s,e){return H.trace(`EventsHandler: on ${s}`),this.listeners.has(s)||this.listeners.set(s,[]),this.listeners.get(s)?.push(e),this},trigger(s,...e){H.trace(`EventsHandler: trigger ${s}`),this.listeners.get(s)?.forEach(n=>{n(...e)})},removeListener(s,e){H.trace(`EventsHandler: removeListener ${s}`);const t=this.listeners.get(s);this.listeners.set(s,t?.filter(n=>n!==e)??[])}}}const Zt=(s=document)=>s.body.tagName==="FRAMESET"&&s.body?.parentElement!==null?s.body.parentElement:s.body,So="ShowPillOption";class bu{async get(){const e=await xt.getItem(`local:${So}`);return typeof e=="boolean"?e:!1}async set(e){await xt.setItem(`local:${So}`,e)}}class wu{constructor(e,t=document){this.id=e,this.pillElement=null,this.shouldShowPill=null,this.targetDocument=t,this.initPill(),this.pillExtensionStorage=new bu}initPill(){this.pillElement=this.targetDocument.createElement("div"),this.pillElement.setAttribute("id",`highlighter-pill-${this.id}`),Zt(this.targetDocument).appendChild(this.pillElement)}remove(){this.pillElement?.remove(),this.pillElement=null}hide(){this.pillElement?.remove()}async update(e,t,n){if(this.shouldShowPill===null)try{this.shouldShowPill=await this.pillExtensionStorage.get()}catch(i){H.warn("Failed to get showPill option from storage",i),this.shouldShowPill=!1}if(!this.shouldShowPill){this.hide();return}if(this.ensurePillExists(),this.pillElement!=null){this.pillElement.textContent=e;const i=_u(t,n,this.pillElement);Object.entries(i).forEach(([r,o])=>{const a=r.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase();this.pillElement?.style.setProperty(a,o)})}}ensurePillExists(){(this.pillElement==null||!Zt(this.targetDocument).contains(this.pillElement))&&this.initPill()}}const Eu={position:"fixed",pointerEvents:"none",zIndex:"2147483647",backgroundColor:"#157ad8",color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontFamily:"monospace",whiteSpace:"nowrap",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"};function _u(s,e,t){const n={...Eu};e?.color!=null&&(n.backgroundColor=e.color);const i=4;let r=24,o=300;if(t){Object.entries(n).forEach(([T,k])=>{const y=T.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase();t.style.setProperty(y,String(k))}),t.offsetHeight;const E=t.getBoundingClientRect();o=E.width,r=E.height}let a=s.bottom+i,{left:l}=s;const c=window.innerWidth;l+o>c&&(l=s.right-o);const f=window.innerHeight;return a+r>f&&(a=s.top-r-i),n.top=`${a}px`,n.left=`${l}px`,n}const Tu=["top","right","bottom","left"];function Qi(s,e){return typeof s=="function"?s(e):s}function er(s){return s.split("-")[0]}function Co(s){return s.split("-")[1]}function xu(s){return s==="x"?"y":"x"}function Su(s){return s==="y"?"height":"width"}const Cu=new Set(["top","bottom"]);function tr(s){return Cu.has(er(s))?"y":"x"}function Iu(s){return xu(tr(s))}function Ru(s){return{top:0,right:0,bottom:0,left:0,...s}}function Au(s){return typeof s!="number"?Ru(s):{top:s,right:s,bottom:s,left:s}}function Js(s){const{x:e,y:t,width:n,height:i}=s;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function Io(s,e,t){let{reference:n,floating:i}=s;const r=tr(e),o=Iu(e),a=Su(o),l=er(e),c=r==="y",u=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,E=n[a]/2-i[a]/2;let T;switch(l){case"top":T={x:u,y:n.y-i.height};break;case"bottom":T={x:u,y:n.y+n.height};break;case"right":T={x:n.x+n.width,y:f};break;case"left":T={x:n.x-i.width,y:f};break;default:T={x:n.x,y:n.y}}switch(Co(e)){case"start":T[o]-=E*(t&&c?-1:1);break;case"end":T[o]+=E*(t&&c?-1:1);break}return T}const Ou=async(s,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:o}=t,a=r.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:s,floating:e,strategy:i}),{x:u,y:f}=Io(c,n,l),E=n,T={},k=0;for(let y=0;y<a.length;y++){const{name:v,fn:w}=a[y],{x:_,y:A,data:L,reset:B}=await w({x:u,y:f,initialPlacement:n,placement:E,strategy:i,middlewareData:T,rects:c,platform:o,elements:{reference:s,floating:e}});u=_??u,f=A??f,T={...T,[v]:{...T[v],...L}},B&&k<=50&&(k++,typeof B=="object"&&(B.placement&&(E=B.placement),B.rects&&(c=B.rects===!0?await o.getElementRects({reference:s,floating:e,strategy:i}):B.rects),{x:u,y:f}=Io(c,E,l)),y=-1)}return{x:u,y:f,placement:E,strategy:i,middlewareData:T}};async function Ro(s,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:r,rects:o,elements:a,strategy:l}=s,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:E=!1,padding:T=0}=Qi(e,s),k=Au(T),v=a[E?f==="floating"?"reference":"floating":f],w=Js(await r.getClippingRect({element:(t=await(r.isElement==null?void 0:r.isElement(v)))==null||t?v:v.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_=f==="floating"?{x:n,y:i,width:o.floating.width,height:o.floating.height}:o.reference,A=await(r.getOffsetParent==null?void 0:r.getOffsetParent(a.floating)),L=await(r.isElement==null?void 0:r.isElement(A))?await(r.getScale==null?void 0:r.getScale(A))||{x:1,y:1}:{x:1,y:1},B=Js(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:A,strategy:l}):_);return{top:(w.top-B.top+k.top)/L.y,bottom:(B.bottom-w.bottom+k.bottom)/L.y,left:(w.left-B.left+k.left)/L.x,right:(B.right-w.right+k.right)/L.x}}function Ao(s,e){return{top:s.top-e.height,right:s.right-e.width,bottom:s.bottom-e.height,left:s.left-e.width}}function Oo(s){return Tu.some(e=>s[e]>=0)}const Lu=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...i}=Qi(s,e);switch(n){case"referenceHidden":{const r=await Ro(e,{...i,elementContext:"reference"}),o=Ao(r,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Oo(o)}}}case"escaped":{const r=await Ro(e,{...i,altBoundary:!0}),o=Ao(r,t.floating);return{data:{escapedOffsets:o,escaped:Oo(o)}}}default:return{}}}}},Mu=new Set(["left","top"]);async function Nu(s,e){const{placement:t,platform:n,elements:i}=s,r=await(n.isRTL==null?void 0:n.isRTL(i.floating)),o=er(t),a=Co(t),l=tr(t)==="y",c=Mu.has(o)?-1:1,u=r&&l?-1:1,f=Qi(e,s);let{mainAxis:E,crossAxis:T,alignmentAxis:k}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof k=="number"&&(T=a==="end"?k*-1:k),l?{x:T*u,y:E*c}:{x:E*c,y:T*u}}const ku=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(e){var t,n;const{x:i,y:r,placement:o,middlewareData:a}=e,l=await Nu(e,s);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:r+l.y,data:{...l,placement:o}}}}},nr=Math.min,zn=Math.max,Qs=Math.round,ei=Math.floor,yt=s=>({x:s,y:s});function ti(){return typeof window<"u"}function Vn(s){return Lo(s)?(s.nodeName||"").toLowerCase():"#document"}function Ye(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function vt(s){var e;return(e=(Lo(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function Lo(s){return ti()?s instanceof Node||s instanceof Ye(s).Node:!1}function lt(s){return ti()?s instanceof Element||s instanceof Ye(s).Element:!1}function bt(s){return ti()?s instanceof HTMLElement||s instanceof Ye(s).HTMLElement:!1}function Mo(s){return!ti()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof Ye(s).ShadowRoot}const Pu=new Set(["inline","contents"]);function Es(s){const{overflow:e,overflowX:t,overflowY:n,display:i}=ct(s);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!Pu.has(i)}const Du=new Set(["table","td","th"]);function $u(s){return Du.has(Vn(s))}const Bu=[":popover-open",":modal"];function ni(s){return Bu.some(e=>{try{return s.matches(e)}catch{return!1}})}const Fu=["transform","translate","scale","rotate","perspective"],zu=["transform","translate","scale","rotate","perspective","filter"],Vu=["paint","layout","strict","content"];function sr(s){const e=ir(),t=lt(s)?ct(s):s;return Fu.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||zu.some(n=>(t.willChange||"").includes(n))||Vu.some(n=>(t.contain||"").includes(n))}function Wu(s){let e=Gt(s);for(;bt(e)&&!Wn(e);){if(sr(e))return e;if(ni(e))return null;e=Gt(e)}return null}function ir(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Uu=new Set(["html","body","#document"]);function Wn(s){return Uu.has(Vn(s))}function ct(s){return Ye(s).getComputedStyle(s)}function si(s){return lt(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function Gt(s){if(Vn(s)==="html")return s;const e=s.assignedSlot||s.parentNode||Mo(s)&&s.host||vt(s);return Mo(e)?e.host:e}function No(s){const e=Gt(s);return Wn(e)?s.ownerDocument?s.ownerDocument.body:s.body:bt(e)&&Es(e)?e:No(e)}function _s(s,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=No(s),r=i===((n=s.ownerDocument)==null?void 0:n.body),o=Ye(i);if(r){const a=rr(o);return e.concat(o,o.visualViewport||[],Es(i)?i:[],a&&t?_s(a):[])}return e.concat(i,_s(i,[],t))}function rr(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function ko(s){const e=ct(s);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=bt(s),r=i?s.offsetWidth:t,o=i?s.offsetHeight:n,a=Qs(t)!==r||Qs(n)!==o;return a&&(t=r,n=o),{width:t,height:n,$:a}}function or(s){return lt(s)?s:s.contextElement}function Un(s){const e=or(s);if(!bt(e))return yt(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:r}=ko(e);let o=(r?Qs(t.width):t.width)/n,a=(r?Qs(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Hu=yt(0);function Po(s){const e=Ye(s);return!ir()||!e.visualViewport?Hu:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ju(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ye(s)?!1:e}function hn(s,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=s.getBoundingClientRect(),r=or(s);let o=yt(1);e&&(n?lt(n)&&(o=Un(n)):o=Un(s));const a=ju(r,t,n)?Po(r):yt(0);let l=(i.left+a.x)/o.x,c=(i.top+a.y)/o.y,u=i.width/o.x,f=i.height/o.y;if(r){const E=Ye(r),T=n&&lt(n)?Ye(n):n;let k=E,y=rr(k);for(;y&&n&&T!==k;){const v=Un(y),w=y.getBoundingClientRect(),_=ct(y),A=w.left+(y.clientLeft+parseFloat(_.paddingLeft))*v.x,L=w.top+(y.clientTop+parseFloat(_.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,f*=v.y,l+=A,c+=L,k=Ye(y),y=rr(k)}}return Js({width:u,height:f,x:l,y:c})}function ii(s,e){const t=si(s).scrollLeft;return e?e.left+t:hn(vt(s)).left+t}function Do(s,e){const t=s.getBoundingClientRect(),n=t.left+e.scrollLeft-ii(s,t),i=t.top+e.scrollTop;return{x:n,y:i}}function Zu(s){let{elements:e,rect:t,offsetParent:n,strategy:i}=s;const r=i==="fixed",o=vt(n),a=e?ni(e.floating):!1;if(n===o||a&&r)return t;let l={scrollLeft:0,scrollTop:0},c=yt(1);const u=yt(0),f=bt(n);if((f||!f&&!r)&&((Vn(n)!=="body"||Es(o))&&(l=si(n)),bt(n))){const T=hn(n);c=Un(n),u.x=T.x+n.clientLeft,u.y=T.y+n.clientTop}const E=o&&!f&&!r?Do(o,l):yt(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+E.x,y:t.y*c.y-l.scrollTop*c.y+u.y+E.y}}function Gu(s){return Array.from(s.getClientRects())}function qu(s){const e=vt(s),t=si(s),n=s.ownerDocument.body,i=zn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),r=zn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+ii(s);const a=-t.scrollTop;return ct(n).direction==="rtl"&&(o+=zn(e.clientWidth,n.clientWidth)-i),{width:i,height:r,x:o,y:a}}const $o=25;function Ku(s,e){const t=Ye(s),n=vt(s),i=t.visualViewport;let r=n.clientWidth,o=n.clientHeight,a=0,l=0;if(i){r=i.width,o=i.height;const u=ir();(!u||u&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}const c=ii(n);if(c<=0){const u=n.ownerDocument,f=u.body,E=getComputedStyle(f),T=u.compatMode==="CSS1Compat"&&parseFloat(E.marginLeft)+parseFloat(E.marginRight)||0,k=Math.abs(n.clientWidth-f.clientWidth-T);k<=$o&&(r-=k)}else c<=$o&&(r+=c);return{width:r,height:o,x:a,y:l}}const Xu=new Set(["absolute","fixed"]);function Yu(s,e){const t=hn(s,!0,e==="fixed"),n=t.top+s.clientTop,i=t.left+s.clientLeft,r=bt(s)?Un(s):yt(1),o=s.clientWidth*r.x,a=s.clientHeight*r.y,l=i*r.x,c=n*r.y;return{width:o,height:a,x:l,y:c}}function Bo(s,e,t){let n;if(e==="viewport")n=Ku(s,t);else if(e==="document")n=qu(vt(s));else if(lt(e))n=Yu(e,t);else{const i=Po(s);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Js(n)}function Fo(s,e){const t=Gt(s);return t===e||!lt(t)||Wn(t)?!1:ct(t).position==="fixed"||Fo(t,e)}function Ju(s,e){const t=e.get(s);if(t)return t;let n=_s(s,[],!1).filter(a=>lt(a)&&Vn(a)!=="body"),i=null;const r=ct(s).position==="fixed";let o=r?Gt(s):s;for(;lt(o)&&!Wn(o);){const a=ct(o),l=sr(o);!l&&a.position==="fixed"&&(i=null),(r?!l&&!i:!l&&a.position==="static"&&!!i&&Xu.has(i.position)||Es(o)&&!l&&Fo(s,o))?n=n.filter(u=>u!==o):i=a,o=Gt(o)}return e.set(s,n),n}function Qu(s){let{element:e,boundary:t,rootBoundary:n,strategy:i}=s;const o=[...t==="clippingAncestors"?ni(e)?[]:Ju(e,this._c):[].concat(t),n],a=o[0],l=o.reduce((c,u)=>{const f=Bo(e,u,i);return c.top=zn(f.top,c.top),c.right=nr(f.right,c.right),c.bottom=nr(f.bottom,c.bottom),c.left=zn(f.left,c.left),c},Bo(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function eh(s){const{width:e,height:t}=ko(s);return{width:e,height:t}}function th(s,e,t){const n=bt(e),i=vt(e),r=t==="fixed",o=hn(s,!0,r,e);let a={scrollLeft:0,scrollTop:0};const l=yt(0);function c(){l.x=ii(i)}if(n||!n&&!r)if((Vn(e)!=="body"||Es(i))&&(a=si(e)),n){const T=hn(e,!0,r,e);l.x=T.x+e.clientLeft,l.y=T.y+e.clientTop}else i&&c();r&&!n&&i&&c();const u=i&&!n&&!r?Do(i,a):yt(0),f=o.left+a.scrollLeft-l.x-u.x,E=o.top+a.scrollTop-l.y-u.y;return{x:f,y:E,width:o.width,height:o.height}}function ar(s){return ct(s).position==="static"}function zo(s,e){if(!bt(s)||ct(s).position==="fixed")return null;if(e)return e(s);let t=s.offsetParent;return vt(s)===t&&(t=t.ownerDocument.body),t}function Vo(s,e){const t=Ye(s);if(ni(s))return t;if(!bt(s)){let i=Gt(s);for(;i&&!Wn(i);){if(lt(i)&&!ar(i))return i;i=Gt(i)}return t}let n=zo(s,e);for(;n&&$u(n)&&ar(n);)n=zo(n,e);return n&&Wn(n)&&ar(n)&&!sr(n)?t:n||Wu(s)||t}const nh=async function(s){const e=this.getOffsetParent||Vo,t=this.getDimensions,n=await t(s.floating);return{reference:th(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function sh(s){return ct(s).direction==="rtl"}const ih={convertOffsetParentRelativeRectToViewportRelativeRect:Zu,getDocumentElement:vt,getClippingRect:Qu,getOffsetParent:Vo,getElementRects:nh,getClientRects:Gu,getDimensions:eh,getScale:Un,isElement:lt,isRTL:sh};function Wo(s,e){return s.x===e.x&&s.y===e.y&&s.width===e.width&&s.height===e.height}function rh(s,e){let t=null,n;const i=vt(s);function r(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),r();const c=s.getBoundingClientRect(),{left:u,top:f,width:E,height:T}=c;if(a||e(),!E||!T)return;const k=ei(f),y=ei(i.clientWidth-(u+E)),v=ei(i.clientHeight-(f+T)),w=ei(u),A={rootMargin:-k+"px "+-y+"px "+-v+"px "+-w+"px",threshold:zn(0,nr(1,l))||1};let L=!0;function B(N){const Q=N[0].intersectionRatio;if(Q!==l){if(!L)return o();Q?o(!1,Q):n=setTimeout(()=>{o(!1,1e-7)},1e3)}Q===1&&!Wo(c,s.getBoundingClientRect())&&o(),L=!1}try{t=new IntersectionObserver(B,{...A,root:i.ownerDocument})}catch{t=new IntersectionObserver(B,A)}t.observe(s)}return o(!0),r}function Uo(s,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=or(s),u=i||r?[...c?_s(c):[],..._s(e)]:[];u.forEach(w=>{i&&w.addEventListener("scroll",t,{passive:!0}),r&&w.addEventListener("resize",t)});const f=c&&a?rh(c,t):null;let E=-1,T=null;o&&(T=new ResizeObserver(w=>{let[_]=w;_&&_.target===c&&T&&(T.unobserve(e),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var A;(A=T)==null||A.observe(e)})),t()}),c&&!l&&T.observe(c),T.observe(e));let k,y=l?hn(s):null;l&&v();function v(){const w=hn(s);y&&!Wo(y,w)&&t(),y=w,k=requestAnimationFrame(v)}return t(),()=>{var w;u.forEach(_=>{i&&_.removeEventListener("scroll",t),r&&_.removeEventListener("resize",t)}),f?.(),(w=T)==null||w.disconnect(),T=null,l&&cancelAnimationFrame(k)}}const oh=ku,ah=Lu,lh=(s,e,t)=>{const n=new Map,i={platform:ih,...t},r={...i.platform,_c:n};return Ou(s,e,{...i,platform:r})},lr="#157ad8",ch={position:"fixed",pointerEvents:"none",boxSizing:"border-box",zIndex:"2147483646",backgroundColor:"transparent",border:"4px solid",borderColor:lr};class cr{constructor(e,t=document){this.autoUpdateCleanup=null,this.id=ze(),this.options=e??{type:null,color:lr},this.targetDocument=t,this.pill=new wu(this.id,this.targetDocument)}getElementId(){return`highlighter-${this.id}`}getElement(){return this.targetDocument.getElementById(this.getElementId())}getOrCreateElement(){const e=this.getElement();if(e!=null)return e;const t=this.targetDocument.createElement("div");return t.setAttribute("id",this.getElementId()),Zt(this.targetDocument).appendChild(t),t}show(e,t){t!=null&&(this.options=t),this.updateHighlight(e)}attachToElement(e){this.autoUpdateCleanup?.();const t=this.getOrCreateElement();this.autoUpdateCleanup=Uo(e,t,()=>{const n=e.getBoundingClientRect();this.show(n)})}update(e){return this.options=e(this.options),this.options}hide(){this.autoUpdateCleanup?.(),this.autoUpdateCleanup=null,this.getElement()?.remove(),this.pill.remove()}updateHighlight(e){const t=this.getOrCreateElement(),n=uh(e,this.options);Object.entries(n).forEach(([i,r])=>{const o=i.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase();t.style.setProperty(o,r)}),this.options?.selector?this.pill.update(this.options.selector,e,this.options):this.pill.hide()}}function uh(s,e){const{width:t,height:n,top:i,left:r}=s,o={...ch,borderColor:e?.color??lr,display:e?.type==="none"?"none":"block"};if(e?.type==="none")return o;switch(e?.type){case"inset":o.top=`${i}px`,o.left=`${r}px`,o.width=`${t}px`,o.height=`${n}px`;break;case"outset":o.top=`${i-4}px`,o.left=`${r-4}px`,o.width=`${t+8}px`,o.height=`${n+8}px`;break;default:o.top=`${i-2}px`,o.left=`${r-2}px`,o.width=`${t+4}px`,o.height=`${n+4}px`}return o}function hh(s,e,t={}){const{interval:n=100,immediate:i=!0}=t;let r=null,o=!1;const a=u=>r===null?!0:r.top!==u.top||r.left!==u.left||r.width!==u.width||r.height!==u.height,l=async()=>{if(o)return;const u=await s();a(u)&&(r=u,e(u))};i&&l();const c=setInterval(()=>{l()},n);return()=>{o=!0,clearInterval(c)}}class Ts{constructor(e,t,n,i,r=[]){this.cleanupFunctions=[],this.highlight=null,this.highlightMoveUnlistener=null,this.resultId=e,this.crossId=t,this.boxing=n,this.domInfo=i,this.iframes=r}setText(e){It.getWindowById(this.crossId)?.send({action:"SET_TEXT",value:{resultId:this.resultId,text:e}})}async getText(){return await new Promise(e=>{this.getWindow()?.send({action:"GET_TEXT",value:this.resultId}).then(t=>{e(t?.value??null)})})}async getAttributes(){return this.domInfo.attributes??{}}async getTagName(){return this.domInfo.tagName??""}async getRect(){const e=await this.updateBoxing();return e!=null&&(this.boxing=e),new DOMRect(this.boxing.left,this.boxing.top,this.boxing.width,this.boxing.height)}remove(){It.getWindowById(this.crossId)?.send({action:"REMOVE",value:this.resultId})}async isInViewport(){return await new Promise(e=>{setTimeout(()=>{e(!1)},150),this.getWindow()?.send({action:"IS_IN_VIEWPORT",value:this.resultId}).then(t=>{e(t?.value!=null)}).catch(()=>{e(!1)})})}async safeIsInViewport(){return this.isInViewport()}async isRendered(){return await new Promise(e=>{setTimeout(()=>{e(!1)},150),this.getWindow()?.send({action:"IS_RENDERED",value:this.resultId}).then(t=>{e(t?.value===!0)}).catch(()=>{e(!1)})})}async safeIsRendered(){return this.isRendered()}onClick(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"click",once:t}};if(t)return this.getWindow()?.send(i).then(()=>{e()}),()=>null;{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onMousedown(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"mousedown",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e()}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onHover(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"hover",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e()}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onMouseLeave(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"mouseleave",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e()}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onFocus(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"focus",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e()}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onBlur(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"blur",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e()}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e()});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onChange(e,t=!0){const n=t?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"change",once:t}};if(t){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e(void 0)}),()=>r=!0}else{const r=this.getWindow()?.stream(n,()=>{e(void 0)});return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),typeof r=="function"?r:null}}onAppear(e,t=!0,n=150){let i=null,r=!0;(async()=>{let l=!1,c=await this.isInViewport();c&&(e(),l=!0);const u=async()=>{const f=c;c=await this.isInViewport(),f!==c&&c&&r&&(!t||t&&!l)&&(e(),l=!0)};i=setInterval(()=>{u()},n)})();const a=()=>{r=!1,i!=null&&clearInterval(i)};return this.cleanupFunctions.push(a),a}onDisappear(e,t=!0,n=150){let i=null,r=!0;(async()=>{let l=!1,c=await this.isInViewport();c||(e(),l=!0);const u=async()=>{const f=c;c=await this.isInViewport(),f!==c&&(c||r&&(!t||t&&!l)&&(e(),l=!0))};i=setInterval(()=>{u()},n)})();const a=()=>{r=!1,i!=null&&clearInterval(i)};return this.cleanupFunctions.push(a),a}onInput(e,t){const n=t===!0?null:ze(),i={action:"SETUP_TRIGGER",streamId:n??void 0,value:{resultId:this.resultId,triggerType:"input",once:t}};if(t===!0){let r=!1;return this.getWindow()?.send(i).then(()=>{r||e(null)}),()=>r=!0}else{const r=this.getWindow()?.stream(n,o=>{e(o.value)})??null;return typeof r=="function"&&this.cleanupFunctions.push(r),this.getWindow()?.send(i,!1),r}}async updateBoxing(){return await this.getWindow()?.send({action:"GET_BOXING",value:{resultId:this.resultId}}).then(e=>{const t=e?.value?.boxing??so;return this.iframes.filter(Xe).forEach(n=>{const i=n.getBoundingClientRect(),r=window.getComputedStyle(n);t.top+=i.top+(r.borderTopWidth!=null?ri(r.borderTopWidth):0)+(r.paddingTop!=null?ri(r.paddingTop):0),t.right+=i.left,t.bottom+=i.top,t.left+=i.left+(r.borderLeftWidth!=null?ri(r.borderLeftWidth):0)+(r.paddingLeft!=null?ri(r.paddingLeft):0)}),t})??null}async focus(){this.getWindow()?.send({action:"SCROLL_INTO_VIEW"})}onMove(e){let t=null;const n=async()=>{const o=await this.getRect();t==null&&(t=o),!(t.x===o.x&&t.y===o.y&&t.width===o.width&&t.height===o.height)&&(t=o,e({rect:o}))},i=setInterval(()=>{n()},250),r=()=>{clearInterval(i)};return this.cleanupFunctions.push(r),r}onRemove(e){const t=ze(),n={action:"SETUP_TRIGGER",streamId:t,value:{resultId:this.resultId,triggerType:"remove"}},i=this.getWindow()?.stream(t,()=>{e()})??(()=>{});return this.cleanupFunctions.push(i),this.getWindow()?.send(n,!1),i}getWindow(){return It.getWindowById(this.crossId)??null}destroy(){this.cleanupFunctions.forEach(e=>{e()}),this.cleanupFunctions=[]}attachHighlight(e){this.detachHighlight(),this.highlight=new cr({color:e.color,type:e.type,selector:e.selector},document),this.highlightMoveUnlistener=hh(async()=>this.getRect(),t=>this.highlight?.show(t))}detachHighlight(){this.highlightMoveUnlistener?.(),this.highlightMoveUnlistener=null,this.highlight?.hide(),this.highlight=null}async attachBeacon(e,t="v1"){const n=new xo(this,e);return n.render(),new dh(n)}}class dh{constructor(e){this.onClick=t=>{this.beacon.onClick(t)},this.onMouseEnter=t=>{this.beacon.onMouseEnter(t)},this.onMouseLeave=t=>{this.beacon.onMouseLeave(t)},this.destroy=()=>{this.beacon.unmount()},this.getTarget=()=>this.beacon.element,this.beacon=e}}function ri(s){return s==null||s===""?0:parseInt(s.replace("px","").trim(),10)}const ur=s=>{s.parentNode?.removeChild!==null&&s.parentNode?.removeChild(s)};function oi(s){const e=s.getBoundingClientRect();return e.width>0&&e.height>0}function Ho(s){return"offsetParent"in s&&s?.offsetParent!=null}function jo(s){return s.isConnected!=null?!!s.isConnected:!0}const dn=s=>{const e=window.getComputedStyle(s);return s.tagName.toUpperCase()==="IFRAME"?!0:e.visibility==="hidden"?!1:e.position==="fixed"?oi(s):Ho(s)?jo(s)?Zo(s):!1:e.position==="static"?oi(s):!1};function Zo(s){const e=s.getBoundingClientRect(),t=s.ownerDocument.defaultView;if(!t)return!1;const n=e.left<t.innerWidth&&e.right>0,i=e.top<t.innerHeight&&e.bottom>0;if(!n||!i)return!1;const r=t.frameElement;return r?Zo(r):!0}function ut(s){const e=window.getComputedStyle(s);if(e.visibility==="hidden"||e.display==="none"||!jo(s))return!1;if(s.tagName.toUpperCase()==="IFRAME"){const n=s.ownerDocument.defaultView;if(n){const i=n.frameElement;if(i)return ut(i)}return!0}if(e.position==="fixed"){if(!oi(s))return!1}else if(!Ho(s))if(e.position==="static"){if(!oi(s))return!1}else return!1;const t=s.ownerDocument.defaultView;if(t){const n=t.frameElement;if(n)return ut(n)}return!0}const tt=5,Go=12,nt={very_small:{height:11,svg:{width:"auto",height:"auto",padding:"1px",marginTop:"0px"},text:{padding:"0 3px 0 0",fontSize:"6px"},textWithoutIcon:{padding:"0 3px 0 3px",fontSize:"6px"}},small:{height:20,svg:{width:"20px",height:"14px",marginTop:"3px"},text:{padding:"0 7px 0 0",fontSize:"12px"},textWithoutIcon:{padding:"0 7px 0 7px",fontSize:"12px"}},medium:{height:26,svg:{width:"26px",height:"18px",marginTop:"4px"},text:{padding:"0 12px 0 0",fontSize:"14px"},textWithoutIcon:{padding:"0 12px",fontSize:"12px"}},large:{height:32,svg:{width:"32px",height:"22px",marginTop:"5px"},text:{padding:"0 15px 0 0",fontSize:"14px"},textWithoutIcon:{padding:"0 15px 0 15px",fontSize:"12px"}}},fh={very_small:nt.very_small.height,small:nt.small.height,medium:nt.medium.height,large:nt.large.height},ph=s=>{switch(s){case"top":return"translateX(-50%) translateY(-100%)";case"right":return"translateY(-50%)";case"bottom":return"translateX(-50%)";case"left":return"translateX(-100%) translateY(-50%)";default:return null}},mh="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let qo=(s=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(s));for(;s--;)e+=mh[t[s]&63];return e};const Ko=1e4,ai={},Xo={};function gh(s){return s==null?!1:ai[s]>Ko}function yh(s){s!=null&&(ai[s]<=0&&(ai[s]=0),ai[s]++)}function vh(s,e){s!=null&&(Xo[s]||(H.warn(`The beacon position targeting the following element has been updated ${Ko} times. This probably indicates an infinite loop, further updates are cancelled to prevent freezing the application`,e),Xo[s]=!0))}const bh=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 792">
    <path style='fill: currentColor' d="M306,522.51c21.559,0,39.503-16.516,41.319-38l28.028-334.747c1.631-19.415-4.951-38.607-18.13-52.942 C344.056,82.505,325.468,74.347,306,74.347c-19.47,0-38.056,8.158-51.219,22.474c-13.181,14.335-19.76,33.527-18.128,52.942 l28.028,334.747C266.496,505.994,284.441,522.51,306,522.51z"/>
    <path style='fill: currentColor' d="M306,576.316c-30.198,0-54.669,24.469-54.669,54.668s24.471,54.668,54.669,54.668c30.197,0,54.669-24.469,54.669-54.668 S336.197,576.316,306,576.316z"/>
</svg>`,wh=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" onClick={this.props.onClick}
    className='ll-editor--icon ll-editor--icon-empty'>
</svg>`,Eh=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
	<path style='fill: currentColor' d="M12.79,15.2A7.34,7.34,0,0,1,8.6,17.82c-.69,0-1.22-.47-.72-2.57L9.12,9.91c.12-.59.15-.83,0-.83a4.56,4.56,0,0,0-1.45.83l-.34-.67c1.72-1.59,3.48-2.52,4.34-2.52.69,0,.81.93.48,2.36l-1.36,5.53c-.17.69-.1.93.07.93a3.65,3.65,0,0,0,1.53-1ZM13.1,3.41a1.84,1.84,0,0,1-1.81,1.85c-.83,0-1.31-.54-1.33-1.47A1.81,1.81,0,0,1,11.77,2,1.29,1.29,0,0,1,13.1,3.41Z"/>
</svg>`,_h=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.625 511.625">
    <path style='fill: currentColor' d="M432.497,157.859c-18.216-22.387-42.959-40.071-74.224-53.049c-31.265-12.976-65.42-19.466-102.456-19.466 c-27.627,0-54.038,3.832-79.233,11.497c-25.196,7.665-46.9,18.024-65.115,31.078c-18.218,13.054-32.71,28.574-43.488,46.559 c-10.779,17.986-16.167,36.847-16.167,56.58c0,22.767,6.866,44.099,20.604,63.982c13.738,19.882,32.519,36.58,56.352,50.09 c-1.671,6.068-3.645,11.84-5.921,17.299c-2.277,5.465-4.326,9.947-6.147,13.438c-1.823,3.491-4.288,7.363-7.402,11.614 c-3.109,4.249-5.462,7.246-7.056,8.99c-1.592,1.746-4.211,4.635-7.855,8.651c-3.641,4.026-5.995,6.644-7.056,7.859 c-0.154,0.071-0.76,0.758-1.822,2.046c-1.062,1.289-1.594,1.934-1.594,1.934l-1.366,2.047c-0.76,1.14-1.101,1.86-1.027,2.158 c0.077,0.298-0.074,1.061-0.454,2.272c-0.381,1.219-0.342,2.13,0.113,2.738v0.228c0.61,2.733,1.938,4.933,3.986,6.599 c2.048,1.669,4.365,2.354,6.944,2.046c9.868-1.215,18.519-2.877,25.956-5.006c39.769-10.174,74.681-28.535,104.733-55.102 c11.381,1.214,22.386,1.822,33.012,1.822c37.034,0,71.189-6.489,102.456-19.472c31.268-12.976,56.009-30.66,74.221-53.044 c18.218-22.378,27.324-46.781,27.324-73.191C459.813,204.645,450.708,180.243,432.497,157.859z"/>
</svg>`,Th=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" >
    <path style='fill: currentColor' d="M5.71,8a4.2,4.2,0,0,1,4.34-4.41c3.36,0,4.45,2.09,4.45,3.45,0,3.41-2.95,2.95-3.25,5.11v.68H8.83v-.8c.25-3.1,2.92-2.81,2.86-4.74a1.4,1.4,0,0,0-1.52-1.61C8.89,5.71,8.33,6.77,8.33,8Zm2.87,5.9h2.81v2.75H8.58Z"/>
</svg>`,xh=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path style='fill: currentColor' d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.507 13.941c-1.512 1.195-3.174 1.931-5.506 1.931-2.334 0-3.996-.736-5.508-1.931l-.493.493c1.127 1.72 3.2 3.566 6.001 3.566 2.8 0 4.872-1.846 5.999-3.566l-.493-.493zm-9.007-5.941c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5-.672-1.5-1.5-1.5zm7 0c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5-.672-1.5-1.5-1.5z"/>
</svg>`,Sh=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path className='ll-editor--icon-fill' fill="currentColor"
                d="M478.21 334.093L336 256l142.21-78.093c11.795-6.477 15.961-21.384 9.232-33.037l-19.48-33.741c-6.728-11.653-21.72-15.499-33.227-8.523L296 186.718l3.475-162.204C299.763 11.061 288.937 0 275.48 0h-38.96c-13.456 0-24.283 11.061-23.994 24.514L216 186.718 77.265 102.607c-11.506-6.976-26.499-3.13-33.227 8.523l-19.48 33.741c-6.728 11.653-2.562 26.56 9.233 33.037L176 256 33.79 334.093c-11.795 6.477-15.961 21.384-9.232 33.037l19.48 33.741c6.728 11.653 21.721 15.499 33.227 8.523L216 325.282l-3.475 162.204C212.237 500.939 223.064 512 236.52 512h38.961c13.456 0 24.283-11.061 23.995-24.514L296 325.282l138.735 84.111c11.506 6.976 26.499 3.13 33.227-8.523l19.48-33.741c6.728-11.653 2.563-26.559-9.232-33.036z">
            </path>
</svg>`,Hn={textWithIcon:"_textWithIcon_t2uk3_1",textWithoutIcon:"_textWithoutIcon_t2uk3_7"};function Yo(s){switch(s){case"info":return Eh;case"question":return Th;case"danger":return bh;case"message":return _h;case"smiley":return xh;case"empty":return wh;case"star":return Sh;default:return null}}function Jo(s,e){const t=document.createElement("span");return t.innerText=s,t.classList.add(e),t}function Qo(s,e){const t=Yo(e.icon);if(!(e.label!=null&&e.label.length>0))t!==null&&(s.innerHTML+=t);else{const i=e.label??"";e.icon!=="empty"?(t!==null&&(s.innerHTML+=t),s.appendChild(Jo(i,Hn.textWithIcon))):s.appendChild(Jo(i,Hn.textWithoutIcon))}}function Ch(s){return s.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function li(s){return Object.entries(s).filter(([e,t])=>t!=null&&t!=="").map(([e,t])=>`${Ch(e)}: ${t} !important`).join("; ")}function ea(s){const e=s.size??"medium",t=s.position??"right",n=nt[e]??nt.medium,i=`${n.height}px`,r=`${n.height/2}px`,o=s.color??"#157ad8",a=s.text_color??"#fff",l=s.z_index??void 0,c=ph(t),u={zIndex:l,display:"inline-flex",flexWrap:"nowrap",alignItems:"center",height:i,minWidth:i,margin:"0",padding:"0",color:a,lineHeight:i,fontFamily:"Helvetica, Arial, sans-serif",backgroundColor:o,borderRadius:r,overflow:"hidden",cursor:"pointer"};return c!=null&&(u.transform=c),li(u)}function ta(s){const e=nt[s.size??"medium"]??nt.medium,t=s.text_color??"#fff",n={float:"left",width:e.svg.width,height:e.svg.height,color:t,background:"none",boxShadow:"none",padding:e.svg.padding??"0"};return li(n)}function na(s){const e=nt[s.size??"medium"]??nt.medium,t=s.text_color??"#fff",n={display:"inline-flex",alignItems:"center",float:"left",height:e.svg.height,padding:e.text.padding,color:t,fontSize:e.text.fontSize,fontWeight:"normal",textWrap:"nowrap"};return li(n)}function sa(s){const e=nt[s.size??"medium"]??nt.medium,t=s.text_color??"#fff",n={display:"inline-flex",alignItems:"center",float:"left",height:e.svg.height,padding:e.textWithoutIcon.padding,color:t,fontSize:e.text.fontSize,fontWeight:"normal",textWrap:"nowrap"};return li(n)}const $e=s=>Math.round(s*1e3)/1e3;function Ih(s,e){const t=e.offset??{x:0,y:0},n=e.position??"right";let i="auto";const r="auto",o="auto";let a="auto";const l="fixed",c=s?.dom.getBoundingClientRect()??DOMRect.fromRect({x:0,y:0,width:0,height:0}),u={top:c.top,bottom:c.bottom,left:c.left,right:c.right,width:c.width,height:c.height};switch(s?.dom.ownerDocument===document||s?.iframes.filter(Xe).forEach(T=>{const k=T.getBoundingClientRect();u.top+=k.top,u.bottom+=k.top,u.left+=k.left,u.right+=k.left}),n){case"top":a=`${$e(u.left+u.width/2)+t.x}px`,i=`${$e(u.top-tt)+t.y}px`;break;case"right":a=`${$e(u.left+u.width+tt)+t.x}px`,i=`${$e(u.top+u.height/2)+t.y}px`;break;case"bottom":a=`${$e(u.left+u.width/2)+t.x}px`,i=`${$e(u.top+u.height+tt)+t.y}px`;break;case"left":a=`${$e(u.left-tt)+t.x}px`,i=`${$e(u.top+u.height/2)+t.y}px`;break}return{top:i,right:r,bottom:o,left:a,position:l}}async function Rh(s,e){const t=e.offset??{x:0,y:0},n=e.position??"right";let i="auto";const r="auto",o="auto";let a="auto";const l="fixed",c=await s?.getRect();if(c==null)throw new Error("Target boxing is null");switch(n){case"top":a=`${$e(c.left+c.width/2)+t.x}px`,i=`${$e(c.top-tt)+t.y}px`;break;case"right":a=`${$e(c.left+c.width+tt)+t.x}px`,i=`${$e(c.top+c.height/2)+t.y}px`;break;case"bottom":a=`${$e(c.left+c.width/2)+t.x}px`,i=`${$e(c.top+c.height+tt)+t.y}px`;break;case"left":a=`${$e(c.left-tt)+t.x}px`,i=`${$e(c.top+c.height/2)+t.y}px`;break}return{top:i,right:r,bottom:o,left:a,position:l}}function Ah(s,e){let t=null;return{debouncedFn:()=>{t!==null&&window.clearTimeout(t),t=window.setTimeout(()=>{t=null,s()},e)},clear:()=>{t!==null&&(window.clearTimeout(t),t=null)}}}function Oh(s,e){const t=s.onDisappear(()=>{e(!1)},!1),n=s.onAppear(()=>{e(!0)},!1);return()=>{t(),n()}}function Lh(s,e){const t=s.dom.parentElement??s.dom,n=new MutationObserver(e);return n.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),n}class hr{constructor(e){this.cleanups=[],this.onClick=(t,n)=>{this.element.addEventListener("click",t,{once:n});const i=()=>this.element.removeEventListener("click",t);return n||this.cleanups.push(i),i},this.onMouseEnter=(t,n)=>{this.element.addEventListener("mouseenter",t,{once:n});const i=()=>this.element.removeEventListener("mouseenter",t);return n||this.cleanups.push(i),i},this.onMouseLeave=(t,n)=>{this.element.addEventListener("mouseleave",t,{once:n});const i=()=>this.element.removeEventListener("mouseleave",t);return n||this.cleanups.push(i),i},this.element=e}onKeydown(e,t){this.element.addEventListener("keydown",e,{once:t});const n=()=>this.element.removeEventListener("keydown",e);return t||this.cleanups.push(n),n}cleanup(){this.cleanups.forEach(e=>e()),this.cleanups=[]}}const ia=(s,e=[])=>s===null?e:(e.push(s),s.parentElement!=null?ia(s.parentElement,e):e);class Mh{constructor(){this._listeners=[]}setupScrollListeners(e,t){const n=ia(e.dom),i=()=>{t()};this.addScrollListener(window,()=>{this.removeScrollListener(e.dom.ownerDocument,i),t()}),this.addScrollListener(e.dom.ownerDocument,i),n.forEach(r=>{this.addScrollListener(r,i)})}addScrollListener(e,t){e.addEventListener("scroll",t,{passive:!0}),this._listeners.push({element:e,callback:t})}removeScrollListener(e,t){e.removeEventListener("scroll",t),this._listeners=this._listeners.filter(n=>n.element!==e)}cleanup(){this._listeners.splice(0).forEach(({element:e,callback:t})=>{e&&e.removeEventListener("scroll",t)})}}const ci=[];let ra=(Qt=class{constructor(e,t,n=null,i=null){this.target=null,this.element=null,this.mutationObserver=null,this.identifier=null,this._isVisible=!0,this._eventManager=null,this.container=e,this.target=t,this.options={...Qt.defaultOptions,...n??{}},this._scrollManager=new Mh,this._boundOnWindowResize=this.onWindowResize.bind(this),this._boundSetBeaconPosition=this.setBeaconPosition.bind(this);const r=Ah(this._boundSetBeaconPosition,16);this._debouncedSetBeaconPosition=r.debouncedFn,this._clearDebouncedPosition=r.clear;const o=document.createElement("div");o.classList.add(Qt.getCssClassName()),Qo(o,{icon:n?.icon,label:this.options.label}),this.element=o,this._eventManager=new hr(o),i===null?this.identifier=qo():this.identifier=i;const a=ci.findIndex(l=>l.identifier===this.identifier);a>-1&&(ci[a].unmount(),ci.splice(a,1)),ci.push(this)}static getCssClassName(){return"d41b89d10619cdd3e30fb6c401c17c7d9"}render(){this.container.contains(this.element)||(this.container.appendChild(this.element),this.applyStyles(),this.setupObservers(),this.setupResize(),this.setupScroll()),this.setBeaconPosition()}unmount(){this.target!==null&&this.target.destroy(),this.element!=null&&ur(this.element),window.removeEventListener("resize",this._boundOnWindowResize),this._clearDebouncedPosition(),this._scrollManager.cleanup(),this.mutationObserver?.disconnect(),this._unlistenVisibility&&this._unlistenVisibility(),this._unlistenMove?.()}getPosition(){return Ih(this.target,this.options)}onWindowResize(){this.element!==null&&this.setBeaconPosition()}setupResize(){window.addEventListener("resize",this._boundOnWindowResize)}setupObservers(){this.target!=null&&(this._unlistenVisibility=Oh(this.target,e=>{this._isVisible=e,e?(this.element?.style.setProperty("visibility","visible"),this.setBeaconPosition()):this.element?.style.setProperty("visibility","hidden")}),this.mutationObserver=Lh(this.target,this._debouncedSetBeaconPosition),this._unlistenMove=this.target.onMove(()=>{this._debouncedSetBeaconPosition()}))}setupScroll(){this.target!=null&&this._scrollManager.setupScrollListeners(this.target,this._boundSetBeaconPosition)}applyStyles(){if(this.element!=null){this.element.setAttribute("style",ea(this.options));const e=this.element.children.length;for(let t=0;t<e;t++){const n=this.element.children[t],i=n.classList.contains(Hn.textWithIcon),r=n.classList.contains(Hn.textWithoutIcon);i?n.setAttribute("style",na(this.options)):r?n.setAttribute("style",sa(this.options)):n.setAttribute("style",ta(this.options))}this.setBeaconPosition()}}setBeaconPosition(){if(!this._isVisible)return;if(gh(this.identifier)){vh(this.identifier,this.target);return}const e=this.getPosition();Object.keys(e).some(t=>this.element?.style[t]!==e[t])&&(Object.keys(e).forEach(t=>{this.element?.style.setProperty(t,e[t])}),yh(this.identifier))}onClick(e,t){return this._eventManager?.onClick(e,t)??(()=>{})}onMouseEnter(e,t){return this._eventManager?.onMouseEnter(e,t)??(()=>{})}onMouseLeave(e,t){return this._eventManager?.onMouseLeave(e,t)??(()=>{})}},Qt.defaultOptions=Ys,Qt);class Nh extends ra{get shift(){return{vertical:0,horizontal:0}}constructor(e,t="bottom-left",n=null){super(e,null,n,null),this.position=t}getPosition(){let e="auto",t="auto",n="auto",i="auto";const r="fixed",o=`${Go}px`;switch(this.position){case"top-left":e=o,i=o;break;case"top-right":e=o,t=o;break;case"bottom-right":n=o,t=o;break;case"bottom-left":n=o,i=o;break}return{top:e,right:t,bottom:n,left:i,position:r}}}const As=class As{constructor(e,t,n=null,i=null){this.target=null,this.element=null,this.mutationObserver=null,this.intersectionObserver=null,this.identifier=null,this._isVisible=!0,this._eventManager=null,this.container=e,this.target=t,this.options={...As.defaultOptions,...n};const r=document.createElement("div");r.classList.add(As.getCssClassName()),Qo(r,{icon:n?.icon,label:this.options.label}),this.element=r,this._eventManager=new hr(r),i===null?this.identifier=qo():this.identifier=i,this.unlistenMove=this.target?.onMove(()=>{this.setBeaconPosition()}),this.unlistenDisappear=this.target?.onDisappear(()=>{this._isVisible=!1,this.hide()},!1),this.unlistenRemove=this.target?.onRemove(()=>{this.unmount()}),this.unlistenAppear=this.target?.onAppear(()=>{this._isVisible=!0,this.show()},!1)}static getCssClassName(){return"d41b89d10619cdd3e30fb6c401c17c7d9"}show(){this.setBeaconPosition(),this.element?.style.setProperty("display","inline-flex","important")}hide(){this.element?.style.setProperty("display","none","important")}render(){this.container.contains(this.element)||(this.container.appendChild(this.element),this.applyStyles()),this.setBeaconPosition()}unmount(){this.target!=null&&this.target.destroy(),this.element?.remove!=null&&this.element.remove(),this.unlistenMove&&this.unlistenMove(),this.unlistenDisappear&&this.unlistenDisappear(),this.unlistenAppear&&this.unlistenAppear(),this.unlistenRemove&&this.unlistenRemove()}async getPosition(){return Rh(this.target,this.options)}applyStyles(){if(this.element!=null){this.element.setAttribute("style",ea(this.options));const e=this.element.children.length;for(let t=0;t<e;t++){const n=this.element.children[t],i=n.classList.contains(Hn.textWithIcon),r=n.classList.contains(Hn.textWithoutIcon);i?n.setAttribute("style",na(this.options)):r?n.setAttribute("style",sa(this.options)):n.setAttribute("style",ta(this.options))}this.setBeaconPosition()}}async setBeaconPosition(){if(!this._isVisible)return;const e=await this.getPosition();Object.keys(e).forEach(t=>{this.element?.style.setProperty(t,e[t])})}onClick(e,t){return this._eventManager?.onClick(e,t)??(()=>{})}onMouseEnter(e,t){return this._eventManager?.onMouseEnter(e,t)??(()=>{})}onMouseLeave(e,t){return this._eventManager?.onMouseLeave(e,t)??(()=>{})}};As.defaultOptions=Ys;let dr=As;function oa(s){if(s.target instanceof Ts)return new xo(s.target,s.options);if(!s.container)throw new Error("container is required");if(s.target==null)return new Nh(s.container,s.position,s.options);if(s.target instanceof wt)return new ra(s.container,s.target,s.options,s.id);if(s.target instanceof hi)return new dr(s.container,s.target,s.options);throw new Error("Invalid target type")}const qt={beacon:"_beacon_17wtz_1",textWithIcon:"_textWithIcon_17wtz_25",textWithoutIcon:"_textWithoutIcon_17wtz_25",verySmall:"_verySmall_17wtz_51",small:"_small_17wtz_59",medium:"_medium_17wtz_67",large:"_large_17wtz_75"},kh=(s,e)=>s.x!==e.x||s.y!==e.y||s.width!==e.width||s.height!==e.height;function Ph(s,e,t){let i=e,r=0;for(;i.parentElement&&r<4;){const o=i.getBoundingClientRect();i.parentElement.insertBefore(s,i.nextSibling);const a=i.getBoundingClientRect();if(!kh(o,a))return;s.remove(),i=i.parentElement,r+=1}t.appendChild(s)}class fr{constructor(e){this.options=e}static getCssClassName(){return qt.beacon}getSizeClassName(){const e={very_small:qt.verySmall,small:qt.small,medium:qt.medium,large:qt.large};return this.options.size!==void 0?e[this.options.size]:qt.medium}createElement(){const e=document.createElement("div");e.classList.add(fr.getCssClassName(),this.getSizeClassName()),e.setAttribute("data-testid","lemon-beacon"),this.applyAriaAttributes(e);const t=Yo(this.options.icon);return this.options.label&&this.options.label.length>0?this.options.icon!=="empty"?this.renderLabelWithIcon(e,t,this.options.label):this.renderLabelOnly(e,this.options.label):this.renderIconOnly(e,t),e}applyAriaAttributes(e){e.setAttribute("role","button"),e.setAttribute("tabindex","0"),this.options.label?e.setAttribute("aria-label",this.options.label):e.setAttribute("aria-label","Information beacon")}renderIconOnly(e,t){t!==null&&(e.innerHTML+=t)}renderLabelWithIcon(e,t,n){t!==null&&(e.innerHTML+=t);const i=document.createElement("span");i.innerText=n,i.classList.add(qt.textWithIcon),e.appendChild(i)}renderLabelOnly(e,t){const n=document.createElement("span");n.innerText=t,n.classList.add(qt.textWithoutIcon),e.appendChild(n)}insertInDOM(e,t){const n=Zt(t?.ownerDocument),i=t?.getRootNode();if(!n.contains(e)){if(!t?.parentElement||i instanceof ShadowRoot){n.appendChild(e);return}Ph(e,t,n)}}applyStyles(e){const t=this.options.size!==void 0?fh[this.options.size]:26,n=t/2,i=this.options.label!=null?"auto":`${t}px`;this.options.z_index!=null&&e.style.setProperty("--beacon-z-index",this.options.z_index.toString()),e.style.setProperty("--beacon-height",`${t}px`),e.style.setProperty("--beacon-border-radius",`${n}px`),e.style.setProperty("--beacon-min-width",i),this.options.text_color!==void 0&&e.style.setProperty("--beacon-text-color",this.options.text_color),this.options.color!==void 0&&e.style.setProperty("--beacon-bg-color",this.options.color)}}class Dh{constructor(e,t){this.autoUpdateCleanup=null,this.options={...Ys,...t},this.targetElement=e,this.renderer=new fr(this.options),this.element=this.renderer.createElement(),this.eventManager=new hr(this.element),this.render(),this.setupKeyboardNavigation()}get offset(){return this.options.offset??{x:0,y:0}}getOffsetByPlacement(e){switch(e){case"top":return{mainAxis:tt-this.offset.y,crossAxis:this.offset.x};case"bottom":return{mainAxis:tt+this.offset.y,crossAxis:this.offset.x};case"left":return{mainAxis:tt-this.offset.x,crossAxis:this.offset.y};default:return{mainAxis:tt+this.offset.x,crossAxis:this.offset.y}}}setupKeyboardNavigation(){this.eventManager.onKeydown(e=>{(e?.key==="Enter"||e?.key===" ")&&(e.preventDefault(),this.element.click())})}render(){this.renderer.insertInDOM(this.element,this.targetElement),this.renderer.applyStyles(this.element),this.targetElement?(this.updateFloatingPosition(),this.autoUpdateCleanup=Uo(this.targetElement,this.element,()=>{this.updateFloatingPosition()})):this.applyFixedPosition()}getFloatingPlacement(e){switch(e){case"top":return"top";case"bottom":return"bottom";case"left":return"left";default:return"right"}}updateFloatingPosition(){if(!this.targetElement)return;const e=this.options.position;lh(this.targetElement,this.element,{placement:this.getFloatingPlacement(e),middleware:[oh(({placement:t})=>this.getOffsetByPlacement(t)),ah()]}).then(({x:t,y:n,middlewareData:i})=>{const{referenceHidden:r}=i.hide??{};this.element.style.setProperty("position","absolute","important"),this.element.style.setProperty("left",`${t}px`,"important"),this.element.style.setProperty("top",`${n}px`,"important"),this.element.style.setProperty("visibility",r===!0?"hidden":"visible","important"),this.element.style.setProperty("display",r===!0?"none":"inline-flex","important")})}applyFixedPosition(){this.element.style.setProperty("position","fixed","important");const{position:e}=this.options,t=`${Go}px`;switch(e){case"top-left":this.element.style.setProperty("top",t,"important"),this.element.style.setProperty("left",t,"important");break;case"top-right":this.element.style.setProperty("top",t,"important"),this.element.style.setProperty("right",t,"important");break;case"bottom-right":this.element.style.setProperty("bottom",t,"important"),this.element.style.setProperty("right",t,"important");break;case"bottom-left":default:this.element.style.setProperty("bottom",t,"important"),this.element.style.setProperty("left",t,"important");break}(this.offset.x!==0||this.offset.y!==0)&&(this.element.style.setProperty("margin-left",`${this.offset.x}px`,"important"),this.element.style.setProperty("margin-top",`${this.offset.y}px`,"important"))}unmount(){this.autoUpdateCleanup?.(),this.autoUpdateCleanup=null,this.eventManager.cleanup(),ur(this.element)}onClick(e,t){return this.eventManager.onClick(e,t)}onMouseEnter(e,t){return this.eventManager.onMouseEnter(e,t)}onMouseLeave(e,t){return this.eventManager.onMouseLeave(e,t)}}function aa(s,e){return new Dh(s,e)}class la{constructor(e){this.onClick=t=>{this.beacon.onClick(t)},this.onMouseEnter=t=>{this.beacon.onMouseEnter(t)},this.onMouseLeave=t=>{this.beacon.onMouseLeave(t)},this.destroy=()=>{this.beacon.unmount()},this.getTarget=()=>{const{element:t}=this.beacon;return t instanceof Element?t:null},this.beacon=e}}class wt{constructor(e,t=[]){this.cleanupFunctions=[],this.highlight=null,this._element=e,this.iframes=t}get dom(){return this._element}async getAttributes(){const e=["id","class"];return Array.from(this._element.attributes).slice(0,7).reduce((t,n)=>e.indexOf(n.name.toLowerCase())>0||n.value.length>500?t:{...t,[n.name]:n.value},{})}async getTagName(){return this._element.tagName.toLowerCase()}async getText(){return new Promise(e=>{this._element instanceof HTMLInputElement?e(this._element.value):this._element instanceof HTMLElement?e(this._element.innerText):e("")})}async getRect(){const e=this._element.getBoundingClientRect(),t={x:e.x,y:e.y};return this.iframes.forEach(n=>{const i=n.getBoundingClientRect(),r=window.getComputedStyle(n);t.y+=i.top+(parseInt(r.borderTopWidth)||0)+(parseInt(r.paddingTop)||0),t.x+=i.left+(parseInt(r.borderLeftWidth)||0)+(parseInt(r.paddingLeft)||0)}),new DOMRect(t.x,t.y,e.width,e.height)}remove(){ur(this._element)}async isInViewport(){return new Promise(e=>{e(dn(this._element))})}async safeIsInViewport(){return this.isInViewport()}async isRendered(){return new Promise(e=>{e(ut(this._element))})}async safeIsRendered(){return this.isRendered()}onClick(e,t=!0){this._element.addEventListener("click",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("click",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onMousedown(e,t=!0){this._element.addEventListener("mousedown",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("mousedown",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onHover(e,t=!0){this._element.addEventListener("mouseenter",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("mouseenter",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onMouseLeave(e,t=!0){this._element.addEventListener("mouseleave",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("mouseleave",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onFocus(e,t=!0){this._element.addEventListener("focus",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("focus",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onBlur(e,t=!0){this._element.addEventListener("blur",e,{once:t,capture:!0});const n=()=>{this._element.removeEventListener("blur",e,{capture:!0})};return this.cleanupFunctions.push(n),n}onChange(e,t=!0){let n=null;const i=u=>{e(u),t&&r()},r=()=>{this._element.removeEventListener("change",i,{capture:!0}),n!==null&&clearInterval(n)};this._element.addEventListener("change",i,{once:t,capture:!0});let o=l(this._element),a=c(this._element);return n=setInterval(()=>{const u=l(this._element),f=c(this._element);(o!==u||a!==f)&&(o=u,a=f,i())},150),this.cleanupFunctions.push(r),r;function l(u){return"value"in u&&typeof u.value=="string"?u.value:""}function c(u){return u instanceof HTMLElement?u.innerText:""}}onAppear(e,t=!0,n=150){let i=!1,r=ut(this._element);r&&(e(),i=!0);const o=async()=>{const c=r;r=await this.isRendered(),c!==r&&r&&(!t||t&&!i)&&(e(),i=!0)},a=setInterval(()=>{o()},n),l=()=>{clearInterval(a)};return this.cleanupFunctions.push(l),l}onDisappear(e,t=!0,n=150){let i=!1,r=ut(this._element);r||(e(),i=!0);const o=async()=>{const c=r;r=await this.isRendered(),c!==r&&(r||(!t||t&&!i)&&(e(),i=!0))},a=setInterval(()=>{o()},n),l=()=>{clearInterval(a)};return this.cleanupFunctions.push(l),l}onInput(e,t=!0){function n(r){r.target!==null&&"value"in r.target&&typeof r.target.value=="string"?e(r.target?.value):e(null)}this._element.addEventListener("keyup",n,{once:t,capture:!0});const i=()=>{this._element.removeEventListener("keyup",n,{capture:!0})};return this.cleanupFunctions.push(i),i}async focus(){this.dom.scrollIntoView({behavior:"smooth",block:"center"})}onMove(e){let t=null;const n=async()=>{const a=await this.getRect();t!=null&&t.x===a.x&&t.y===a.y&&t.width===a.width&&t.height===a.height||(t=a,e({rect:a}))};n();const r=setInterval(()=>{n()},125),o=()=>{clearInterval(r)};return this.cleanupFunctions.push(o),o}onRemove(e){const t=new MutationObserver(i=>{i.forEach(r=>{if(r.removedNodes.length>0){const o=Array.from(r.removedNodes);(o.includes(this._element)||o.some(a=>a.contains(this._element)))&&(e(),t.disconnect())}})});t.observe(document.body,{childList:!0,subtree:!0});const n=()=>{t.disconnect()};return this.cleanupFunctions.push(n),n}destroy(){this.cleanupFunctions.forEach(e=>{e()}),this.cleanupFunctions=[],this.detachHighlight()}attachHighlight(e){this.detachHighlight(),this.highlight=new cr({color:e.color,type:e.type,selector:e.selector},this._element.ownerDocument),this.highlight.attachToElement(this._element)}detachHighlight(){this.highlight?.hide(),this.highlight=null}async attachBeacon(e,t="v1",n=Zt()){if(t==="v2"){const i=aa(this._element,e);return new la(i)}else{const i=oa({container:n,target:this,options:e});return i.render(),new la(i)}}}const ce={STOP:"OBSERVER_STOP",FOCUS:"OBSERVER_FOCUS",RECT:"OBSERVER_RECT",TEXT:"OBSERVER_TEXT",ATTRIBUTES:"OBSERVER_ATTRIBUTES",TAG_NAME:"OBSERVER_TAG_NAME",OBSERVE:"OBSERVER_OBSERVE",IN_VIEWPORT:"OBSERVER_IN_VIEWPORT",RENDERED:"OBSERVER_RENDERED",SHOW_HIGHLIGHT:"OBSERVER_SHOW_HIGHLIGHT",HIDE_HIGHLIGHT:"OBSERVER_HIDE_HIGHLIGHT",ATTACH_BEACON:"OBSERVER_ATTACH_BEACON"},X={OBSERVE_ACK:"OBSERVABLE_OBSERVE_ACK",HOVER:"OBSERVABLE_HOVER",CLICK:"OBSERVABLE_CLICK",RECT:"OBSERVABLE_RECT",TEXT:"OBSERVABLE_TEXT",FOCUS:"OBSERVABLE_FOCUS",BLUR:"OBSERVABLE_BLUR",MOUSE_ENTER:"OBSERVABLE_MOUSE_ENTER",MOUSE_LEAVE:"OBSERVABLE_MOUSE_LEAVE",INPUT:"OBSERVABLE_INPUT",REMOVED:"OBSERVABLE_REMOVED",ATTRIBUTES:"OBSERVABLE_ATTRIBUTES",TAG_NAME:"OBSERVABLE_TAG_NAME",CHANGE:"OBSERVABLE_CHANGE",MOUSE_DOWN:"OBSERVABLE_MOUSE_DOWN",IN_VIEWPORT:"OBSERVABLE_IN_VIEWPORT",RENDERED:"OBSERVABLE_RENDERED",BEACON_ATTACHED:"OBSERVABLE_BEACON_ATTACHED"},Kt={SCROLL:"BRIDGE_SCROLL",AI_REQUEST:"BRIDGE_AI_REQUEST"};function pr(s){const e=[...Array.from(s.querySelectorAll("iframe")),...Array.from(s.querySelectorAll("frame"))];return s.childNodes.forEach(t=>{t instanceof HTMLElement&&t.shadowRoot!==null&&e.push(...pr(t.shadowRoot))}),e}class $h{constructor(e,t,n){this.observerPort=e,this.observablePort=t,this.observableMessageModifier=n,this.observableHasReplied=!1,this.removeListenersFns=[],this.setupDownwardPropagation(),this.setupUpwardPropagation()}setupDownwardPropagation(){const e=this.observerPort.addMessageListener(async t=>{this.observablePort.postMessage(t)});this.removeListenersFns.push(e)}setupUpwardPropagation(){this.observablePort.start();const e=this.observablePort.addMessageListener(async t=>{this.observableHasReplied=!0,this.observerPort.postMessage(this.observableMessageModifier(t))});this.removeListenersFns.push(e)}hasEstablishedConnection(){return this.observableHasReplied}removeListeners(){this.removeListenersFns.forEach(e=>{e()})}}class Rt{constructor(){this.initMessagePropagationChannel(),this.initUpwardMessageRelay(),window.addEventListener("scroll",()=>{Rt.broadcastToChildFrames({type:Kt.SCROLL})})}initMessagePropagationChannel(){we.addMessageListener(async(e,t)=>{if(!ca(e))return;const n=e;if(n.type===Kt.AI_REQUEST)return;if(t==null){const r=pr(document.body);for(const o of r)we.sendToChildFrame(o,n);return}t.start();const i=pr(document.body);for(const r of i){const o=we.createChannel(),a=o.getPort1(),l=new $h(t,a,c=>Fh(c,r));we.sendToChildFrame(r,n,o.getPort2()),setTimeout(()=>{l.hasEstablishedConnection()||(l.removeListeners(),a.close())},2e3)}})}initUpwardMessageRelay(){window.parent!==window&&we.addMessageListener(async(e,t)=>{const n=e;n.type===Kt.AI_REQUEST&&we.sendToParentFrame(n,t)})}static broadcastToChildFrames(e,t){we.sendToCurrentFrame(e,t)}static addMessageListener(e,t){we.addMessageListener(async(n,i)=>{ca(n)&&e(n,i)},t)}}function Bh(s){const e=s.getBoundingClientRect(),t=window.getComputedStyle(s),n={top:0,right:0,bottom:0,left:0};return n.top+=e.top+(t.borderTopWidth!=null?ui(t.borderTopWidth):0)+(t.paddingTop!=null?ui(t.paddingTop):0),n.right+=e.left,n.bottom+=e.top,n.left+=e.left+(t.borderLeftWidth!=null?ui(t.borderLeftWidth):0)+(t.paddingLeft!=null?ui(t.paddingLeft):0),n}function ui(s){return s==null||s===""?0:parseInt(s.replace("px","").trim(),10)}function ca(s){return[ce.OBSERVE,ce.RECT,ce.FOCUS,ce.ATTRIBUTES,ce.TAG_NAME,ce.TEXT,ce.IN_VIEWPORT,ce.RENDERED,ce.STOP,Kt.SCROLL,Kt.AI_REQUEST,ce.SHOW_HIGHLIGHT,ce.HIDE_HIGHLIGHT,ce.ATTACH_BEACON].includes(s.type)}function Fh(s,e){if(s.type==null)return s;switch(s.type){case X.RECT:if(e!=null){const t=Bh(e),n={...s.payload,rect:{...s.payload.rect,top:s.payload.rect.top+t.top,right:s.payload.rect.right+t.right,bottom:s.payload.rect.bottom+t.bottom,left:s.payload.rect.left+t.left,width:s.payload.rect.width,height:s.payload.rect.height}};return{...s,payload:n}}return s;default:return s}}class zh{constructor(e){this.onClick=t=>{this.beacon.onClick(t)},this.onMouseEnter=t=>{this.beacon.onMouseEnter(t)},this.onMouseLeave=t=>{this.beacon.onMouseLeave(t)},this.destroy=()=>{this.beacon.unmount()},this.getTarget=()=>{const{element:t}=this.beacon;return t instanceof Element?t:null},this.beacon=e}}class Vh{constructor(e){this.onClick=t=>{this.beaconObserver.onClick(t,!1)},this.onMouseEnter=t=>{this.beaconObserver.onMouseEnter(t)},this.onMouseLeave=t=>{this.beaconObserver.onMouseLeave(t)},this.destroy=()=>{this.beaconObserver.destroy()},this.getTarget=()=>this.beaconObserver,this.beaconObserver=e}}class hi{constructor(e){this.abortController=null,this.listeners=new Map,this.rect=null,this.onMoveCallbacks=new Set,this.onAppearCallbacks=new Set,this.onDisappearCallbacks=new Set,this.isObserving=!1,this.observationChannel=null,this._isInViewport=null,this.id=e,this.start()}async start(){this.isObserving=!0,this.abortController=new AbortController,this.abortController.signal.addEventListener("abort",()=>{this.listeners.forEach(n=>{n.forEach(i=>{i.cleanup()})}),this.listeners.clear()});const e=this.onMessage.bind(this);we.addMessageListener(async n=>{e(n)},this.abortController.signal),this.observationChannel=we.createChannel(),this.observationChannel.getPort1().addMessageListener(async n=>{e(n)},this.abortController.signal),this.observationChannel.getPort1().start(),Rt.broadcastToChildFrames({observableId:this.id,type:ce.OBSERVE},this.observationChannel.getPort2());const t=n=>{const i=new DOMRect(n.rect.left,n.rect.top,n.rect.width,n.rect.height);(this.rect==null||!Wh(this.rect,i))&&(this.onMoveCallbacks.forEach(r=>{r({rect:i})}),this.rect=i)};this.addListener(X.RECT,t),this.addListener(X.IN_VIEWPORT,n=>{this._isInViewport=n.inViewport,n.inViewport?this.onAppearCallbacks.forEach(i=>{i()}):this.onDisappearCallbacks.forEach(i=>{i()})}),this.addListener(X.REMOVED,()=>{this.stop()})}destroy(){this.stop()}stop(){this.isObserving&&(Rt.broadcastToChildFrames({observableId:this.id,type:ce.STOP}),this.abortController?.abort(),this.isObserving=!1)}onMessage(e){switch(e.type){case X.HOVER:case X.CLICK:case X.FOCUS:case X.BLUR:case X.MOUSE_ENTER:case X.MOUSE_LEAVE:case X.INPUT:case X.REMOVED:case X.ATTRIBUTES:case X.TAG_NAME:case X.CHANGE:case X.IN_VIEWPORT:case X.RENDERED:case X.RECT:return this.handleObservablEvent(e.type,e.payload)}return!1}handleObservablEvent(e,t){const n=this.listeners.get(e);return n&&[...n].forEach(i=>{i.callback(t),i.once&&this.removeListener(e,i)}),!0}async focus(){await this.requestFromObservable(ce.FOCUS)}async getRect(){const{payload:e}=await this.requestFromObservable(ce.RECT);return new DOMRect(e.rect.left,e.rect.top,e.rect.width,e.rect.height)}async getAttributes(){const{payload:e}=await this.requestFromObservable(ce.ATTRIBUTES);return e.attributes}async getTagName(){const{payload:e}=await this.requestFromObservable(ce.TAG_NAME);return e.tagName}onRemove(e){return this.addListener(X.REMOVED,e)}onHover(e,t=!0){return this.addListener(X.HOVER,e,t)}onClick(e,t=!0){return this.addListener(X.CLICK,e,t)}onFocus(e,t=!0){return this.addListener(X.FOCUS,e,t)}onBlur(e,t=!0){return this.addListener(X.BLUR,e,t)}onMouseEnter(e){return this.addListener(X.MOUSE_ENTER,e)}onMouseLeave(e,t=!1){return this.addListener(X.MOUSE_LEAVE,e,t)}onMousedown(e,t){return this.addListener(X.MOUSE_DOWN,e,t)}onChange(e,t){return this.addListener(X.CHANGE,e,t)}onInput(e,t=!0){const n=i=>{e(i?.value??null)};return this.addListener(X.INPUT,n,t)}onMove(e){return this.onMoveCallbacks.add(e),()=>{this.onMoveCallbacks.delete(e)}}onDisappear(e,t=!0){let n=!1;const i=()=>{(!n||!t)&&(n=!0,e())};this.onDisappearCallbacks.add(i),this._isInViewport===!1&&i();const r=()=>{this.onDisappearCallbacks.delete(i)};return this.abortController?.signal.addEventListener("abort",r),r}onAppear(e,t=!0){let n=!1;const i=()=>{(!n||!t)&&(n=!0,e())};this.onAppearCallbacks.add(i),this._isInViewport===!0&&i();const r=()=>{this.onAppearCallbacks.delete(i)};return this.abortController?.signal.addEventListener("abort",r),r}async getText(){const{payload:e}=await this.requestFromObservable(ce.TEXT);return e.text}async isInViewport(){const{payload:e}=await this.requestFromObservable(ce.IN_VIEWPORT);return e.inViewport}async safeIsInViewport(){try{return await this.isInViewport()}catch{return!1}}async isRendered(){const{payload:e}=await this.requestFromObservable(ce.RENDERED);return e.rendered}async safeIsRendered(){try{return await this.isRendered()}catch{return!1}}async requestFromObservable(e){const t={observableId:this.id,requestId:ze(),type:e};return new Promise((n,i)=>{const r=this.observationChannel?.getPort1().addMessageListener(async l=>{l.requestId===t.requestId&&(r?.(),clearTimeout(a),n(l))}),a=setTimeout(()=>{r?.(),i(new Error(`Sending message timed out: ${JSON.stringify(t)}`)),clearTimeout(a)},2e3);this.observationChannel?.getPort1().postMessage(t)})}addListener(e,t,n=!1){this.listeners.has(e)||this.listeners.set(e,new Set);const i=()=>{this.removeListener(e,r)},r={callback:t,once:n,cleanup:i};return this.listeners.get(e)?.add(r),i}removeListener(e,t){this.listeners.get(e)?.delete(t)}attachHighlight(e){const t={observableId:this.id,color:e.color,type:e.type,selector:e.selector};this.observationChannel?.getPort1().postMessage({type:ce.SHOW_HIGHLIGHT,payload:t})}detachHighlight(){this.observationChannel?.getPort1().postMessage({type:ce.HIDE_HIGHLIGHT,payload:{observableId:this.id}})}async attachBeacon(e,t="v1",n=Zt()){if(t==="v2"){const i=await this.attachBeaconInChildFrame(e),r=new hi(i);return new Vh(r)}else{const i=oa({container:n,target:this,options:e});return i.render(),new zh(i)}}async attachBeaconInChildFrame(e){const t={observableId:this.id,options:e};return new Promise((n,i)=>{const r=ze(),o=this.observationChannel?.getPort1().addMessageListener(async c=>{const u=c;u.type===X.BEACON_ATTACHED&&u.payload&&(o?.(),clearTimeout(l),n(u.payload.beaconId))}),l=setTimeout(()=>{o?.(),i(new Error("attachBeacon timed out"))},5e3);this.observationChannel?.getPort1().postMessage({type:ce.ATTACH_BEACON,payload:t,requestId:r})})}}function Wh(s,e){return s.x===e.x&&s.y===e.y&&s.width===e.width&&s.height===e.height}var di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ua(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var mr,ha;function Uh(){if(ha)return mr;ha=1;var s="Expected a function",e="__lodash_hash_undefined__",t="[object Function]",n="[object GeneratorFunction]",i=/[\\^$.*+?()[\]{}|]/g,r=/^\[object .+?Constructor\]$/,o=typeof di=="object"&&di&&di.Object===Object&&di,a=typeof self=="object"&&self&&self.Object===Object&&self,l=o||a||Function("return this")();function c(I,z){return I?.[z]}function u(I){var z=!1;if(I!=null&&typeof I.toString!="function")try{z=!!(I+"")}catch{}return z}var f=Array.prototype,E=Function.prototype,T=Object.prototype,k=l["__core-js_shared__"],y=(function(){var I=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""})(),v=E.toString,w=T.hasOwnProperty,_=T.toString,A=RegExp("^"+v.call(w).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=f.splice,B=Nt(l,"Map"),N=Nt(Object,"create");function Q(I){var z=-1,se=I?I.length:0;for(this.clear();++z<se;){var Te=I[z];this.set(Te[0],Te[1])}}function P(){this.__data__=N?N(null):{}}function pe(I){return this.has(I)&&delete this.__data__[I]}function F(I){var z=this.__data__;if(N){var se=z[I];return se===e?void 0:se}return w.call(z,I)?z[I]:void 0}function je(I){var z=this.__data__;return N?z[I]!==void 0:w.call(z,I)}function Re(I,z){var se=this.__data__;return se[I]=N&&z===void 0?e:z,this}Q.prototype.clear=P,Q.prototype.delete=pe,Q.prototype.get=F,Q.prototype.has=je,Q.prototype.set=Re;function ye(I){var z=-1,se=I?I.length:0;for(this.clear();++z<se;){var Te=I[z];this.set(Te[0],Te[1])}}function Et(){this.__data__=[]}function Qe(I){var z=this.__data__,se=Mt(z,I);if(se<0)return!1;var Te=z.length-1;return se==Te?z.pop():L.call(z,se,1),!0}function Me(I){var z=this.__data__,se=Mt(z,I);return se<0?void 0:z[se][1]}function Ot(I){return Mt(this.__data__,I)>-1}function bn(I,z){var se=this.__data__,Te=Mt(se,I);return Te<0?se.push([I,z]):se[Te][1]=z,this}ye.prototype.clear=Et,ye.prototype.delete=Qe,ye.prototype.get=Me,ye.prototype.has=Ot,ye.prototype.set=bn;function Oe(I){var z=-1,se=I?I.length:0;for(this.clear();++z<se;){var Te=I[z];this.set(Te[0],Te[1])}}function wn(){this.__data__={hash:new Q,map:new(B||ye),string:new Q}}function st(I){return en(this,I).delete(I)}function Lt(I){return en(this,I).get(I)}function ue(I){return en(this,I).has(I)}function Ze(I,z){return en(this,I).set(I,z),this}Oe.prototype.clear=wn,Oe.prototype.delete=st,Oe.prototype.get=Lt,Oe.prototype.has=ue,Oe.prototype.set=Ze;function Mt(I,z){for(var se=I.length;se--;)if(qn(I[se][0],z))return se;return-1}function En(I){if(!xn(I)||_n(I))return!1;var z=tn(I)||u(I)?A:r;return z.test(Ls(I))}function en(I,z){var se=I.__data__;return Os(z)?se[typeof z=="string"?"string":"hash"]:se.map}function Nt(I,z){var se=c(I,z);return En(se)?se:void 0}function Os(I){var z=typeof I;return z=="string"||z=="number"||z=="symbol"||z=="boolean"?I!=="__proto__":I===null}function _n(I){return!!y&&y in I}function Ls(I){if(I!=null){try{return v.call(I)}catch{}try{return I+""}catch{}}return""}function Tn(I,z){if(typeof I!="function"||z&&typeof z!="function")throw new TypeError(s);var se=function(){var Te=arguments,_t=z?z.apply(this,Te):Te[0],We=se.cache;if(We.has(_t))return We.get(_t);var ee=I.apply(this,Te);return se.cache=We.set(_t,ee),ee};return se.cache=new(Tn.Cache||Oe),se}Tn.Cache=Oe;function qn(I,z){return I===z||I!==I&&z!==z}function tn(I){var z=xn(I)?_.call(I):"";return z==t||z==n}function xn(I){var z=typeof I;return!!I&&(z=="object"||z=="function")}return mr=Tn,mr}var Hh=Uh();const da=ua(Hh);function fa(s){const e=s.split(",").filter(t=>t.length>0);return e.length>0?e.map(t=>Jh(t)):[]}const jh=/(\[[^\]]+\])/g,Zh=/(#[^#\s+>~.[:]+)/g,Gh=/(\.[^\s+>~.[:]+)/g,qh=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,Kh=/(:[\w-]+\([^)]*\))/gi,Xh=/(:[^\s+>~.[:]+)/g,Yh=/([^\s+>~.[:]+)/g,Jh=da(s=>({parts:[{regex:jh,type:"attribute"},{regex:Zh,type:"id"},{regex:Gh,type:"class"},{regex:qh,type:"pseudo"},{regex:Kh,type:"pseudo"},{regex:Xh,type:"pseudo"},{regex:Yh,type:"element"}].reduce((n,{regex:i,type:r})=>{const{selector:o,parts:a}=ed(n.selector,i,r);return{selector:o,parts:[...n.parts,...a]}},{selector:[nd,sd,id].reduce((n,i)=>i(n),s),parts:[]}).parts.sort((n,i)=>n.index-i.index),selector:s})),Qh=function(s,e){const t=s.match(e);return t!=null&&t?.length>0?t.reduce((n,i)=>n.replace(i,Array(i.length+1).join("A")),s):s},ed=function(s,e,t){const n=[];return td(s,t).match(e)?.reduce((r,o)=>(r.parts.push({selector:o,type:t,index:s.indexOf(o),length:o.length}),{selector:r.selector.replace(o,Array(o.length+1).join(" ")),parts:r.parts}),{selector:s,parts:n})??{selector:s,parts:n}};function td(s,e){switch(e){case"element":return[/[*\s+>~]/g,/[#.]/g].reduce((t,n)=>t.replace(n," "),s);default:return s}}function nd(s){return[/\\[0-9A-Fa-f]{6}\s?/g,/\\[0-9A-Fa-f]{1,5}\s/g,/\\./g].reduce(Qh,s)}function sd(s){const e=/:not\(([^)]*)\)/g;return e.test(s)?s.replace(e,"     $1 "):s}function id(s){const e=/{[^]*/gm;return s.match(e)?.reduce((n,i)=>n.replace(i,Array(i.length+1).join(" ")),s)??s}function rd(s){try{const[{parts:e}]=fa(s);return`//${e.reduce((n,i)=>{switch(i.type){case"element":n.push({tagName:i.selector,id:null,classList:[],texts:[]});break;case"id":n[n.length-1].id=i.selector.substr(1);break;case"class":n[n.length-1].classList.push(i.selector.substr(1));break;case"pseudo":const r=i.selector.match(/^:contains\("(.*)"\)$/);r!=null&&n[n.length-1].texts.push(r[1]);break}return n},[]).map(({tagName:n,id:i,classList:r,texts:o})=>gr(n,i,r,o)).join(" / ")}`}catch(e){return H.debug(e,"Error while converting CSS to XPath, returning empty string"),""}}function gr(s="div",e=null,t=[],n=[]){const i=[],r=[];e!=null&&i.push({name:"@id",check:"equals",value:e}),t.length>0&&t.forEach(c=>{i.push({name:"@class",check:"strictly_contains",value:c})}),n.length>0&&n.forEach(c=>{r.push({name:".",check:"contains",value:c})});const o=pa(i),a=pa(r,"or"),l=o+(a!==""?(o!==""?" and ":"")+"("+a+")":"");return`${s}${l?"["+l+"]":""}`}const pa=da((s,e="and")=>s.reduce((t,n)=>{const i=n.value.split('"')[0];switch(n.check){case"equals":t.push(`${n.name}="${i}"`);break;case"contains":t.push(`contains(${n.name}, "${i}")`);break;case"strictly_contains":const r=`(starts-with(${n.name}, "${i} "))`,o=`(substring(${n.name}, string-length(${n.name}) - string-length(" ${i}") +1) = " ${i}")`,a=`(contains(${n.name}, " ${i} "))`,l=`(${n.name}="${i}")`;t.push(`(${r} or ${o} or ${a} or ${l})`);break}return t},[]).join(` ${e} `).trim());class Ie{constructor(e,t=1){this.path=e,this._score=new zt(t)}get score(){return this._score.value}get xPath(){return rd(this.path)}static qualityOf(e,t){const[{parts:n}]=fa(e.path),i=new zt(0);return n.forEach(({type:r,selector:o})=>{const a=od(r);if(a!=null&&(i.increment(a,r.toUpperCase()),t!=null)){const l=new zt;t.forEach(c=>{l.increment(c.calc(o,r),c.constructor.name)}),i.multiplyWithScore(l,"Modifiers",{modifiersScore:l})}}),i}}function od(s){switch(s){case"id":return 10;case"class":return 6;case"element":return 4;case"pseudo":return 1;case"attribute":return 2;default:throw new Error(`Unknown type ${s}`)}}function ma(s){return s instanceof HTMLElement?s.innerText?.trim()??s.textContent?.trim():null}const ad=/^([A-Za-z])[A-Za-z\-_:.0-9]+$/;function fn(s){return s==null?!1:ad.test(s)}function pn(s){return s==null?!1:/^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$/.test(s)}function fi(s){let e=null;return typeof s=="string"?e=s:e=s?.id!=null&&s.id!==""?s.id:null,e==null?null:"#"+e.replace(/(:|\.|;|#)/g,"\\$1")}function ld(s,e=[]){let t="";typeof s=="string"?t=s:s instanceof Array?t=s.filter(i=>i.trim().length>0).join(" "):t=s.classList?s.classList.toString():s.className,t=t.trim().replace(/ {2,}/g,"");let n=t.split(" ").filter(i=>pn(i));return e.length>0&&(n=n.filter(i=>!e.includes(i))),n.length>0?"."+n.join(".").replace(/^\.{1,}/,"").replace(/\.{1,}$/,""):""}class mn{constructor(e,t=null,n=[],i=[],r=[]){this._elementType=e,this._id=t,this._classList=n,this._attributesList=i,this._texts=r}get elementType(){return this._elementType}get id(){return this._id}get classList(){return this._classList}get attributesList(){return this._attributesList}get texts(){return this._texts}toStringPaths(e=10){if(this._id==null&&this._classList.length===0&&this._attributesList.length===0&&this._texts.length===0)return[];const t=`${this._elementType}`,i=(fn(this._id)?[this._id]:[null]).concat(this._classList).concat(this._attributesList).map((a,l)=>l===0?{type:"id",value:a}:l>0&&l<=this._classList.length?{type:"class",value:a}:l>this._classList.length&&l<this._classList.length+this._attributesList.length+1?{type:"attribute",value:a}:{type:"text",value:a});let r=[];for(let a=0;a<Math.min(i.length,e);a++){let l=t;if(i[a].type==="id")if(fn(i[a].value)){const c=fi(i[a].value);l=c!=null?`${t}${c}`:l}else continue;else if(i[a].type==="class")if(pn(i[a].value))l=`${t}.${i[a].value}`;else continue;else i[a].type==="attribute"?l=`${t}${i[a].value}`:i[a].type==="text"&&(l=`${t}:contains("${i[a].value}")`);r=r.concat(this.pathsFor(l,i.slice(a+1,e)))}const o=i.slice(e);for(let a=0;a<o.length;a++)if(o[a].type==="id")if(fn(o[a].value)){const l=fi(o[a].value);l!=null&&r.push(`${t}${l}`)}else continue;else if(o[a].type==="class")if(pn(o[a].value))r.push(`${t}.${o[a].value}`);else continue;else o[a].type==="attribute"?r.push(`${t}${o[a].value}`):o[a].type==="text"&&r.push(`${t}:contains("${o[a].value}")`);return r.length===0?this._texts.map(a=>`${t}:contains("${a}")`):r.reduce((a,l)=>a.concat([l]).concat(this._texts.map(c=>`${l}:contains("${c}")`)),[])}toXPaths(e=10){if(this._id!==null&&this._classList.length===0&&this._attributesList.length===0&&this._texts.length===0)return[];const n=(fn(this._id)?[this._id]:[null]).concat(this._classList).concat(this._attributesList).map((o,a)=>a===0?{type:"id",value:o}:a>0&&a<=this._classList.length?{type:"class",value:o}:a>this._classList.length&&a<this._classList.length+this._attributesList.length+1?{type:"attribute",value:o}:{type:"text",value:o}).slice(0,e);let i=[];const r={tagName:this._elementType,id:null,classList:[]};for(let o=0;o<Math.min(n.length,e);o++){const a={...r};if(n[o].type==="id")if(pn(n[o].value))a.id=n[o].value;else continue;else if(n[o].type==="class"){const u=n[o].value;if(pn(u))a.classList=a.classList.concat([u]);else continue}const l=n.slice(o+1),c={tagName:r.tagName,id:l.length>0&&l[0].type==="id"?l[0].value:null,classList:l.filter(u=>u.type==="class"&&u.value!==null).map(u=>u.value)};i=i.concat(this.XPathsFor(a,c))}return i.reduce((o,{usedAttributes:a,path:l})=>(o.push(l),o.push(gr(a.tagName,a.id,a.classList,this._texts)),o),[])}pathsFor(e,t=[]){let n=[e];for(let i=0;i<t.length;i++){let r=e;if(t[i].type==="id")if(fn(t[i].value)){const o=fi(t[i].value);r=o!=null?`${e}${o}`:r}else continue;else if(t[i].type==="class")if(pn(t[i].value))r=`${e}.${t[i].value}`;else continue;else t[i].type==="attribute"?r=`${e}${t[i].value}`:t[i].type==="text"&&(r=`${e}:contains("${t[i].value}")`);n=n.concat(this.pathsFor(r,t.slice(i+1)))}return n}XPathsFor(e,t){let n=[{path:gr(e.tagName,e.id??"",e.classList),usedAttributes:e}];if(t.id)n=n.concat(this.XPathsFor({...e,id:t.id},{...t,id:null}));else if(t.classList.length>0)for(let i=0;i<t.classList.length;i++)n=n.concat(this.XPathsFor({...e,classList:e.classList.concat(t.classList.slice(i,i+1))},{...t,classList:t.classList.slice(i+1)}));return n}static forElement(e){const t=fn(e.id)?e.id:null,n=(()=>{const a=ma(e)?.split(`
`)[0].split("").reduce((l,c,u)=>l+=(e.textContent??"").trim()[u]??c,"")??"";if(a.length<=60&&a.trim().length>0)return a.trim().replace(/"/g,'\\"')})(),i=e.classList.toString().trim().replace("	"," ").replace(/ {2,}/g," "),r=i.length>0?i.split(" ").filter(a=>pn(a)):[],o=n!==void 0&&n!==""?[n]:[];return new mn(e.tagName.toLowerCase(),t,r,[],o)}}var pi=(s=>(s[s.NEXT_TO=0]="NEXT_TO",s[s.CONTAINS=1]="CONTAINS",s[s.PARENT_NEXT_TO=2]="PARENT_NEXT_TO",s[s.DYNAMIC=3]="DYNAMIC",s))(pi||{});const cd=1e5,Nr=class Nr{constructor(e,t=.3){this._bonus=.3,this._elements=e,this._bonus=t}get bonus(){return this._bonus}get elements(){return this._elements}scoreFor(e,t){const n=new zt(1);return this._elements.forEach(i=>{let r=null,o=0;switch(i.proximity){case 0:r=e.parentElement;break;case 1:r=e;break;case 2:r=e.parentElement,r?.parentElement!=null?r=r.parentElement:r=null;break;case 3:r=e;do r=r.parentElement,o++;while(o<i.level&&r!=null&&r!==document.documentElement);break}const a=r!=null?t(i.selector,r):null;a!=null&&a.length>0&&n.increment(this._bonus,"CONTEXT_ELEMENT",{elements:a})}),n}static blackList(e){this._blackList.push(e)}static clearBlackList(){this._blackList=[]}static around(e,t,n=cd){let i=[];const r=t.getOptions().contextWidth??3,o=e.parentElement;if(i=i.concat(this.siblings(e,r,0,t)),e.tagName.toLowerCase()!=="svg"&&(i=i.concat(this.childs(e,t))),o!=null&&(i=i.concat(this.siblings(o,r,2,t))),i.length===0){let l=e,c=0;do{const u=l.parentElement;if(c++,u!=null&&u.children.length>1){const f=this.siblings(l,r,3,t,{level:c});i=i.concat(f)}l=u}while(l!==null&&l!==document.documentElement&&i.length<5)}return i.length>n&&(i=i.sort((a,l)=>{const c=Ie.qualityOf(a.selector),u=Ie.qualityOf(l.selector);return c>u?-1:c===u?0:1}).splice(0,n)),i.filter((a,l)=>!i.slice(0,l).some(c=>c.selector.path===a.selector.path&&c.proximity===a.proximity))}static childs(e,t,n="",i=2){if(i<=0)return[];const r=e.children;let o=[];for(let a=0;a<r.length;a++){const l=n+" > "+t.stringSelectorsFor(r[a]).toString();o=o.concat([{selector:new Ie(l),proximity:1}]),o=o.concat(this.childs(r[a],t,l,i-1))}return o}static siblings(e,t=3,n,i,r={}){const o=e.parentElement;if(o==null)return[];const a=o.children;let l=[];for(let c=0;c<a.length;c++)if(e!==a[c]&&!this.isBlackListed(a[c])){const u=" > "+i.stringSelectorsFor(a[c]).toString();l=l.concat([{selector:new Ie(u),proximity:n,...r}]),l=l.concat(this.deepSiblingSelectors(a[c],u,t,n,i,r))}return l}static deepSiblingSelectors(e,t,n,i,r,o={}){if(n<=0)return[];const a=e.children;let l=[];for(let c=0;c<a.length;c++){const u=t+" > "+r.stringSelectorsFor(a[c]).toString();l=l.concat([{selector:new Ie(u),proximity:i,...o}]),l=l.concat(this.deepSiblingSelectors(a[c],u,n-1,i,r,o))}return l}static isBlackListed(e){for(let t=0;t<this._blackList.length;t++){const n=this._blackList[t];if(typeof n=="string"&&e.tagName.toLowerCase()===n)return!0;if(typeof n=="function"&&n(e))return!0;if(n===e)return!0}return!1}};Nr._blackList=[];let xs=Nr;var yr={exports:{}};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */var vr,ga;function ud(){if(ga)return vr;ga=1;const{entries:s,setPrototypeOf:e,isFrozen:t,getPrototypeOf:n,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:o,create:a}=Object,{apply:l,construct:c}=typeof Reflect<"u"&&Reflect;r||(r=function(j){return j}),o||(o=function(j){return j}),l||(l=function(j,le){for(var ie=arguments.length,ge=new Array(ie>2?ie-2:0),Ae=2;Ae<ie;Ae++)ge[Ae-2]=arguments[Ae];return j.apply(le,ge)}),c||(c=function(j){for(var le=arguments.length,ie=new Array(le>1?le-1:0),ge=1;ge<le;ge++)ie[ge-1]=arguments[ge];return new j(...ie)});const u=P(Array.prototype.forEach),f=P(Array.prototype.lastIndexOf),E=P(Array.prototype.pop),T=P(Array.prototype.push),k=P(Array.prototype.splice),y=P(String.prototype.toLowerCase),v=P(String.prototype.toString),w=P(String.prototype.match),_=P(String.prototype.replace),A=P(String.prototype.indexOf),L=P(String.prototype.trim),B=P(Object.prototype.hasOwnProperty),N=P(RegExp.prototype.test),Q=pe(TypeError);function P(ee){return function(j){j instanceof RegExp&&(j.lastIndex=0);for(var le=arguments.length,ie=new Array(le>1?le-1:0),ge=1;ge<le;ge++)ie[ge-1]=arguments[ge];return l(ee,j,ie)}}function pe(ee){return function(){for(var j=arguments.length,le=new Array(j),ie=0;ie<j;ie++)le[ie]=arguments[ie];return c(ee,le)}}function F(ee,j){let le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y;e&&e(ee,null);let ie=j.length;for(;ie--;){let ge=j[ie];if(typeof ge=="string"){const Ae=le(ge);Ae!==ge&&(t(j)||(j[ie]=Ae),ge=Ae)}ee[ge]=!0}return ee}function je(ee){for(let j=0;j<ee.length;j++)B(ee,j)||(ee[j]=null);return ee}function Re(ee){const j=a(null);for(const[le,ie]of s(ee))B(ee,le)&&(Array.isArray(ie)?j[le]=je(ie):ie&&typeof ie=="object"&&ie.constructor===Object?j[le]=Re(ie):j[le]=ie);return j}function ye(ee,j){for(;ee!==null;){const ie=i(ee,j);if(ie){if(ie.get)return P(ie.get);if(typeof ie.value=="function")return P(ie.value)}ee=n(ee)}function le(){return null}return le}const Et=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Qe=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Me=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ot=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),bn=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Oe=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),wn=r(["#text"]),st=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Lt=r(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ue=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ze=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Mt=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),En=o(/<%[\w\W]*|[\w\W]*%>/gm),en=o(/\$\{[\w\W]*/gm),Nt=o(/^data-[\-\w.\u00B7-\uFFFF]+$/),Os=o(/^aria-[\-\w]+$/),_n=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ls=o(/^(?:\w+script|data):/i),Tn=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),qn=o(/^html$/i),tn=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var xn=Object.freeze({__proto__:null,ARIA_ATTR:Os,ATTR_WHITESPACE:Tn,CUSTOM_ELEMENT:tn,DATA_ATTR:Nt,DOCTYPE_NAME:qn,ERB_EXPR:En,IS_ALLOWED_URI:_n,IS_SCRIPT_OR_DATA:Ls,MUSTACHE_EXPR:Mt,TMPLIT_EXPR:en});const I={element:1,text:3,progressingInstruction:7,comment:8,document:9},z=function(){return typeof window>"u"?null:window},se=function(j,le){if(typeof j!="object"||typeof j.createPolicy!="function")return null;let ie=null;const ge="data-tt-policy-suffix";le&&le.hasAttribute(ge)&&(ie=le.getAttribute(ge));const Ae="dompurify"+(ie?"#"+ie:"");try{return j.createPolicy(Ae,{createHTML(ft){return ft},createScriptURL(ft){return ft}})}catch{return console.warn("TrustedTypes policy "+Ae+" could not be created."),null}},Te=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function _t(){let ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z();const j=Y=>_t(Y);if(j.version="3.3.0",j.removed=[],!ee||!ee.document||ee.document.nodeType!==I.document||!ee.Element)return j.isSupported=!1,j;let{document:le}=ee;const ie=le,ge=ie.currentScript,{DocumentFragment:Ae,HTMLTemplateElement:ft,Node:he,Element:Sn,NodeFilter:Ne,NamedNodeMap:et=ee.NamedNodeMap||ee.MozNamedAttrMap,HTMLFormElement:Ms,DOMParser:Ci,trustedTypes:Kn}=ee,Cn=Sn.prototype,Ii=ye(Cn,"cloneNode"),kt=ye(Cn,"remove"),Ns=ye(Cn,"nextSibling"),Ri=ye(Cn,"childNodes"),Pt=ye(Cn,"parentNode");if(typeof ft=="function"){const Y=le.createElement("template");Y.content&&Y.content.ownerDocument&&(le=Y.content.ownerDocument)}let xe,Dt="";const{implementation:ks,createNodeIterator:Xn,createDocumentFragment:Ps,getElementsByTagName:Ds}=le,{importNode:kr}=ie;let ke=Te();j.isSupported=typeof s=="function"&&typeof Pt=="function"&&ks&&ks.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:h,ERB_EXPR:d,TMPLIT_EXPR:m,DATA_ATTR:x,ARIA_ATTR:b,IS_SCRIPT_OR_DATA:S,ATTR_WHITESPACE:C,CUSTOM_ELEMENT:M}=xn;let{IS_ALLOWED_URI:D}=xn,V=null;const K=F({},[...Et,...Qe,...Me,...bn,...wn]);let U=null;const oe=F({},[...st,...Lt,...ue,...Ze]);let te=Object.seal(a(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Ee=null;const _e=Object.seal(a(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Be=!0,me=!0,nn=!1,sn=!0,Se=!1,Ai=!0,In=!1,Pr=!1,Dr=!1,Yn=!1,Oi=!1,Li=!1,ol=!0,al=!1;const ep="user-content-";let $r=!0,$s=!1,Jn={},Qn=null;const ll=F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let cl=null;const ul=F({},["audio","video","img","source","image","track"]);let Br=null;const hl=F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Mi="http://www.w3.org/1998/Math/MathML",Ni="http://www.w3.org/2000/svg",$t="http://www.w3.org/1999/xhtml";let es=$t,Fr=!1,zr=null;const tp=F({},[Mi,Ni,$t],v);let ki=F({},["mi","mo","mn","ms","mtext"]),Pi=F({},["annotation-xml"]);const np=F({},["title","style","font","a","script"]);let Bs=null;const sp=["application/xhtml+xml","text/html"],ip="text/html";let Le=null,ts=null;const rp=le.createElement("form"),dl=function(g){return g instanceof RegExp||g instanceof Function},Vr=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ts&&ts===g)){if((!g||typeof g!="object")&&(g={}),g=Re(g),Bs=sp.indexOf(g.PARSER_MEDIA_TYPE)===-1?ip:g.PARSER_MEDIA_TYPE,Le=Bs==="application/xhtml+xml"?v:y,V=B(g,"ALLOWED_TAGS")?F({},g.ALLOWED_TAGS,Le):K,U=B(g,"ALLOWED_ATTR")?F({},g.ALLOWED_ATTR,Le):oe,zr=B(g,"ALLOWED_NAMESPACES")?F({},g.ALLOWED_NAMESPACES,v):tp,Br=B(g,"ADD_URI_SAFE_ATTR")?F(Re(hl),g.ADD_URI_SAFE_ATTR,Le):hl,cl=B(g,"ADD_DATA_URI_TAGS")?F(Re(ul),g.ADD_DATA_URI_TAGS,Le):ul,Qn=B(g,"FORBID_CONTENTS")?F({},g.FORBID_CONTENTS,Le):ll,q=B(g,"FORBID_TAGS")?F({},g.FORBID_TAGS,Le):Re({}),Ee=B(g,"FORBID_ATTR")?F({},g.FORBID_ATTR,Le):Re({}),Jn=B(g,"USE_PROFILES")?g.USE_PROFILES:!1,Be=g.ALLOW_ARIA_ATTR!==!1,me=g.ALLOW_DATA_ATTR!==!1,nn=g.ALLOW_UNKNOWN_PROTOCOLS||!1,sn=g.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Se=g.SAFE_FOR_TEMPLATES||!1,Ai=g.SAFE_FOR_XML!==!1,In=g.WHOLE_DOCUMENT||!1,Yn=g.RETURN_DOM||!1,Oi=g.RETURN_DOM_FRAGMENT||!1,Li=g.RETURN_TRUSTED_TYPE||!1,Dr=g.FORCE_BODY||!1,ol=g.SANITIZE_DOM!==!1,al=g.SANITIZE_NAMED_PROPS||!1,$r=g.KEEP_CONTENT!==!1,$s=g.IN_PLACE||!1,D=g.ALLOWED_URI_REGEXP||_n,es=g.NAMESPACE||$t,ki=g.MATHML_TEXT_INTEGRATION_POINTS||ki,Pi=g.HTML_INTEGRATION_POINTS||Pi,te=g.CUSTOM_ELEMENT_HANDLING||{},g.CUSTOM_ELEMENT_HANDLING&&dl(g.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(te.tagNameCheck=g.CUSTOM_ELEMENT_HANDLING.tagNameCheck),g.CUSTOM_ELEMENT_HANDLING&&dl(g.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(te.attributeNameCheck=g.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),g.CUSTOM_ELEMENT_HANDLING&&typeof g.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(te.allowCustomizedBuiltInElements=g.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Se&&(me=!1),Oi&&(Yn=!0),Jn&&(V=F({},wn),U=[],Jn.html===!0&&(F(V,Et),F(U,st)),Jn.svg===!0&&(F(V,Qe),F(U,Lt),F(U,Ze)),Jn.svgFilters===!0&&(F(V,Me),F(U,Lt),F(U,Ze)),Jn.mathMl===!0&&(F(V,bn),F(U,ue),F(U,Ze))),g.ADD_TAGS&&(typeof g.ADD_TAGS=="function"?_e.tagCheck=g.ADD_TAGS:(V===K&&(V=Re(V)),F(V,g.ADD_TAGS,Le))),g.ADD_ATTR&&(typeof g.ADD_ATTR=="function"?_e.attributeCheck=g.ADD_ATTR:(U===oe&&(U=Re(U)),F(U,g.ADD_ATTR,Le))),g.ADD_URI_SAFE_ATTR&&F(Br,g.ADD_URI_SAFE_ATTR,Le),g.FORBID_CONTENTS&&(Qn===ll&&(Qn=Re(Qn)),F(Qn,g.FORBID_CONTENTS,Le)),$r&&(V["#text"]=!0),In&&F(V,["html","head","body"]),V.table&&(F(V,["tbody"]),delete q.tbody),g.TRUSTED_TYPES_POLICY){if(typeof g.TRUSTED_TYPES_POLICY.createHTML!="function")throw Q('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof g.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Q('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');xe=g.TRUSTED_TYPES_POLICY,Dt=xe.createHTML("")}else xe===void 0&&(xe=se(Kn,ge)),xe!==null&&typeof Dt=="string"&&(Dt=xe.createHTML(""));r&&r(g),ts=g}},fl=F({},[...Qe,...Me,...Ot]),pl=F({},[...bn,...Oe]),op=function(g){let O=Pt(g);(!O||!O.tagName)&&(O={namespaceURI:es,tagName:"template"});const Z=y(g.tagName),ve=y(O.tagName);return zr[g.namespaceURI]?g.namespaceURI===Ni?O.namespaceURI===$t?Z==="svg":O.namespaceURI===Mi?Z==="svg"&&(ve==="annotation-xml"||ki[ve]):!!fl[Z]:g.namespaceURI===Mi?O.namespaceURI===$t?Z==="math":O.namespaceURI===Ni?Z==="math"&&Pi[ve]:!!pl[Z]:g.namespaceURI===$t?O.namespaceURI===Ni&&!Pi[ve]||O.namespaceURI===Mi&&!ki[ve]?!1:!pl[Z]&&(np[Z]||!fl[Z]):!!(Bs==="application/xhtml+xml"&&zr[g.namespaceURI]):!1},Tt=function(g){T(j.removed,{element:g});try{Pt(g).removeChild(g)}catch{kt(g)}},Rn=function(g,O){try{T(j.removed,{attribute:O.getAttributeNode(g),from:O})}catch{T(j.removed,{attribute:null,from:O})}if(O.removeAttribute(g),g==="is")if(Yn||Oi)try{Tt(O)}catch{}else try{O.setAttribute(g,"")}catch{}},ml=function(g){let O=null,Z=null;if(Dr)g="<remove></remove>"+g;else{const Ce=w(g,/^[\r\n\t ]+/);Z=Ce&&Ce[0]}Bs==="application/xhtml+xml"&&es===$t&&(g='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+g+"</body></html>");const ve=xe?xe.createHTML(g):g;if(es===$t)try{O=new Ci().parseFromString(ve,Bs)}catch{}if(!O||!O.documentElement){O=ks.createDocument(es,"template",null);try{O.documentElement.innerHTML=Fr?Dt:ve}catch{}}const Fe=O.body||O.documentElement;return g&&Z&&Fe.insertBefore(le.createTextNode(Z),Fe.childNodes[0]||null),es===$t?Ds.call(O,In?"html":"body")[0]:In?O.documentElement:Fe},gl=function(g){return Xn.call(g.ownerDocument||g,g,Ne.SHOW_ELEMENT|Ne.SHOW_COMMENT|Ne.SHOW_TEXT|Ne.SHOW_PROCESSING_INSTRUCTION|Ne.SHOW_CDATA_SECTION,null)},Wr=function(g){return g instanceof Ms&&(typeof g.nodeName!="string"||typeof g.textContent!="string"||typeof g.removeChild!="function"||!(g.attributes instanceof et)||typeof g.removeAttribute!="function"||typeof g.setAttribute!="function"||typeof g.namespaceURI!="string"||typeof g.insertBefore!="function"||typeof g.hasChildNodes!="function")},yl=function(g){return typeof he=="function"&&g instanceof he};function Bt(Y,g,O){u(Y,Z=>{Z.call(j,g,O,ts)})}const vl=function(g){let O=null;if(Bt(ke.beforeSanitizeElements,g,null),Wr(g))return Tt(g),!0;const Z=Le(g.nodeName);if(Bt(ke.uponSanitizeElement,g,{tagName:Z,allowedTags:V}),Ai&&g.hasChildNodes()&&!yl(g.firstElementChild)&&N(/<[/\w!]/g,g.innerHTML)&&N(/<[/\w!]/g,g.textContent)||g.nodeType===I.progressingInstruction||Ai&&g.nodeType===I.comment&&N(/<[/\w]/g,g.data))return Tt(g),!0;if(!(_e.tagCheck instanceof Function&&_e.tagCheck(Z))&&(!V[Z]||q[Z])){if(!q[Z]&&wl(Z)&&(te.tagNameCheck instanceof RegExp&&N(te.tagNameCheck,Z)||te.tagNameCheck instanceof Function&&te.tagNameCheck(Z)))return!1;if($r&&!Qn[Z]){const ve=Pt(g)||g.parentNode,Fe=Ri(g)||g.childNodes;if(Fe&&ve){const Ce=Fe.length;for(let Ge=Ce-1;Ge>=0;--Ge){const Ft=Ii(Fe[Ge],!0);Ft.__removalCount=(g.__removalCount||0)+1,ve.insertBefore(Ft,Ns(g))}}}return Tt(g),!0}return g instanceof Sn&&!op(g)||(Z==="noscript"||Z==="noembed"||Z==="noframes")&&N(/<\/no(script|embed|frames)/i,g.innerHTML)?(Tt(g),!0):(Se&&g.nodeType===I.text&&(O=g.textContent,u([h,d,m],ve=>{O=_(O,ve," ")}),g.textContent!==O&&(T(j.removed,{element:g.cloneNode()}),g.textContent=O)),Bt(ke.afterSanitizeElements,g,null),!1)},bl=function(g,O,Z){if(ol&&(O==="id"||O==="name")&&(Z in le||Z in rp))return!1;if(!(me&&!Ee[O]&&N(x,O))){if(!(Be&&N(b,O))){if(!(_e.attributeCheck instanceof Function&&_e.attributeCheck(O,g))){if(!U[O]||Ee[O]){if(!(wl(g)&&(te.tagNameCheck instanceof RegExp&&N(te.tagNameCheck,g)||te.tagNameCheck instanceof Function&&te.tagNameCheck(g))&&(te.attributeNameCheck instanceof RegExp&&N(te.attributeNameCheck,O)||te.attributeNameCheck instanceof Function&&te.attributeNameCheck(O,g))||O==="is"&&te.allowCustomizedBuiltInElements&&(te.tagNameCheck instanceof RegExp&&N(te.tagNameCheck,Z)||te.tagNameCheck instanceof Function&&te.tagNameCheck(Z))))return!1}else if(!Br[O]){if(!N(D,_(Z,C,""))){if(!((O==="src"||O==="xlink:href"||O==="href")&&g!=="script"&&A(Z,"data:")===0&&cl[g])){if(!(nn&&!N(S,_(Z,C,"")))){if(Z)return!1}}}}}}}return!0},wl=function(g){return g!=="annotation-xml"&&w(g,M)},El=function(g){Bt(ke.beforeSanitizeAttributes,g,null);const{attributes:O}=g;if(!O||Wr(g))return;const Z={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let ve=O.length;for(;ve--;){const Fe=O[ve],{name:Ce,namespaceURI:Ge,value:Ft}=Fe,ns=Le(Ce),Ur=Ft;let Pe=Ce==="value"?Ur:L(Ur);if(Z.attrName=ns,Z.attrValue=Pe,Z.keepAttr=!0,Z.forceKeepAttr=void 0,Bt(ke.uponSanitizeAttribute,g,Z),Pe=Z.attrValue,al&&(ns==="id"||ns==="name")&&(Rn(Ce,g),Pe=ep+Pe),Ai&&N(/((--!?|])>)|<\/(style|title|textarea)/i,Pe)){Rn(Ce,g);continue}if(ns==="attributename"&&w(Pe,"href")){Rn(Ce,g);continue}if(Z.forceKeepAttr)continue;if(!Z.keepAttr){Rn(Ce,g);continue}if(!sn&&N(/\/>/i,Pe)){Rn(Ce,g);continue}Se&&u([h,d,m],Tl=>{Pe=_(Pe,Tl," ")});const _l=Le(g.nodeName);if(!bl(_l,ns,Pe)){Rn(Ce,g);continue}if(xe&&typeof Kn=="object"&&typeof Kn.getAttributeType=="function"&&!Ge)switch(Kn.getAttributeType(_l,ns)){case"TrustedHTML":{Pe=xe.createHTML(Pe);break}case"TrustedScriptURL":{Pe=xe.createScriptURL(Pe);break}}if(Pe!==Ur)try{Ge?g.setAttributeNS(Ge,Ce,Pe):g.setAttribute(Ce,Pe),Wr(g)?Tt(g):E(j.removed)}catch{Rn(Ce,g)}}Bt(ke.afterSanitizeAttributes,g,null)},ap=function Y(g){let O=null;const Z=gl(g);for(Bt(ke.beforeSanitizeShadowDOM,g,null);O=Z.nextNode();)Bt(ke.uponSanitizeShadowNode,O,null),vl(O),El(O),O.content instanceof Ae&&Y(O.content);Bt(ke.afterSanitizeShadowDOM,g,null)};return j.sanitize=function(Y){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=null,Z=null,ve=null,Fe=null;if(Fr=!Y,Fr&&(Y="<!-->"),typeof Y!="string"&&!yl(Y))if(typeof Y.toString=="function"){if(Y=Y.toString(),typeof Y!="string")throw Q("dirty is not a string, aborting")}else throw Q("toString is not a function");if(!j.isSupported)return Y;if(Pr||Vr(g),j.removed=[],typeof Y=="string"&&($s=!1),$s){if(Y.nodeName){const Ft=Le(Y.nodeName);if(!V[Ft]||q[Ft])throw Q("root node is forbidden and cannot be sanitized in-place")}}else if(Y instanceof he)O=ml("<!---->"),Z=O.ownerDocument.importNode(Y,!0),Z.nodeType===I.element&&Z.nodeName==="BODY"||Z.nodeName==="HTML"?O=Z:O.appendChild(Z);else{if(!Yn&&!Se&&!In&&Y.indexOf("<")===-1)return xe&&Li?xe.createHTML(Y):Y;if(O=ml(Y),!O)return Yn?null:Li?Dt:""}O&&Dr&&Tt(O.firstChild);const Ce=gl($s?Y:O);for(;ve=Ce.nextNode();)vl(ve),El(ve),ve.content instanceof Ae&&ap(ve.content);if($s)return Y;if(Yn){if(Oi)for(Fe=Ps.call(O.ownerDocument);O.firstChild;)Fe.appendChild(O.firstChild);else Fe=O;return(U.shadowroot||U.shadowrootmode)&&(Fe=kr.call(ie,Fe,!0)),Fe}let Ge=In?O.outerHTML:O.innerHTML;return In&&V["!doctype"]&&O.ownerDocument&&O.ownerDocument.doctype&&O.ownerDocument.doctype.name&&N(qn,O.ownerDocument.doctype.name)&&(Ge="<!DOCTYPE "+O.ownerDocument.doctype.name+`>
`+Ge),Se&&u([h,d,m],Ft=>{Ge=_(Ge,Ft," ")}),xe&&Li?xe.createHTML(Ge):Ge},j.setConfig=function(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vr(Y),Pr=!0},j.clearConfig=function(){ts=null,Pr=!1},j.isValidAttribute=function(Y,g,O){ts||Vr({});const Z=Le(Y),ve=Le(g);return bl(Z,ve,O)},j.addHook=function(Y,g){typeof g=="function"&&T(ke[Y],g)},j.removeHook=function(Y,g){if(g!==void 0){const O=f(ke[Y],g);return O===-1?void 0:k(ke[Y],O,1)[0]}return E(ke[Y])},j.removeHooks=function(Y){ke[Y]=[]},j.removeAllHooks=function(){ke=Te()},j}var We=_t();return vr=We,vr}var ya;function hd(){return ya||(ya=1,(function(s){var e=ud();/*!
 * Sizzle CSS Selector Engine v2.3.10
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2024-09-24
 */(function(t){var n,i,r,o,a,l,c,u,f,E,T,k,y,v,w,_,A,L,B,N="sizzle"+1*new Date,Q=t.document,P=0,pe=0,F=Sn(),je=Sn(),Re=Sn(),ye=Sn(),Et=function(h,d){return h===d&&(T=!0),0},Qe={}.hasOwnProperty,Me=[],Ot=Me.pop,bn=Me.push,Oe=Me.push,wn=Me.slice,st=function(h,d){for(var m=0,x=h.length;m<x;m++)if(h[m]===d)return m;return-1},Lt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ue="[\\x20\\t\\r\\n\\f]",Ze="(?:\\\\[\\da-fA-F]{1,6}"+ue+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Mt="\\["+ue+"*("+Ze+")(?:"+ue+"*([*^$|!~]?=)"+ue+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Ze+"))|)"+ue+"*\\]",En=":("+Ze+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Mt+")*)|.*)\\)|)",en=new RegExp(ue+"+","g"),Nt=new RegExp("^"+ue+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ue+"+$","g"),Os=new RegExp("^"+ue+"*,"+ue+"*"),_n=new RegExp("^"+ue+"*([>+~]|"+ue+")"+ue+"*"),Ls=new RegExp(ue+"|>"),Tn=new RegExp(En),qn=new RegExp("^"+Ze+"$"),tn={ID:new RegExp("^#("+Ze+")"),CLASS:new RegExp("^\\.("+Ze+")"),TAG:new RegExp("^("+Ze+"|[*])"),ATTR:new RegExp("^"+Mt),PSEUDO:new RegExp("^"+En),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ue+"*(even|odd|(([+-]|)(\\d*)n|)"+ue+"*(?:([+-]|)"+ue+"*(\\d+)|))"+ue+"*\\)|)","i"),bool:new RegExp("^(?:"+Lt+")$","i"),needsContext:new RegExp("^"+ue+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ue+"*((?:-\\d)?\\d*)"+ue+"*\\)|)(?=[^-]|$)","i")},xn=/HTML$/i,I=/^(?:input|select|textarea|button)$/i,z=/^h\d$/i,se=/^[^{]+\{\s*\[native \w/,Te=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_t=/[+~]/,We=new RegExp("\\\\[\\da-fA-F]{1,6}"+ue+"?|\\\\([^\\r\\n\\f])","g"),ee=function(h,d){var m="0x"+h.slice(1)-65536;return d||(m<0?String.fromCharCode(m+65536):String.fromCharCode(m>>10|55296,m&1023|56320))},j=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,le=function(h,d){return d?h==="\0"?"":h.slice(0,-1)+"\\"+h.charCodeAt(h.length-1).toString(16)+" ":"\\"+h},ie=function(){k()},ge=xe(function(h){return h.disabled===!0&&h.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"}),Ae,ft=function(h){return Ae===void 0&&(Ae={createHTML:function(d){return d}},typeof t.trustedTypes<"u"&&t.trustedTypes.createPolicy&&(Ae=t.trustedTypes.createPolicy("dompurify",{createHTML:function(d){return e.sanitize(d)}}))),Ae.createHTML(h)};try{Oe.apply(Me=wn.call(Q.childNodes),Q.childNodes),Me[Q.childNodes.length].nodeType}catch{Oe={apply:Me.length?function(d,m){bn.apply(d,wn.call(m))}:function(d,m){for(var x=d.length,b=0;d[x++]=m[b++];);d.length=x-1}}}function he(h,d,m,x){var b,S,C,M,D,V,K,U=d&&d.ownerDocument,oe=d?d.nodeType:9;if(m=m||[],typeof h!="string"||!h||oe!==1&&oe!==9&&oe!==11)return m;if(!x&&(k(d),d=d||y,w)){if(oe!==11&&(D=Te.exec(h)))if(b=D[1]){if(oe===9)if(C=d.getElementById(b)){if(C.id===b)return m.push(C),m}else return m;else if(U&&(C=U.getElementById(b))&&B(d,C)&&C.id===b)return m.push(C),m}else{if(D[2])return Oe.apply(m,d.getElementsByTagName(h)),m;if((b=D[3])&&i.getElementsByClassName&&d.getElementsByClassName)return Oe.apply(m,d.getElementsByClassName(b)),m}if(i.qsa&&!ye[h+" "]&&(!_||!_.test(h))&&(oe!==1||d.nodeName.toLowerCase()!=="object")){if(K=h,U=d,oe===1&&(Ls.test(h)||_n.test(h))){for(U=_t.test(h)&&Ns(d.parentNode)||d,(U!==d||!i.scope)&&((M=d.getAttribute("id"))?M=M.replace(j,le):d.setAttribute("id",M=N)),V=l(h),S=V.length;S--;)V[S]=(M?"#"+M:":scope")+" "+Pt(V[S]);K=V.join(",")}try{return Oe.apply(m,U.querySelectorAll(K)),m}catch{ye(h,!0)}finally{M===N&&d.removeAttribute("id")}}}return u(h.replace(Nt,"$1"),d,m,x)}function Sn(){var h=[];function d(m,x){return h.push(m+" ")>r.cacheLength&&delete d[h.shift()],d[m+" "]=x}return d}function Ne(h){return h[N]=!0,h}function et(h){var d=y.createElement("fieldset");try{return!!h(d)}catch{return!1}finally{d.parentNode&&d.parentNode.removeChild(d),d=null}}function Ms(h,d){for(var m=h.split("|"),x=m.length;x--;)r.attrHandle[m[x]]=d}function Ci(h,d){var m=d&&h,x=m&&h.nodeType===1&&d.nodeType===1&&h.sourceIndex-d.sourceIndex;if(x)return x;if(m){for(;m=m.nextSibling;)if(m===d)return-1}return h?1:-1}function Kn(h){return function(d){var m=d.nodeName.toLowerCase();return m==="input"&&d.type===h}}function Cn(h){return function(d){var m=d.nodeName.toLowerCase();return(m==="input"||m==="button")&&d.type===h}}function Ii(h){return function(d){return"form"in d?d.parentNode&&d.disabled===!1?"label"in d?"label"in d.parentNode?d.parentNode.disabled===h:d.disabled===h:d.isDisabled===h||d.isDisabled!==!h&&ge(d)===h:d.disabled===h:"label"in d?d.disabled===h:!1}}function kt(h){return Ne(function(d){return d=+d,Ne(function(m,x){for(var b,S=h([],m.length,d),C=S.length;C--;)m[b=S[C]]&&(m[b]=!(x[b]=m[b]))})})}function Ns(h){return h&&typeof h.getElementsByTagName<"u"&&h}i=he.support={},a=he.isXML=function(h){var d=h&&h.namespaceURI,m=h&&(h.ownerDocument||h).documentElement;return!xn.test(d||m&&m.nodeName||"HTML")},k=he.setDocument=function(h){var d,m,x=h?h.ownerDocument||h:Q;return x==y||x.nodeType!==9||!x.documentElement||(y=x,v=y.documentElement,w=!a(y),Q!=y&&(m=y.defaultView)&&m.top!==m&&(m.addEventListener?m.addEventListener("unload",ie,!1):m.attachEvent&&m.attachEvent("onunload",ie)),i.scope=et(function(b){return v.appendChild(b).appendChild(y.createElement("div")),typeof b.querySelectorAll<"u"&&!b.querySelectorAll(":scope fieldset div").length}),i.attributes=et(function(b){return b.className="i",!b.getAttribute("className")}),i.getElementsByTagName=et(function(b){return b.appendChild(y.createComment("")),!b.getElementsByTagName("*").length}),i.getElementsByClassName=se.test(y.getElementsByClassName),i.getById=et(function(b){return v.appendChild(b).id=N,!y.getElementsByName||!y.getElementsByName(N).length}),i.getById?(r.filter.ID=function(b){var S=b.replace(We,ee);return function(C){return C.getAttribute("id")===S}},r.find.ID=function(b,S){if(typeof S.getElementById<"u"&&w){var C=S.getElementById(b);return C?[C]:[]}}):(r.filter.ID=function(b){var S=b.replace(We,ee);return function(C){var M=typeof C.getAttributeNode<"u"&&C.getAttributeNode("id");return M&&M.value===S}},r.find.ID=function(b,S){if(typeof S.getElementById<"u"&&w){var C,M,D,V=S.getElementById(b);if(V){if(C=V.getAttributeNode("id"),C&&C.value===b)return[V];for(D=S.getElementsByName(b),M=0;V=D[M++];)if(C=V.getAttributeNode("id"),C&&C.value===b)return[V]}return[]}}),r.find.TAG=i.getElementsByTagName?function(b,S){if(typeof S.getElementsByTagName<"u")return S.getElementsByTagName(b);if(i.qsa)return S.querySelectorAll(b)}:function(b,S){var C,M=[],D=0,V=S.getElementsByTagName(b);if(b==="*"){for(;C=V[D++];)C.nodeType===1&&M.push(C);return M}return V},r.find.CLASS=i.getElementsByClassName&&function(b,S){if(typeof S.getElementsByClassName<"u"&&w)return S.getElementsByClassName(b)},A=[],_=[],(i.qsa=se.test(y.querySelectorAll))&&(et(function(b){var S;v.appendChild(b).innerHTML=ft("<a id='"+N+"'></a><select id='"+N+"-\r\\' msallowcapture=''><option selected=''></option></select>"),b.querySelectorAll("[msallowcapture^='']").length&&_.push("[*^$]="+ue+`*(?:''|"")`),b.querySelectorAll("[selected]").length||_.push("\\["+ue+"*(?:value|"+Lt+")"),b.querySelectorAll("[id~="+N+"-]").length||_.push("~="),S=y.createElement("input"),S.setAttribute("name",""),b.appendChild(S),b.querySelectorAll("[name='']").length||_.push("\\["+ue+"*name"+ue+"*="+ue+`*(?:''|"")`),b.querySelectorAll(":checked").length||_.push(":checked"),b.querySelectorAll("a#"+N+"+*").length||_.push(".#.+[+~]"),b.querySelectorAll("\\\f"),_.push("[\\r\\n\\f]")}),et(function(b){b.innerHTML=ft("<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>");var S=y.createElement("input");S.setAttribute("type","hidden"),b.appendChild(S).setAttribute("name","D"),b.querySelectorAll("[name=d]").length&&_.push("name"+ue+"*[*^$|!~]?="),b.querySelectorAll(":enabled").length!==2&&_.push(":enabled",":disabled"),v.appendChild(b).disabled=!0,b.querySelectorAll(":disabled").length!==2&&_.push(":enabled",":disabled"),b.querySelectorAll("*,:x"),_.push(",.*:")})),(i.matchesSelector=se.test(L=v.matches||v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&et(function(b){i.disconnectedMatch=L.call(b,"*"),L.call(b,"[s!='']:x"),A.push("!=",En)}),_=_.length&&new RegExp(_.join("|")),A=A.length&&new RegExp(A.join("|")),d=se.test(v.compareDocumentPosition),B=d||se.test(v.contains)?function(b,S){var C=b.nodeType===9?b.documentElement:b,M=S&&S.parentNode;return b===M||!!(M&&M.nodeType===1&&(C.contains?C.contains(M):b.compareDocumentPosition&&b.compareDocumentPosition(M)&16))}:function(b,S){if(S){for(;S=S.parentNode;)if(S===b)return!0}return!1},Et=d?function(b,S){if(b===S)return T=!0,0;var C=!b.compareDocumentPosition-!S.compareDocumentPosition;return C||(C=(b.ownerDocument||b)==(S.ownerDocument||S)?b.compareDocumentPosition(S):1,C&1||!i.sortDetached&&S.compareDocumentPosition(b)===C?b==y||b.ownerDocument==Q&&B(Q,b)?-1:S==y||S.ownerDocument==Q&&B(Q,S)?1:E?st(E,b)-st(E,S):0:C&4?-1:1)}:function(b,S){if(b===S)return T=!0,0;var C,M=0,D=b.parentNode,V=S.parentNode,K=[b],U=[S];if(!D||!V)return b==y?-1:S==y?1:D?-1:V?1:E?st(E,b)-st(E,S):0;if(D===V)return Ci(b,S);for(C=b;C=C.parentNode;)K.unshift(C);for(C=S;C=C.parentNode;)U.unshift(C);for(;K[M]===U[M];)M++;return M?Ci(K[M],U[M]):K[M]==Q?-1:U[M]==Q?1:0}),y},he.matches=function(h,d){return he(h,null,null,d)},he.matchesSelector=function(h,d){if(k(h),i.matchesSelector&&w&&!ye[d+" "]&&(!A||!A.test(d))&&(!_||!_.test(d)))try{var m=L.call(h,d);if(m||i.disconnectedMatch||h.document&&h.document.nodeType!==11)return m}catch{ye(d,!0)}return he(d,y,null,[h]).length>0},he.contains=function(h,d){return(h.ownerDocument||h)!=y&&k(h),B(h,d)},he.attr=function(h,d){(h.ownerDocument||h)!=y&&k(h);var m=r.attrHandle[d.toLowerCase()],x=m&&Qe.call(r.attrHandle,d.toLowerCase())?m(h,d,!w):void 0;return x!==void 0?x:i.attributes||!w?h.getAttribute(d):(x=h.getAttributeNode(d))&&x.specified?x.value:null},he.escape=function(h){return(h+"").replace(j,le)},he.error=function(h){throw new Error("Syntax error, unrecognized expression: "+h)},he.uniqueSort=function(h){var d,m=[],x=0,b=0;if(T=!i.detectDuplicates,E=!i.sortStable&&h.slice(0),h.sort(Et),T){for(;d=h[b++];)d===h[b]&&(x=m.push(b));for(;x--;)h.splice(m[x],1)}return E=null,h},o=he.getText=function(h){var d,m="",x=0,b=h.nodeType;if(b){if(b===1||b===9||b===11){if(typeof h.textContent=="string")return h.textContent;for(h=h.firstChild;h;h=h.nextSibling)m+=o(h)}else if(b===3||b===4)return h.nodeValue}else for(;d=h[x++];)m+=o(d);return m},r=he.selectors={cacheLength:50,createPseudo:Ne,match:tn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(h){return h[1]=h[1].replace(We,ee),h[3]=(h[3]||h[4]||h[5]||"").replace(We,ee),h[2]==="~="&&(h[3]=" "+h[3]+" "),h.slice(0,4)},CHILD:function(h){return h[1]=h[1].toLowerCase(),h[1].slice(0,3)==="nth"?(h[3]||he.error(h[0]),h[4]=+(h[4]?h[5]+(h[6]||1):2*(h[3]==="even"||h[3]==="odd")),h[5]=+(h[7]+h[8]||h[3]==="odd")):h[3]&&he.error(h[0]),h},PSEUDO:function(h){var d,m=!h[6]&&h[2];return tn.CHILD.test(h[0])?null:(h[3]?h[2]=h[4]||h[5]||"":m&&Tn.test(m)&&(d=l(m,!0))&&(d=m.indexOf(")",m.length-d)-m.length)&&(h[0]=h[0].slice(0,d),h[2]=m.slice(0,d)),h.slice(0,3))}},filter:{TAG:function(h){var d=h.replace(We,ee).toLowerCase();return h==="*"?function(){return!0}:function(m){return m.nodeName&&m.nodeName.toLowerCase()===d}},CLASS:function(h){var d=F[h+" "];return d||(d=new RegExp("(^|"+ue+")"+h+"("+ue+"|$)"))&&F(h,function(m){return d.test(typeof m.className=="string"&&m.className||typeof m.getAttribute<"u"&&m.getAttribute("class")||"")})},ATTR:function(h,d,m){return function(x){var b=he.attr(x,h);return b==null?d==="!=":d?(b+="",d==="="?b===m:d==="!="?b!==m:d==="^="?m&&b.indexOf(m)===0:d==="*="?m&&b.indexOf(m)>-1:d==="$="?m&&b.slice(-m.length)===m:d==="~="?(" "+b.replace(en," ")+" ").indexOf(m)>-1:d==="|="?b===m||b.slice(0,m.length+1)===m+"-":!1):!0}},CHILD:function(h,d,m,x,b){var S=h.slice(0,3)!=="nth",C=h.slice(-4)!=="last",M=d==="of-type";return x===1&&b===0?function(D){return!!D.parentNode}:function(D,V,K){var U,oe,te,q,Ee,_e,Be=S!==C?"nextSibling":"previousSibling",me=D.parentNode,nn=M&&D.nodeName.toLowerCase(),sn=!K&&!M,Se=!1;if(me){if(S){for(;Be;){for(q=D;q=q[Be];)if(M?q.nodeName.toLowerCase()===nn:q.nodeType===1)return!1;_e=Be=h==="only"&&!_e&&"nextSibling"}return!0}if(_e=[C?me.firstChild:me.lastChild],C&&sn){for(q=me,te=q[N]||(q[N]={}),oe=te[q.uniqueID]||(te[q.uniqueID]={}),U=oe[h]||[],Ee=U[0]===P&&U[1],Se=Ee&&U[2],q=Ee&&me.childNodes[Ee];q=++Ee&&q&&q[Be]||(Se=Ee=0)||_e.pop();)if(q.nodeType===1&&++Se&&q===D){oe[h]=[P,Ee,Se];break}}else if(sn&&(q=D,te=q[N]||(q[N]={}),oe=te[q.uniqueID]||(te[q.uniqueID]={}),U=oe[h]||[],Ee=U[0]===P&&U[1],Se=Ee),Se===!1)for(;(q=++Ee&&q&&q[Be]||(Se=Ee=0)||_e.pop())&&!((M?q.nodeName.toLowerCase()===nn:q.nodeType===1)&&++Se&&(sn&&(te=q[N]||(q[N]={}),oe=te[q.uniqueID]||(te[q.uniqueID]={}),oe[h]=[P,Se]),q===D)););return Se-=b,Se===x||Se%x===0&&Se/x>=0}}},PSEUDO:function(h,d){var m,x=r.pseudos[h]||r.setFilters[h.toLowerCase()]||he.error("unsupported pseudo: "+h);return x[N]?x(d):x.length>1?(m=[h,h,"",d],r.setFilters.hasOwnProperty(h.toLowerCase())?Ne(function(b,S){for(var C,M=x(b,d),D=M.length;D--;)C=st(b,M[D]),b[C]=!(S[C]=M[D])}):function(b){return x(b,0,m)}):x}},pseudos:{not:Ne(function(h){var d=[],m=[],x=c(h.replace(Nt,"$1"));return x[N]?Ne(function(b,S,C,M){for(var D,V=x(b,null,M,[]),K=b.length;K--;)(D=V[K])&&(b[K]=!(S[K]=D))}):function(b,S,C){return d[0]=b,x(d,null,C,m),d[0]=null,!m.pop()}}),has:Ne(function(h){return function(d){return he(h,d).length>0}}),contains:Ne(function(h){return h=h.replace(We,ee),function(d){return(d.textContent||o(d)).indexOf(h)>-1}}),lang:Ne(function(h){return qn.test(h||"")||he.error("unsupported lang: "+h),h=h.replace(We,ee).toLowerCase(),function(d){var m;do if(m=w?d.lang:d.getAttribute("xml:lang")||d.getAttribute("lang"))return m=m.toLowerCase(),m===h||m.indexOf(h+"-")===0;while((d=d.parentNode)&&d.nodeType===1);return!1}}),target:function(h){var d=t.location&&t.location.hash;return d&&d.slice(1)===h.id},root:function(h){return h===v},focus:function(h){return h===y.activeElement&&(!y.hasFocus||y.hasFocus())&&!!(h.type||h.href||~h.tabIndex)},enabled:Ii(!1),disabled:Ii(!0),checked:function(h){var d=h.nodeName.toLowerCase();return d==="input"&&!!h.checked||d==="option"&&!!h.selected},selected:function(h){return h.parentNode&&h.parentNode.selectedIndex,h.selected===!0},empty:function(h){for(h=h.firstChild;h;h=h.nextSibling)if(h.nodeType<6)return!1;return!0},parent:function(h){return!r.pseudos.empty(h)},header:function(h){return z.test(h.nodeName)},input:function(h){return I.test(h.nodeName)},button:function(h){var d=h.nodeName.toLowerCase();return d==="input"&&h.type==="button"||d==="button"},text:function(h){var d;return h.nodeName.toLowerCase()==="input"&&h.type==="text"&&((d=h.getAttribute("type"))==null||d.toLowerCase()==="text")},first:kt(function(){return[0]}),last:kt(function(h,d){return[d-1]}),eq:kt(function(h,d,m){return[m<0?m+d:m]}),even:kt(function(h,d){for(var m=0;m<d;m+=2)h.push(m);return h}),odd:kt(function(h,d){for(var m=1;m<d;m+=2)h.push(m);return h}),lt:kt(function(h,d,m){for(var x=m<0?m+d:m>d?d:m;--x>=0;)h.push(x);return h}),gt:kt(function(h,d,m){for(var x=m<0?m+d:m;++x<d;)h.push(x);return h})}},r.pseudos.nth=r.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[n]=Kn(n);for(n in{submit:!0,reset:!0})r.pseudos[n]=Cn(n);function Ri(){}Ri.prototype=r.filters=r.pseudos,r.setFilters=new Ri,l=he.tokenize=function(h,d){var m,x,b,S,C,M,D,V=je[h+" "];if(V)return d?0:V.slice(0);for(C=h,M=[],D=r.preFilter;C;){(!m||(x=Os.exec(C)))&&(x&&(C=C.slice(x[0].length)||C),M.push(b=[])),m=!1,(x=_n.exec(C))&&(m=x.shift(),b.push({value:m,type:x[0].replace(Nt," ")}),C=C.slice(m.length));for(S in r.filter)(x=tn[S].exec(C))&&(!D[S]||(x=D[S](x)))&&(m=x.shift(),b.push({value:m,type:S,matches:x}),C=C.slice(m.length));if(!m)break}return d?C.length:C?he.error(h):je(h,M).slice(0)};function Pt(h){for(var d=0,m=h.length,x="";d<m;d++)x+=h[d].value;return x}function xe(h,d,m){var x=d.dir,b=d.next,S=b||x,C=m&&S==="parentNode",M=pe++;return d.first?function(D,V,K){for(;D=D[x];)if(D.nodeType===1||C)return h(D,V,K);return!1}:function(D,V,K){var U,oe,te,q=[P,M];if(K){for(;D=D[x];)if((D.nodeType===1||C)&&h(D,V,K))return!0}else for(;D=D[x];)if(D.nodeType===1||C)if(te=D[N]||(D[N]={}),oe=te[D.uniqueID]||(te[D.uniqueID]={}),b&&b===D.nodeName.toLowerCase())D=D[x]||D;else{if((U=oe[S])&&U[0]===P&&U[1]===M)return q[2]=U[2];if(oe[S]=q,q[2]=h(D,V,K))return!0}return!1}}function Dt(h){return h.length>1?function(d,m,x){for(var b=h.length;b--;)if(!h[b](d,m,x))return!1;return!0}:h[0]}function ks(h,d,m){for(var x=0,b=d.length;x<b;x++)he(h,d[x],m);return m}function Xn(h,d,m,x,b){for(var S,C=[],M=0,D=h.length,V=d!=null;M<D;M++)(S=h[M])&&(!m||m(S,x,b))&&(C.push(S),V&&d.push(M));return C}function Ps(h,d,m,x,b,S){return x&&!x[N]&&(x=Ps(x)),b&&!b[N]&&(b=Ps(b,S)),Ne(function(C,M,D,V){var K,U,oe,te=[],q=[],Ee=M.length,_e=C||ks(d||"*",D.nodeType?[D]:D,[]),Be=h&&(C||!d)?Xn(_e,te,h,D,V):_e,me=m?b||(C?h:Ee||x)?[]:M:Be;if(m&&m(Be,me,D,V),x)for(K=Xn(me,q),x(K,[],D,V),U=K.length;U--;)(oe=K[U])&&(me[q[U]]=!(Be[q[U]]=oe));if(C){if(b||h){if(b){for(K=[],U=me.length;U--;)(oe=me[U])&&K.push(Be[U]=oe);b(null,me=[],K,V)}for(U=me.length;U--;)(oe=me[U])&&(K=b?st(C,oe):te[U])>-1&&(C[K]=!(M[K]=oe))}}else me=Xn(me===M?me.splice(Ee,me.length):me),b?b(null,M,me,V):Oe.apply(M,me)})}function Ds(h){for(var d,m,x,b=h.length,S=r.relative[h[0].type],C=S||r.relative[" "],M=S?1:0,D=xe(function(U){return U===d},C,!0),V=xe(function(U){return st(d,U)>-1},C,!0),K=[function(U,oe,te){var q=!S&&(te||oe!==f)||((d=oe).nodeType?D(U,oe,te):V(U,oe,te));return d=null,q}];M<b;M++)if(m=r.relative[h[M].type])K=[xe(Dt(K),m)];else{if(m=r.filter[h[M].type].apply(null,h[M].matches),m[N]){for(x=++M;x<b&&!r.relative[h[x].type];x++);return Ps(M>1&&Dt(K),M>1&&Pt(h.slice(0,M-1).concat({value:h[M-2].type===" "?"*":""})).replace(Nt,"$1"),m,M<x&&Ds(h.slice(M,x)),x<b&&Ds(h=h.slice(x)),x<b&&Pt(h))}K.push(m)}return Dt(K)}function kr(h,d){var m=d.length>0,x=h.length>0,b=function(S,C,M,D,V){var K,U,oe,te=0,q="0",Ee=S&&[],_e=[],Be=f,me=S||x&&r.find.TAG("*",V),nn=P+=Be==null?1:Math.random()||.1,sn=me.length;for(V&&(f=C==y||C||V);q!==sn&&(K=me[q])!=null;q++){if(x&&K){for(U=0,!C&&K.ownerDocument!=y&&(k(K),M=!w);oe=h[U++];)if(oe(K,C||y,M)){D.push(K);break}V&&(P=nn)}m&&((K=!oe&&K)&&te--,S&&Ee.push(K))}if(te+=q,m&&q!==te){for(U=0;oe=d[U++];)oe(Ee,_e,C,M);if(S){if(te>0)for(;q--;)Ee[q]||_e[q]||(_e[q]=Ot.call(D));_e=Xn(_e)}Oe.apply(D,_e),V&&!S&&_e.length>0&&te+d.length>1&&he.uniqueSort(D)}return V&&(P=nn,f=Be),Ee};return m?Ne(b):b}c=he.compile=function(h,d){var m,x=[],b=[],S=Re[h+" "];if(!S){for(d||(d=l(h)),m=d.length;m--;)S=Ds(d[m]),S[N]?x.push(S):b.push(S);S=Re(h,kr(b,x)),S.selector=h}return S},u=he.select=function(h,d,m,x){var b,S,C,M,D,V=typeof h=="function"&&h,K=!x&&l(h=V.selector||h);if(m=m||[],K.length===1){if(S=K[0]=K[0].slice(0),S.length>2&&(C=S[0]).type==="ID"&&d.nodeType===9&&w&&r.relative[S[1].type]){if(d=(r.find.ID(C.matches[0].replace(We,ee),d)||[])[0],d)V&&(d=d.parentNode);else return m;h=h.slice(S.shift().value.length)}for(b=tn.needsContext.test(h)?0:S.length;b--&&(C=S[b],!r.relative[M=C.type]);)if((D=r.find[M])&&(x=D(C.matches[0].replace(We,ee),_t.test(S[0].type)&&Ns(d.parentNode)||d))){if(S.splice(b,1),h=x.length&&Pt(S),!h)return Oe.apply(m,x),m;break}}return(V||c(h,K))(x,d,!w,m,!d||_t.test(h)&&Ns(d.parentNode)||d),m},i.sortStable=N.split("").sort(Et).join("")===N,i.detectDuplicates=!!T,k(),i.sortDetached=et(function(h){return h.compareDocumentPosition(y.createElement("fieldset"))&1}),et(function(h){return h.innerHTML=ft("<a href='#'></a>"),h.firstChild.getAttribute("href")==="#"})||Ms("type|href|height|width",function(h,d,m){if(!m)return h.getAttribute(d,d.toLowerCase()==="type"?1:2)}),(!i.attributes||!et(function(h){return h.innerHTML=ft("<input/>"),h.firstChild.setAttribute("value",""),h.firstChild.getAttribute("value")===""}))&&Ms("value",function(h,d,m){if(!m&&h.nodeName.toLowerCase()==="input")return h.defaultValue}),et(function(h){return h.getAttribute("disabled")==null})||Ms(Lt,function(h,d,m){var x;if(!m)return h[d]===!0?d.toLowerCase():(x=h.getAttributeNode(d))&&x.specified?x.value:null});var ke=t.Sizzle;he.noConflict=function(){return t.Sizzle===he&&(t.Sizzle=ke),he},s.exports?s.exports=he:t.Sizzle=he})(window)})(yr)),yr.exports}var dd=hd();const Xt=ua(dd);function fd(s){return s!==null}async function pd(s,e){return await new Promise((t,n)=>{let i=!1;s.send({action:"START_FINDER"}).then(()=>i=!0).then(async()=>await s.send({action:"FIND",value:e})).then(r=>{r?.value?.success?t(r?.value):t(null)}).catch(r=>{n(r)}),setTimeout(()=>{!i&&t(null)},150)})}function md(s=null){return s==null?{_bonus:0,_elements:[]}:{_bonus:s.bonus,_elements:s.elements.map(e=>{if(e.proximity===pi.DYNAMIC){const{proximity:t,level:n,selector:i}=e;return{proximity:t,level:n,selector:i.path}}else{const{proximity:t,selector:n}=e;return{proximity:t,selector:n.path}}})}}async function gd(s,e,t=[],n,i,r,o=0){const a=It.getWindows(u=>u.getDepth()===o),l=s.getOptions(),c={options:l,selectors:e.map(u=>u.path),iframes:t.map(u=>u.map(f=>f.path)),context:l.contextEnabled?md(n):null,validationData:l.validationEnabled?r:null,rigidity:i};return await Promise.all(a.map(async u=>await pd(u,c))).then(u=>u.filter(fd))}function yd(s){const e=It.getWindows(t=>t.getDepth()===1).map(t=>vd(t,s));return t=>{e.splice(0).forEach(n=>{n(t)})}}function vd(s,e){s.send({action:"START_PICKER",value:{source:null,domain:window.location.origin,options:e.getOptions()}},!1).catch(H.error);const t=i=>{try{switch(i.payload.action){case"PICKER_CROSS_HOVER":e.hideHighlighter();break;case"PICKER_CROSS_SELECT":bd(i,e);break;case"PICKER_CROSS_STOP":e.stop();break;default:break}}catch(r){H.error(r),e.stop()}},n=s.onMessage(t);return async i=>{await s.send({action:"STOP_PICKER",value:{reason:i}},!1),n()}}function bd(s,e){const t=s.value?.result;if(Yt.lastHoveredEvent==null)throw new Error("No last hovered event");const n=[...e.getTrailForMouseEvent(Yt.lastHoveredEvent),jn(Yt.lastHoveredEvent)],i=e.getOptions().dynamicIframes?[]:[...n.reduce((o,a)=>(a!=null&&o.push(e.selectorsFor(a)),o),[]),...(t?.iframes??[]).map(o=>o.map(a=>new Ie(a.path)))],r={selectors:t?.selectors.map(o=>new Ie(o.path)),pathElement:t!=null?new mn(t.pathElement?.elementType??"div",t.pathElement?.id??null,t.pathElement?.classList??[],t.pathElement?.attributesList??[],t.pathElement?.texts??[]):null,iframes:i,contextElements:t?.contextElements!=null?t?.contextElements?.map(o=>({selector:new Ie(o.selector.path),proximity:o.proximity,level:"level"in o?o.level:null})):void 0,validationData:t?.validationData,element:null,isCross:!0};e.event?.trigger(Yt.SELECT,r),e.stop(Yt.SELECT)}function wd(s,e,t){const n=new URL(e,"https://www.google.fr"),r=new URLSearchParams(n.search).get(t),o=s.tagName.toLowerCase();return r==null||r===""?`${o}[src="${e}"]`:`${o}[src*="${t}=${r}"]`}function Ed(s,e){const t=[];return e.forEach(n=>{const i=s.getAttribute("src");if(i!=null)switch(n.attributeRule){case"keepOnlyURLVar":t.push(wd(s,i,n.ruleValue));break;default:t.push(`iframe[src="${i}"]`);break}}),t}const fe=class fe{constructor(e){this.contextEnabled=!1,this.contextWidth=3,this.textsEnabled=!0,this.limitTextSelectorToTarget=!0,this.validationEnabled=!0,this.validators=[],this.pathExtensions=[],this.eventsToBlock=[],this.cssClassesBlacklist=[],this.useCssClassesInPath=!0,this.useIdSelector=!0,this.dynamicIframes=!1,this.event=vu(),this.highlighter=null,this.iframesSettings={},this.highlighterStyles=`
    position: fixed; z-index: 2147483647;
    top: -10000px; left: -10000px;
    width: 0; height: 0;
    box-sizing: border-box !important;
    box-shadow: 0 0 0px 2px blue;
    pointer-events: none;
    background-color: transparent;
  `,this.unlisteners=[],this.iframes=[],this.cross=t=>yd(t),this.stopCross=null,this.useIdSelector=e?.useIdSelector??fe.defaultOptions.useIdSelector,this.useCssClassesInPath=e?.useCssClassesInPath??fe.defaultOptions.useCssClassesInPath,this.setOptions(e??{})}start(){return fe.active===this?null:(fe.active!=null&&fe.active!==this&&fe.active.stop("picker-start"),fe.active=this,this.event.trigger(fe.START),this.iframes=this.getIframes(document),this.createHighlighter(),this.stopCross=this.cross(this),this.setupListeners(),this.event)}stop(e="unknown"){this.event?.trigger(fe.STOP,e),this.unlisteners.splice(0).forEach(t=>{t()}),this.removeHighlighter(),typeof this.stopCross=="function"&&(this.stopCross(e),this.stopCross=null),fe.active=null,fe.lastHoveredEvent=null}getUnlistenersCount(){return this.unlisteners.length}setTextsEnabled(e){this.textsEnabled=e}setLimitTextSelectorToTarget(e){this.limitTextSelectorToTarget=e}setContextEnabled(e){this.contextEnabled=e}setContextWidth(e){this.contextWidth=typeof e!="number"?this.contextWidth:e}setEventsToBlock(e){this.eventsToBlock=e}getEventsToBlock(){return this.eventsToBlock}setCssClassesBlacklist(e){this.cssClassesBlacklist=e}setIframesSettings(e){e!==void 0&&(this.iframesSettings=e)}getCssClassesBlacklist(){return this.cssClassesBlacklist}setValidationEnabled(e){this.validationEnabled=e}addValidator(e){this.validators.push(e)}addPathExtension(e){this.pathExtensions.push(e)}setCrossResolver(e){this.stopCross!=null&&(this.stopCross(),this.stopCross=null),this.cross=e}getOptions(){return{textsEnabled:this.textsEnabled,limitTextSelectorToTarget:this.limitTextSelectorToTarget,contextEnabled:this.contextEnabled,contextWidth:this.contextWidth,validationEnabled:this.validationEnabled,pathExtensions:this.pathExtensions,iframesSettings:this.iframesSettings,validators:this.validators,eventsToBlock:this.eventsToBlock,cssClassesBlacklist:this.cssClassesBlacklist,useIdSelector:this.useIdSelector,useCssClassesInPath:this.useCssClassesInPath,dynamicIframes:this.dynamicIframes}}setOptions(e){const t={...fe.defaultOptions,...e,eventsToBlock:e?.eventsToBlock??fe.defaultOptions.eventsToBlock};this.setTextsEnabled(t.textsEnabled),this.setLimitTextSelectorToTarget(t.limitTextSelectorToTarget),this.setValidationEnabled(t.validationEnabled),this.setContextEnabled(t.contextEnabled),this.setContextWidth(t.contextWidth),this.setEventsToBlock(t.eventsToBlock),this.setCssClassesBlacklist(t.cssClassesBlacklist),this.dynamicIframes=t.dynamicIframes,t.validators.forEach(n=>{this.addValidator(n)}),t.pathExtensions.forEach(n=>{this.addPathExtension(n)})}static getLastHoveredElement(){if(fe.lastHoveredEvent==null)return null;const e=jn(fe.lastHoveredEvent);return e instanceof Element?e:null}setupListeners(){const e=i=>{this.onMouseEvent(i)};window.addEventListener("mouseover",e,!0),this.unlisteners.push(()=>{window.removeEventListener("mouseover",e,!0)}),window.addEventListener("mousemove",e,!0),this.unlisteners.push(()=>{window.removeEventListener("mousemove",e,!0)});const t=i=>{this.onKeyUp(i)};window.addEventListener("keyup",t,!0),this.unlisteners.push(()=>{window.removeEventListener("keyup",t,!0)});const n=i=>{this.onClick(i)};if(window.addEventListener("click",n,!0),this.unlisteners.push(()=>{window.removeEventListener("click",n,!0)}),this.eventsToBlock.length>0){const i=r=>{r.preventDefault(),r.stopImmediatePropagation()};this.eventsToBlock.forEach(r=>{window.addEventListener(r,i,!0),this.unlisteners.push(function(){window.removeEventListener(r,i,!0)})})}this.setupIframesListeners({onMouseEvent:e,onKeyUp:t,onClick:n})}setupIframesListeners(e,t=null){const{onIframeEnter:n,onIframeLeave:i,onClick:r,onKeyUp:o,onMouseEvent:a}=e;(t??this.iframes).forEach(({iframe:l,childFrames:c})=>{try{const u=l.contentWindow;u!=null&&(n!=null&&(l.addEventListener("mouseenter",n,!0),this.unlisteners.push(()=>{l.removeEventListener("mouseenter",n,!0)})),i!=null&&(l.addEventListener("mouseleave",i,!0),this.unlisteners.push(()=>{l.removeEventListener("mouseleave",i,!0)})),u.addEventListener("click",r,!0),this.unlisteners.push(()=>{u.removeEventListener("click",r,!0)}),u.addEventListener("keyup",o,!0),this.unlisteners.push(()=>{u.removeEventListener("keyup",o,!0)}),u.addEventListener("mousemove",a,!0),this.unlisteners.push(()=>{u.removeEventListener("mousemove",a,!0)}),u.addEventListener("mouseover",a,!0),this.unlisteners.push(()=>{u.removeEventListener("mouseover",a,!0)})),this.setupIframesListeners(e,c)}catch(u){H.debug(u,"Error while setting up listeners for iframes, probably because the iframe is CROSS_DOMAIN")}})}getIframes(e){const t=[],n=e.evaluate("//frame",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),i=e.evaluate("//iframe",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let r=0;r<n.snapshotLength;r++)t.push(n.snapshotItem(r));for(let r=0;r<i.snapshotLength;r++)t.push(i.snapshotItem(r));return t.filter(Td).map(r=>({iframe:r,childFrames:this.getIframes(r.contentDocument)}))}createSelectorsForMouseEvent(e){if(e==null)throw new Error("No event provided");const t=jn(e);if(t==null)throw new Error("No target found");const n=this.selectorsFor(t),i=this.getTrailForMouseEvent(e).map(l=>this.selectorsFor(l)),r=this.contextEnabled?xs.around(t,this):void 0,o=this.validationEnabled?this.collectValidationData(t):void 0;let a=mn.forElement(t);return this.textsEnabled||(a=new mn(a.elementType,a.id,a.classList,a.attributesList,[])),{selectors:n,iframes:this.dynamicIframes?[]:i,pathElement:a,contextElements:r,validationData:o,element:t}}shouldCreatePath(e,t){return e==null?!1:e===t||t===document.body||t?.id!=null&&t.id!==""||!_d(t?.tagName)}selectorsFor(e){const t=new Set,n=[];let i=e;const r=e.ownerDocument.documentElement;do n.unshift(i),this.shouldCreatePath(e,i)&&this.stringSelectorsFor(n,e).forEach(a=>t.add(new Ie(a))),window.ShadowRoot!=null&&i.parentNode instanceof window.ShadowRoot&&i.parentNode.host!=null?i=i.parentNode.host:i=i!=null?i.parentElement:null;while(i!==r&&i!=null&&i.parentElement!==r);return Array.from(t.values())}stringSelectorsFor(e,t){const n=[];if(e instanceof Array)return e.reduce((l,c)=>{const u=this.stringSelectorsFor(c,t);return l.length===0&&u.length>0?l.concat(u):u.length>0?l.reduce((f,E)=>(u.forEach(T=>{E.includes(":nth-child")?f.push(E):f.push(`${E} > ${T}`)}),f),[]):l},[]);const i=e.tagName.toLowerCase(),r=this.pathExtensions.find(l=>i===l.tagName.toLowerCase());let o=e.tagName.toLowerCase();if(e.id&&fn(e.id)&&this.useIdSelector){const l=fi(e);l!=null&&(o+=l)}if(typeof e.className=="string"&&e.className.trim()&&this.useCssClassesInPath&&(o+=ld(e,this.cssClassesBlacklist)),i==="input"){const l=e.getAttribute("type");l!==null&&(o+=`[type=${l}]`)}if(n.push(o),["iframe","frame","frameset"].includes(e.tagName.toLowerCase())&&e.getAttribute("name")&&(r==null||r.attributes.findIndex(l=>l.name.toLowerCase()==="name"&&!l.include)<0)&&n.push(`${o}[name="${e.getAttribute("name")}"]`),["iframe","frame","frameset"].includes(e.tagName.toLowerCase())&&e.getAttribute("src")&&(r==null||r.attributes.findIndex(l=>l.name.toLowerCase()==="src"&&!l.include)<0)){const l=this.iframesSettings.src;l?Ed(e,l).forEach(c=>n.push(c)):n.push(`${o}[src="${e.getAttribute("src")}"]`)}if(o==="img"&&(r==null||r.attributes.findIndex(l=>l.name.toLowerCase()==="src"&&!l.include)<0)&&n.push(`${o}[src="${e.getAttribute("src")}"]`),this.textsEnabled){const l=ma(e)?.split(`
`)[0].split("").reduce((c,u,f)=>c+=e.textContent?.trim()[f]??u,"")??"";l.length<=60&&l.trim().length>0&&(this.limitTextSelectorToTarget&&e===t?n.push(o+':contains("'+l.trim().replace(/"/g,'\\"')+'")'):this.limitTextSelectorToTarget||n.push(o+':contains("'+l.trim().replace(/"/g,'\\"')+'")'))}return["svg","rect","circle","ellipse","line","polyline","polygon","path","image"].includes(o)&&["x","y","d","width","height","rx","ry","cx","cy","x1","y1","x2","y2"].forEach(l=>{const c=e.getAttribute(l);c!=null&&n.push(`${o}[${l}="${c.replace(/"/g,'\\"')}"]`)}),r?.attributes.filter(l=>l.include).forEach(l=>{const c=e.getAttribute(l.name);c!==null&&n.push(`${o}[${l.name}="${c.replace(/"/g,'\\"')}"]`)}),t?.parentElement===e&&n.push(o+` :nth-child(${Array.from(e.childNodes).indexOf(t)})`),n}collectValidationData(e){return this.validators.reduce((t,n)=>({...t,...n.collect(e)}),{})}createHighlighter(){return this.highlighter!=null?this.highlighter:(this.highlighter=document.createElement("div"),this.highlighter.setAttribute("id","lemon-highlighter"),this.highlighter.setAttribute("style",this.highlighterStyles),document.body.tagName.toLowerCase()==="frameset"?document.firstElementChild?.appendChild(this.highlighter):document.body.appendChild(this.highlighter),this.highlighter)}removeHighlighter(){try{return this.highlighter==null||(document.body.tagName.toLowerCase()==="frameset"?document.firstElementChild?.removeChild(this.highlighter):document.body.removeChild(this.highlighter),this.highlighter=null),null}catch{return null}}hideHighlighter(){return this.highlighter==null||(this.highlighter.style.display="none"),null}getTrailForMouseEvent(e,t){if(e==null)return[];const n=jn(e),i=t??this.iframes,r=i.find(({iframe:o})=>o.contentDocument===n?.ownerDocument);if(r!=null)return[r.iframe,...ba(e)];for(let o=0;o<i.length;o++){const a=this.getTrailForMouseEvent(e,i[o].childFrames);if(a.length>0)return[i[o].iframe,...a]}return ba(e)}onKeyUp(e){e.key==="Escape"&&this.stop("cancel")}onClick(e){if(e.altKey||e.metaKey||e.ctrlKey||!e.isTrusted)return null;e.preventDefault(),e.stopPropagation();try{this.event?.trigger(fe.SELECT,this.createSelectorsForMouseEvent(e))}catch(t){this.event?.trigger(fe.ERROR,t)}return this.stop("selected"),null}onMouseEvent(e){const t=jn(e);if(t==null){H.trace("onMouseEvent: target is null");return}if(t===document.documentElement||t===document.body||t===this.highlighter){H.trace("Target can't be documentElement, body or higlighter");return}fe.lastHoveredEvent=e;const n=t.getBoundingClientRect();let{top:i,left:r,width:o,height:a}=n;this.getTrailForMouseEvent(e).filter(l=>Xe(l)).forEach(l=>{const c=l.getBoundingClientRect(),u=window.getComputedStyle(l),f=(isNaN(parseInt(u.borderTopWidth))?0:parseInt(u.borderTopWidth))+(isNaN(parseInt(u.paddingTop))?0:parseInt(u.paddingTop)),E=(isNaN(parseInt(u.borderLeftWidth))?0:parseInt(u.borderLeftWidth))+(isNaN(parseInt(u.paddingLeft))?0:parseInt(u.paddingLeft));i+=c.top+f,r+=c.left+E}),this.highlighter!=null&&(this.highlighter.style.display="block",this.highlighter.style.pointerEvents="none",this.highlighter.style.left=`${r}px`,this.highlighter.style.top=`${i}px`,this.highlighter.style.width=`${o}px`,this.highlighter.style.height=`${a}px`),this.event?.trigger(fe.HOVER,t)}};fe.START="start",fe.STOP="stop",fe.SELECT="select",fe.HOVER="hover",fe.ERROR="error",fe.active=null,fe.defaultOptions={textsEnabled:!0,limitTextSelectorToTarget:!0,contextEnabled:!1,contextWidth:3,validationEnabled:!0,iframesSettings:{},validators:[],pathExtensions:[],eventsToBlock:[],cssClassesBlacklist:[],useCssClassesInPath:!0,useIdSelector:!0,dynamicIframes:!1},fe.lastHoveredEvent=null;let Yt=fe;function _d(s){try{if(s==null||customElements.get(s.toLowerCase())!=null)return!1;const e=document.createElement(s),t=e.toString();return e.remove(),t!=="[object HTMLUnknownElement]"}catch{return!1}}function Td(s){let e=!1;try{e=s?.contentDocument??!1}catch(t){H.error(t)}return!!e}function jn(s){const t=s.composedPath()[0]??s.target;return va(t)?xd(t):null}function xd(s){return Sd(s)?s:null}function va(s){return s!=null&&"nodeType"in s}function Sd(s){return s!=null&&typeof s=="object"&&"nodeType"in s&&s.nodeType===Node.ELEMENT_NODE}function ba(s){return jn(s)?.getRootNode().nodeType!==Node.DOCUMENT_FRAGMENT_NODE?[]:s.composedPath().reduce((t,n)=>(va(n)&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.push(n.host),t),[]).reverse()}const Cd=p.object({strategy:p.enum(["regular","xpath"]).optional(),enableCrossDomain:p.boolean().optional(),context:p.object({enabled:p.boolean().optional(),levels:p.number().optional(),bonus:p.unknown().optional()}).optional(),dynamicIframes:p.boolean().optional(),trustSpecificity:p.boolean().optional(),postMessagesAdditionalProperties:p.array(p.unknown()).catch([]),validation:p.object({enabled:p.boolean().optional(),threshold:p.number().optional(),mode:p.enum(["regular","xpath","dynamic"]).optional(),validators:p.array(p.object({enabled:p.boolean(),name:p.enum(["nth","position","dimensions","attributes"]),weight:p.number(),options:p.record(p.union([p.string(),p.unknown()])).catch({})})).optional()}).optional(),cssClassesBlacklist:p.array(p.string()).catch([]),eventsToBlock:p.array(p.string()).catch([]),pathExtensions:p.array(p.string()).catch([]),iframesSettings:p.record(p.union([p.string(),p.unknown()])).optional(),useTexts:p.boolean().optional(),projectRigidity:p.number().optional(),useCssClassesInPath:p.boolean().optional(),modifiers:p.array(p.object({enabled:p.boolean(),name:p.literal("keywords"),options:p.object({words:p.array(p.string()).optional()})})).optional(),useIdSelector:p.boolean().optional()}).passthrough();class Id{constructor(e=1){this.name="nth",this._rate=.1,this.weight=e}async validate(e,t,n){if(typeof t.nthPosition!="number"||!(e.element instanceof wt))return;const i=e.element.dom,r=i.parentElement;if(r==null)return;const o=r.children;let a=0,l=null;do l=o[a],a++;while(l!==i&&a<o.length);if(l!==i)return;const c=Math.abs(t.nthPosition-a),u=1+n*(1-c*this._rate);u>1&&e.score.multiply((c===0?u*1.5:u)*this.weight,"VALIDATOR",{validator:this.name,originalPosition:t.nthPosition,matchedPosition:a})}collect(e){return{nthPosition:Rd(e)}}}function Rd(s){const e=s.parentElement;if(e==null)return null;const t=e.children;for(let n=0;n<t.length;n++)if(t[n]===s)return n+1;return null}class Ad{constructor(e=1){this.name="position",this.weight=1,this._range=40,this.weight=Number(e)??1}async validate(e,t,n){if(t.position==null||!(e.element instanceof wt))return;const i=e.element.dom,{top:r,left:o}=wa(i),a=t.position,l=Math.sqrt(Math.pow(Math.abs(r-a.top),2)+Math.pow(Math.abs(o-a.left),2)),c=1+n*(this._range/(this._range+l));e.score.multiply(c*this.weight,"VALIDATOR",{validator:this.name,distance:l})}collect(e){const{top:t,left:n}=wa(e),i=e.ownerDocument,r=i.body.clientWidth-n,o=i.body.clientHeight-t;return{position:{top:t,left:n,right:r,bottom:o}}}}function wa(s){let e=s,t=0,n=0;for(;e instanceof HTMLElement&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,n+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{top:n,left:t}}class Od{constructor(e=1){this.name="dimensions",this.weight=1,this._margin=.2,this.weight=Number(e)??1}async validate(e,t,n){if(typeof t.width!="number"||typeof t.height!="number"||t.width<=0||t.height<=0)return;const r=await e.element.getRect(),o=t.width,a=t.height;let l=1;if(r.width>=o*(1-this._margin)&&r.width<=o*(1+this._margin)){const c=1-Math.abs(o-r.width)/(o*this._margin);l+=n/2*c}if(r.height>=a*(1-this._margin)&&r.height<=a*(1+this._margin)){const c=1-Math.abs(a-r.height)/(a*this._margin);l+=n/2*c}l>1&&e.score.multiply(l*this.weight,"VALIDATOR",{validator:this.name,dimensions:{original:{width:o,height:a},element:{width:r.width,height:r.height}}})}collect(e){const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}}class Ld{constructor(e=1){this.name="attributes",this.weight=e}async validate(e,t){if(t?.attributes==null)return;const n=await e.element.getAttributes(),i=1.05;for(const r in t.attributes){const o=t.attributes[r];n?.[r]!=null&&(Array.isArray(o)&&o.includes(n[r])||!Array.isArray(o)&&n[r]===o)&&e.score.multiply(i*this.weight,"VALIDATOR",{validator:this.name,attribute:r,values:o})}}collect(e){return{attributes:Md(e)}}}function Md(s,e=["id","class"]){return Array.from(s.attributes).slice(0,7).reduce((t,n)=>e.indexOf(n.name.toLowerCase())>0||n.value.length>500?t:{...t,[n.name]:n.value},{})}function Nd(s,{nthTagIndex:e,tagName:t,targetPositionComparedToPivot:n}){switch(n){case"after":return kd(s,{nthTagIndex:e,tagName:t});default:throw Error("Unavailable targetPositionComparedToPivot")}}function kd(s,{tagName:e,nthTagIndex:t}){return`${s} ~ ${e.toLowerCase()}:nth-of-type(${t})`}function Ea(s){return s.nodeType===Node.ELEMENT_NODE}async function _a(s){return await Promise.all(s.map(async e=>{try{return{status:"fulfilled",value:await e}}catch(t){return{status:"rejected",reason:t}}}))}async function Ta(s,{signal:e,retryOnError:t=!1,shouldRetry:n=()=>!1}={}){let i=!1;e?.addEventListener("abort",()=>{i=!0});let r=null,o=0;for(;(r===null||n(r))&&!i;){try{r=await s()}catch(c){if(!t)throw c}(r===null||n(r))&&await l(a(o++))}return r;function a(c){return Math.min(1e3,c*100)}async function l(c){return new Promise(u=>setTimeout(u,c))}}let xa=(dt=class{constructor(e){this.contextEnabled=!1,this.contextBonus=.3,this.modifiers=[],this.validationEnabled=!0,this.validators=[],this.validationThreshold=dt.defaultOptions.validationThreshold,this.validationMode=dt.defaultOptions.validationMode,this.pathsType="regular",this.dynamicIframes=!1,this.trustSpecificity=!1,this.projectRigidity=dt.defaultOptions.projectRigidity,this.CrossResolver=gd;const t={...dt.defaultOptions,...e};t.pathsType!=null&&this.setPathsType(t.pathsType),this.setContextEnabled(t.contextEnabled),this.setContextBonus(t.contextBonus),this.setValidationEnabled(t.validationEnabled),this.setValidationMode(t.validationMode),t.validationThreshold!=null&&this.setValidationThreshold(t.validationThreshold),this.setProjectRigidity(t.projectRigidity),this.dynamicIframes=t.dynamicIframes,this.trustSpecificity=t.trustSpecificity,t.validators.forEach(n=>{this.addValidator(n)}),t.modifiers.forEach(n=>{this.addModifier(n)})}setProjectRigidity(e){this.projectRigidity=typeof e>"u"||e===null?dt.defaultOptions.projectRigidity:+e}setPathsType(e){this.pathsType=e}setContextEnabled(e){this.contextEnabled=e}setContextBonus(e){this.contextBonus=e}setValidationEnabled(e){this.validationEnabled=e}setValidationThreshold(e){e>=0&&e<=1&&(this.validationThreshold=e)}setValidationMode(e){e!==void 0&&(this.validationMode=e)}addValidator(e){this.validators.push(e)}addModifier(e){this.modifiers.push(e)}setCrossResolver(e){this.CrossResolver=e}getOptions(){return{pathsType:this.pathsType,contextEnabled:this.contextEnabled,contextBonus:this.contextBonus,dynamicIframes:this.dynamicIframes,trustSpecificity:this.trustSpecificity,validationEnabled:this.validationEnabled,validationThreshold:this.validationThreshold,validationMode:this.validationMode,validators:this.validators,modifiers:this.modifiers,projectRigidity:this.projectRigidity}}async find(e,t,n,i,r){let o=[t];this.dynamicIframes&&(o=this.getAllIframesSelectors(this.getIframesElement(document)),o.unshift([]));const a=o.map(async l=>this.search(e,l,n,i,r));return _a(a).then(l=>{const c=l.reduce((T,k)=>(k.status==="fulfilled"&&k.value.matches.length>0&&T.push(k.value),T),[]);if(c.length===0)return{match:null,iframes:[]};const{matches:u,iframes:f}=c[0],E=u.sort(br);return{match:E.length>0?E[0]:null,iframes:f}})}async findAll(e,t=[],n,i,r,o=!1,a=null){let l=[t];this.dynamicIframes&&(l=this.getAllIframesSelectors(this.getIframesElement(document)),l.unshift([]));const c=l.map(async u=>this.search(e,u,n,i,r,null,o,a));return Promise.all(c).then(u=>u.filter(f=>f.matches.length>0)).then(u=>{if(u.length===0)return{matches:[],iframes:[]};const{matches:f,iframes:E}=u[0];return{matches:f.sort(br),iframes:E}})}async awaitAll(e,t,n,i,r,o){const a={selectors:e,iframes:t,context:n,rigidity:i,validationData:r};return Ta(async()=>{const l=await this.findAll(a.selectors,a.iframes,a.context,a.rigidity,a.validationData);return l.matches.length===0?null:l},{signal:o}).then(l=>{if(l!=null)return l;throw new Error("Unable to find element")}).catch(l=>{throw new Error(`Unable to find element: ${l instanceof Error?l.message:"Unknown error"}`)})}async awaitAllWithJSON(e,{validate:t,signal:n}={}){return new Promise((i,r)=>{let o=[];try{o=this.buildParametersFromJSON(e)}catch(v){r(v);return}const[a,l,c,u,f,E,T,k]=o,y={selectors:a,iframes:l,context:c,rigidity:u,validationData:f,pathElement:E,isPivot:T,pivotOptions:k};Ta(async()=>{const v=await this.findAll(y.selectors,y.iframes??void 0,y.context??void 0,y.rigidity??void 0,y.validationData??void 0,T??void 0,k);return v.matches.length===0||!(t===void 0?!0:await t(v))?null:v},{signal:n,retryOnError:!0}).then(v=>{v!=null?i(v):i({matches:[],iframes:[]})}).catch(v=>{r(new Error(`Unable to find element: ${v instanceof Error?v.message:"Unknown error"}`))})})}async search(e,t,n,i,r,o,a=!1,l=null){return this.trustSpecificity&&e.sort((c,u)=>u.path.length-c.path.length),this.findTrail(t).then(async c=>new Promise((u,f)=>{const E=[];t!=null&&t.length>0&&c.length===0&&f(new Error("No matching iframe found."));const T=this.getDocumentRoot(c,o??void 0),[k,y]=T;if(y)this.CrossResolver(this,e,t?.slice(c.length)??[],n??void 0,i??void 0,r??void 0,c.length).then(v=>{u({matches:v.map(w=>(c.filter(Xe).forEach(_=>{const A=_.getBoundingClientRect(),L=window.getComputedStyle(_);w.boxing.top+=A.top+(isNaN(parseInt(L.borderTopWidth))?0:parseInt(L.borderTopWidth))+(isNaN(parseInt(L.paddingTop))?0:parseInt(L.paddingTop)),w.boxing.bottom+=A.top,w.boxing.left+=A.left+(isNaN(parseInt(L.borderLeftWidth))?0:parseInt(L.borderLeftWidth))+(isNaN(parseInt(L.paddingLeft))?0:parseInt(L.paddingLeft)),w.boxing.right+=A.left}),new Vs(new Ts(w.resultId,w.crossId,w.boxing,w.DOM,c),w.score))),iframes:c})}).catch(f);else{const v=e.reduce((L,B)=>((B.path.match(/#[a-zA-Z0-9-_]+/g)?.map(Q=>Q.slice(1))??[]).every(Q=>k?.querySelector(`#${Q}`)!=null)&&L.push(B),L),[])??[],w=v.length>0?v:e;let _=0;const A=w.length;e:for(;_<A;){let L=w[_++];a&&l!=null&&(L=new Ie(Nd(L.path,l)));const B=Ie.qualityOf(L,this.modifiers),N=this.findElements(L,k,c);let Q=0;for(;Q<N.length;){const P=N[Q++],pe=E.findIndex(({element:F})=>F instanceof wt&&P.element instanceof wt&&F.dom===P.element.dom);if(pe>-1){if(E[pe].score.incrementWithScore(B,"MATCH",{matchScore:B}),this.trustSpecificity)break e}else a?(P.score.incrementWithScore(B,"MATCH",{matchScore:B}),E.push(P)):this.respectsRigidity(P,i??null)&&(P.score.incrementWithScore(B,"MATCH",{matchScore:B}),E.push(P))}}if(this.contextEnabled&&n!=null&&E.forEach(L=>{if(!(L.element instanceof wt))throw new Error("Match element is not a DOMElement");const B=n.scoreFor(L.element.dom,this.findElements);L.score.multiplyWithScore(B,"CONTEXT",{contextScore:B})}),this.validationEnabled&&r!=null&&E.length>=2){this.applyValidators(E,r).then(L=>{u({matches:L,iframes:c})});return}u({matches:E,iframes:c})}}))}buildParametersFromJSON(e){const t=typeof e=="string"?JSON.parse(e):null;let n=[],i=null,r=null,o=null,a=null,l=null,c=!1,u=null;return n=t?.paths?.reduce((f,E)=>E?.active?[...f,new Ie(E?.value??null)]:f,[])??[],t?.pathElement&&(i=new mn(t?.pathElement?.elementType??"div",t?.pathElement?.id??"",t?.pathElement?.classList?t?.pathElement?.classList.filter(({active:f})=>f).map(({value:f})=>f):[],t?.pathElement?.attributesList??[],t?.pathElement?.texts?t?.pathElement?.texts.filter(({active:f})=>f).map(({value:f})=>f):[]),n=[...n,...i.toStringPaths().map(f=>new Ie(f))],n=n.filter((f,E)=>E===n.findIndex(T=>T.path===f.path))),t?.iframes!=null&&(o=t.iframes.map(f=>f.reduce((E,T)=>T.active==null?E:[...E,new Ie(T.value)],[]))),this.contextEnabled&&(r=new xs((t?.contextElements??[]).map(f=>{switch(f.proximity){case pi.DYNAMIC:return{selector:new Ie(f.path),proximity:f.proximity,level:f.level};default:return{selector:new Ie(f.path),proximity:f.proximity}}}),this.contextBonus)),a={rigidity:t?.rigidity==null||Number.isNaN(t.rigidity)?this.projectRigidity:typeof t.rigidity=="string"?parseInt(t.rigidity,10):t.rigidity,pathElement:i},this.validationEnabled&&t?.validationData!=null&&(l=t.validationData),Object.prototype.hasOwnProperty.call(t,"isPivot")&&t.isPivot===!0&&(c=!0,Object.prototype.hasOwnProperty.call(t,"pivotOptions")&&typeof t.pivotOptions=="object"&&(u=t.pivotOptions)),[n,o,r,a,l,i,c,u]}async findTrail(e=[],t=[]){return new Promise((n,i)=>{if(e==null||e.length===0){n(t);return}const r=t.length>0?t[t.length-1]:null,o=r!=null?Sa(r):null;if(r!=null&&o==null){n(t);return}this.search(e[0],null,null,null,null,o).then(({matches:a})=>a.filter(l=>l.element instanceof wt)).then(async a=>{if(a.length===0)throw new Error("Failed finding iframes (no matches).");const l=await Pd(a);if(l==null)throw new Error("Failed finding iframes (no visible iframe).");const c=(l?.element).dom;t.push(c),this.findTrail(e.slice(1),t).then(n).catch(i)}).catch(a=>{H.error(a),n([])})})}getDocumentRoot(e,t){let n=!1,i=t??document.body;const r=e.length>0?e[e.length-1]:null;try{const o=r!=null?Sa(r):null;if(o==null&&Xe(r))return[null,!0];if(o!=null&&(i=o),Xe(r)&&r?.contentDocument?.readyState==="loading"){const a=Dd(window.location.origin),l=$d(r.src)??a;a!==l&&(n=!0)}}catch(o){H.debug(o,"Error while getting document root, setting isCross to true."),n=!0}return[i,n]}selectorIsXPath(e){return e.path.substring(0,2)==="//"}selectorContainsText(e){return e.path.includes(":contains")}findElements(e,t,n=[]){try{const i=this.selectorIsXPath(e);if((this.pathsType==="xpath"||i)&&"XPathResult"in window){const r=t instanceof Document?t:t?.ownerDocument??document,o=i?e.path:e.xPath,a=r?.evaluate(o,t??document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),l=[];for(let c=0;c<(a?.snapshotLength??0);c++){const u=a?.snapshotItem(c);u!=null&&Ea(u)&&l.push(new Vs(new wt(u)))}return l}else{const r=t??document;return(this.selectorContainsText(e)?Xt(e.path,r):Array.from(r.querySelectorAll(e.path))).reduce((a,l)=>(Ea(l)&&a.push(new Vs(new wt(l,n))),a),[])}}catch(i){return H.debug(i,"Error while finding elements, returning an empty array"),[]}}respectsRigidity(e,t){if(t?.rigidity==null)return!0;if(e instanceof Vs){const c=e;return c.element instanceof wt?this.respectsRigidity(c.element.dom,t):!0}const n=e,{rigidity:i,pathElement:r}=t,o=(r?.classList.length??0)+(r?.attributesList.length??0)+(r?.id!=null&&r?.id!==""?1:0)+(r?.texts!=null&&r?.texts.length>0?1:0);if(o<=0)return!0;const a=1/o;let l=0;if(r?.id!=null&&n.id===r?.id&&(l+=a),r?.texts!=null&&n instanceof HTMLElement&&n.innerText!=null){const c=n.innerText.toLowerCase();for(let u=0;u<(r?.texts.length??0);u++){const f=r?.texts[u].trim().toLowerCase();if(c.includes(f)){l+=a;break}}}return r?.classList.forEach(c=>{n.classList.contains(c)&&(l+=a)}),r?.attributesList.forEach(c=>{n.getAttribute(c)!=null&&(l+=a)}),l>=i}async applyValidators(e,t){const n=[];let i=e[0].score.value,r=e[0],o=0;do n.push(r),this.validationMode==="dynamic"&&(i=r.score.value),r=e[++o];while(r!=null&&i===r.score.value);return n.length<2?e:(await Promise.all(this.validators.map(async a=>await Promise.all(n.map(async l=>{await a.validate(l,t,this.validationThreshold)})))),e.sort(br))}getIframesElement(e){const t=[],n=e.evaluate("//frame",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),i=e.evaluate("//iframe",e,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let r=0;r<n.snapshotLength;r++){const o=n.snapshotItem(r);o?.nodeName.toLowerCase()==="frame"&&t.push(o)}for(let r=0;r<i.snapshotLength;r++){const o=i.snapshotItem(r);o?.nodeName.toLowerCase()==="iframe"&&t.push(o)}return t.reduce((r,o)=>((o instanceof HTMLIFrameElement||o instanceof HTMLFrameElement)&&r.push(o),r),[]).map(r=>{let o=null;try{o=r.contentDocument}catch(a){H.error(a)}return{iframe:r,childFrames:o!=null?this.getIframesElement(o):[]}})}getAllIframesSelectors(e){const t=new Yt({}),n=[];return e.forEach(i=>{const r=t.selectorsFor(i.iframe);n.push([r]);const o=this.getAllIframesSelectors(i.childFrames);o.length>0&&o.forEach(a=>{n.push([r,...a])})}),n}},dt.defaultOptions={contextEnabled:!1,contextBonus:.3,validationEnabled:!0,validationThreshold:.1,validationMode:"regular",dynamicIframes:!1,trustSpecificity:!1,pathsType:"regular",validators:[],modifiers:[],projectRigidity:.65},dt);function br(s,e){return s.score.value===e.score.value?0:s.score.value>e.score.value?-1:1}async function Pd(s){let e=s[0];for(const t of s)t.score.value>e.score.value&&await t.element.safeIsRendered()&&(e=t);return e}const Dd=s=>{const e=s.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?]+)/);return e!=null&&e.length>1?e[1]:null},$d=s=>{const e=s.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?]+)/);return s!=="about:blank"&&e!=null&&e.length>1?e[1]:null};function Bd(s){return Xe(s)?s.contentDocument?.body??null:null}function Fd(s){return s?.shadowRoot??null}function Sa(s){return Bd(s)??Fd(s)}class zd{constructor(e=[]){this.name="keywords",this._words=e}calc(e){const t=typeof e=="string"?e:e.path;return this._words.reduce((n,i)=>t.includes(i)?n+.2:n,0)}}const Vd={strategy:"regular",useTexts:!0,enableCrossDomain:!0,pathExtensions:[],eventsToBlock:[],cssClassesBlacklist:[],useCssClassesInPath:!0,useIdSelector:!0,projectRigidity:.65,modifiers:[],postMessagesAdditionalProperties:[],iframesSettings:{},dynamicIframes:!1,trustSpecificity:!1,validation:{enabled:!0,threshold:.1,mode:"regular",validators:[{name:"nth",enabled:!0,weight:1,options:{}},{name:"dimensions",enabled:!0,weight:1,options:{}},{name:"position",enabled:!0,weight:1,options:{}},{name:"attributes",enabled:!0,weight:1,options:{}}]},context:{enabled:!1,levels:3,bonus:.3}};Cd.parse(Vd);class wr{constructor(e=.55,t=-.6){this.name="generated",this.threshold=e,this.penalty=t}static isGenerated(e,t=.55){/^#(.*)/.test(e)?e=e.replace(/^#(.*)$/,"$1"):/^\.(.*)/.test(e)?e=e.replace(/^\.(.*)/,"$1"):/^\[[a-zA-Z-]+=["'](.*)["']\]$/.test(e)?e=e.replace(/^\[[a-zA-Z-]+=["'](.*)["']\]$/,"$1"):/^:[a-zA-Z-].*\(["'](.*)["']\)$/.test(e)&&(e=e.replace(/^:[a-zA-Z-].*\(["'](.*)["']\)$/,"$1"));const n=e.split("").reduce((u,f)=>/[a-zA-Z]/.test(f)?u+1:u,0),r=e.split("").reduce((u,f)=>Wd(f)?u+1:u,0)/n,o=n/e.length,a=e.split("").reduce((u,f)=>/[a-zA-Z]/.test(f)&&f.toLowerCase()!==f?u+1:u,0)/(n===0?1:n),l=e.replace(/[^:_.]/g,"").length;return this.linear(.85,0,1-o)+this.linear(.5,0,r)+this.linear(.22,0,l/4)+this.linear(.3,0,-Math.abs(a-.5)+.5)+this.linear(.3,0,e.length>12?e.length-12:0)>t}calc(e){const t=typeof e=="string"?e:e.path;return wr.isGenerated(t,this.threshold)?this.penalty:0}static linear(e,t,n){return e*n+t}}function Wd(s){return/[aeiou]/.test(s.toLowerCase())}class Ud{constructor(e=-.25){this.name="nth",this._regex=/^:nth-child\(.*\)$/,this._penalty=e}calc(e,t){const n=typeof e=="string"?e:e.path;return t!=="pseudo"||!this._regex.test(n)?0:this._penalty}}function gn(s){let e="";return s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement?e=s.value:s instanceof HTMLSelectElement?e=s.selectedOptions?.[0]?.text??"":s instanceof HTMLElement&&(e=s.innerText??""),e.trim().split(`
`)[0].slice(0,255)}const Hd=[/data-dashlane.*/,"async","charset","checked","disabled","style"];class yn{constructor(e){this.element=e}get tagName(){return this.element.tagName.toLowerCase()}get isShadowRoot(){return this.element.shadowRoot!=null}get text(){return gn(this.element)}get parent(){if(this.element.parentElement!=null&&this.element.parentElement.tagName!=="BODY")return new yn(this.element.parentElement);const e=this.element.getRootNode();return e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?new yn(e.host):null}get position(){const e=Array.from(this.element.parentElement?.children??[]).indexOf(this.element);return e>=0?e:null}get siblings(){return Array.from(this.element.parentElement?.children??[]).filter(e=>["script","style","link","lemon"].some(t=>e.tagName.toLowerCase().startsWith(t))?!1:e!==this.element).map(e=>new yn(e))}get attributes(){return this.element.attributes.length>0?Array.from(this.element.attributes).filter(({name:t,value:n})=>e(t)?!1:n.length>0).reduce((t,n)=>[...t,{name:n.name,value:n.value,comparison:"equal",modifiedValue:null,ignored:!1}],[]):[];function e(t){return Hd.some(n=>typeof n=="string"?n===t:n.test(t))}}async json(e){return{tagName:this.tagName,attributes:this.attributes,text:this.text,...e!=null?{children:e}:{},position:this.position,manualCssPaths:[],siblings:this.siblings.map(t=>({tagName:t.tagName,attributes:t.attributes,text:t.text}))}}static async toJSON(e,t){let n=e,i=await n.json(t);for(;n.parent!=null;){const r=n;n=n.parent,i={...await n.json(),shadowRoot:n.isShadowRoot&&r.element.assignedSlot==null,children:i}}return i}}const jd=p.object({name:p.string(),value:p.string(),comparison:p.enum(["equal","contains"]),modifiedValue:p.string().nullable().default(null),ignored:p.boolean().default(!1)}),Ca=p.object({tagName:p.string(),attributes:p.array(jd),text:p.string()}),Ia=Ca.extend({manualTexts:p.array(p.string()).optional(),manualCssPaths:p.array(p.string()).default([]),position:p.union([p.number(),p.null()]),siblings:p.array(Ca),shadowRoot:p.boolean().optional()}).extend({children:p.lazy(()=>Ia.optional())});function Ra(s){const e=[];let t=s;for(;t;)t.text?.trim()&&e.push(t.text.trim()),t.manualTexts&&t.manualTexts.forEach(n=>{n?.trim()&&e.push(n.trim())}),t.siblings.forEach(n=>{n.text?.trim()&&e.push(n.text.trim())}),t=t.children;return e}class Zd{constructor(e){this.strategies=e}async findWithinSpecificDOM(e,t){const n=[];for(const i of this.strategies){const r=await i.findWithinSpecificDOM(e,t);if(n.push(...r.debugInformation),r.element!==null)return{element:r.element,debugInformation:n}}return{element:null,debugInformation:n}}}const Gd=["id","data-testid","data-cy","data-test","href","src","role",/data-.*/,"name","placeholder","title","alt","class"];function Aa(s){return s==null?Gd:s.length===0?[]:s.map(e=>{if(/[.*+?^${}()|[\]\\]/.test(e))try{return new RegExp(e)}catch{return e}return e})}function Oa(s,e){return e.findIndex(t=>typeof t=="string"&&t===s||t instanceof RegExp&&t.test(s))}function La(s){return(e,t)=>{const n=Oa(e.name,s),i=Oa(t.name,s);return n===i?0:n===-1?1:i===-1?-1:n-i}}function Ma(s){if(!s?.trim())return null;try{const e=new URL(s),n=e.hostname.split("."),i=n.length>=2?n.slice(-2).join("."):"",r=n.length>2?n.slice(0,-2).join("."):"",o=e.pathname.split("/").filter(l=>l.length>0),a=new Map;return e.searchParams.forEach((l,c)=>{a.set(c,l)}),{domain:i,subdomain:r,pathSegments:o,searchParams:a}}catch{return null}}function Na(s,e){const t=Ma(s),n=Ma(e);if(!t||!n)return 0;const i=qd(t.searchParams,n.searchParams),r=Kd(t.pathSegments,n.pathSegments),o=Xd(t.domain,n.domain),a=Yd(t.subdomain,n.subdomain),l={searchParams:.4,path:.3,domain:.2,subdomain:.1};return i*l.searchParams+r*l.path+o*l.domain+a*l.subdomain}function qd(s,e){if(s.size===0&&e.size===0)return 1;if(s.size===0||e.size===0)return 0;let t=0;return s.forEach((n,i)=>{e.get(i)===n&&t++}),t/s.size}function Kd(s,e){if(s.length===0&&e.length===0)return 1;if(s.length===0||e.length===0)return 0;let t=0;const n=Math.min(s.length,e.length);for(let i=0;i<n;i++)s[i]===e[i]&&t++;return t/s.length}function Xd(s,e){return!s&&!e?1:!s||!e?0:s===e?1:0}function Yd(s,e){return!s&&!e?1:!s||!e?0:s===e?1:0}function ka(s){return s==="src"||s==="href"}class mi{constructor(e,t){this.debugInformation=t,this.name=e}getWinners(e){const t=e.map(n=>({element:n,score:this.computeScore(n)})).sort(this.compareScore.bind(this)).filter((n,i,r)=>n.score===r[0].score);return this.debugInformation.push(`Score Strategy: ${this.name} | Winners: ${t.map(n=>`${n.element.tagName.toLowerCase()}#${n.element.id}.${Array.from(n.element.classList).join(".")} (score: ${n.score.toFixed(3)})`).join(", ")}`),t.map(n=>n.element)}}function Pa(s,e){return e.score-s.score}function Da(s,e){return s.score-e.score}function Jd(s){let e=s;for(;e.children!=null;)e=e.children;return e}class $a extends mi{constructor(e,t){super("URL similarity matching",t),this.json=e,this.debugInformation=t}computeScore(e){const n=Jd(this.json).attributes.find(a=>ka(a.name));if(!n)return 0;const i=e.getAttribute(n.name);if(!i)return 0;const r=n.modifiedValue??n.value;if(n.comparison==="contains")return i.includes(r)?1:0;const o=Na(r,i);return this.debugInformation.push(`URL similarity score for ${i}: ${o}`),o}compareScore(e,t){return Pa(e,t)}}function gi(s,e){return ht(s).attributes.filter(t=>!t.ignored).filter(t=>!Qd(t.name,e)).map(t=>({name:t.name,value:t.modifiedValue??t.value,comparison:t.comparison}))}function Qd(s,e){for(const t of e)if(t.includes("*")){if(new RegExp(t.replace("*",".*")).test(s))return!0}else if(t===s)return!0;return!1}function ht(s){let e=s;for(;e.children!=null;)e=e.children;return e}function yi(s){return s.comparison==="contains"?`[${s.name}*='${s.value.replace(/'/g,"\\'")}']`:s.name==="class"?`.${s.value.replace(/\./g,"\\.")}`:`[${s.name}='${s.value.replace(/'/g,"\\'")}']`}class Ba extends mi{constructor(e,t,n){super("the number of matching attributes",n),this.json=e,this.blacklist=t}computeScore(e){return gi(this.json,this.blacklist).reduce((i,r)=>i+n(r),0);function n(i){if(i.name==="class"){const o=i.value.split(/\s+/);return Array.from(e.classList).reduce((a,l)=>i.comparison==="contains"&&o.some(c=>c.includes(l))||o.some(c=>c===l)?a+1:a,0)}const r=e.getAttribute(i.name);return r==null?0:i.comparison==="contains"&&r.includes(i.value)||r===i.value?1:0}}compareScore(e,t){return Pa(e,t)}}class Fa extends mi{constructor(e,t){super("the position of the element in its parent",t),this.json=e}computeScore(e){return Math.abs(ht(this.json).position-Array.from(e.parentElement?.children??[]).indexOf(e))}compareScore(e,t){return Da(e,t)}}class za extends mi{constructor(e,t){super("the depth of the element in the DOM",t),this.json=e}computeScore(e){return Math.abs(n(this.json)-t(e));function t(i){let r=0,o=i;for(;o.parentElement!==document.body&&o.parentElement!==null;)r++,o=o.parentElement;return r}function n(i){let r=i,o=0;for(;r.children!=null;)r=r.children,o++;return o}}compareScore(e,t){return Da(e,t)}}const Va=p.object({attributes_blacklist:p.array(p.string()).default([]),attributes_ordering:p.array(p.string()).optional()}).default({attributes_blacklist:[]}),ef=p.object({settings:Va.optional(),ignoreInvisibleResults:p.boolean().default(!1)}).default({});class Ss{constructor(e){const t=ef.parse(e);this.attributesBlacklist=t.settings?.attributes_blacklist??[],this.attributesOrdering=Aa(t.settings?.attributes_ordering),this.ignoreInvisibleResults=t.ignoreInvisibleResults}findWithinSpecificDOM(e,t){let n=null;const i=["Strategy Beta"],r=gi(e,this.attributesBlacklist);if(r.length===0)return i.push("There is no attributes to try, either because there is no attribute or because all attributes are ignored, returning null"),{element:null,debugInformation:i};const o=r.map(a=>a.name==="class"?a.value.split(/\s+/).map(l=>({comparison:a.comparison,name:"class",value:l})).filter(l=>l.value.trim()!==""):a).flat().sort(La(this.attributesOrdering));do{const a=o.shift();if(a==null)break;i.push(`Trying selector: "${yi(a)}"`);let l=Xt(yi(a),t);if(i.push(`Found ${l.length} elements with that selector`),this.ignoreInvisibleResults){const c=l.length;l=l.filter(f=>ut(f));const u=l.length;i.push(`Filtered out ${c-u} invisible elements, ${u} remaining.`)}if(l.length===1){i.push("Found 1 element, returning it"),n=l[0];break}l.length>1&&(i.push(`Found ${l.length} elements, trying to elect a winner`),n=this.selectBestElement(l,e,i))}while(n==null&&o.length>0);return{element:n,debugInformation:i}}selectBestElement(e,t,n){const i=e.filter(a=>a.tagName.toLocaleLowerCase()===ht(t).tagName);if(n.push(`Found ${i.length} elements with the right tag name`),i.length===1)return i[0];let r=i;const o=[new $a(t,n),new Ba(t,this.attributesBlacklist,n),new za(t,n)];for(ht(t).position!==null&&o.push(new Fa(t,n));r.length>1&&o.length>0;){const a=o.shift();n.push(`Trying to elect the best element using ${a.name}`),r=a.getWinners(r)}return r.length===1?(n.push("Found the best element, returning it"),r[0]):(n.push(`There are still ${r.length} elements after trying to find the best one, returning null`),null)}}var Er={},Wa;function tf(){return Wa||(Wa=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.stringSimilarity=void 0;var e=function(t,n,i,r){if(i===void 0&&(i=2),r===void 0&&(r=!1),r||(t=t.toLowerCase(),n=n.toLowerCase()),t.length<i||n.length<i)return 0;for(var o=new Map,a=0;a<t.length-(i-1);a++){var l=t.substr(a,i);o.set(l,o.has(l)?o.get(l)+1:1)}for(var c=0,u=0;u<n.length-(i-1);u++){var f=n.substr(u,i),E=o.has(f)?o.get(f):0;E>0&&(o.set(f,E-1),c++)}return c*2/(t.length+n.length-(i-1)*2)};s.stringSimilarity=e,s.default=s.stringSimilarity})(Er)),Er}var nf=tf();const _r=[],Ua=[];function sf(s,e){if(s===e)return 0;const t=s;s.length>e.length&&(s=e,e=t);let n=s.length,i=e.length;for(;n>0&&s.charCodeAt(~-n)===e.charCodeAt(~-i);)n--,i--;let r=0;for(;r<n&&s.charCodeAt(r)===e.charCodeAt(r);)r++;if(n-=r,i-=r,n===0)return i;let o,a,l,c,u=0,f=0;for(;u<n;)Ua[u]=s.charCodeAt(r+u),_r[u]=++u;for(;f<i;)for(o=e.charCodeAt(r+f),l=f++,a=f,u=0;u<n;u++)c=o===Ua[u]?l:l+1,l=_r[u],a=_r[u]=l>a?c>a?a+1:c:c>l?l+1:c;return a}const vi=s=>s.toLowerCase().trim().replace(/\s+/g," ");function rf(s,e,t){const n=Math.abs(s.length-e.length);return s.length===e.length?{insertions:0,deletions:0,substitutions:t}:s.length<e.length?{insertions:n,deletions:0,substitutions:t-n}:{insertions:0,deletions:n,substitutions:t-n}}function of(s,e){const t=vi(s),n=vi(e);if(t===n)return 1;const i=sf(t,n),r=Math.max(t.length,n.length),o=1-i/r,a=nf.stringSimilarity(t,n),c=r<=10?.7:.4,u=1-c;let f=o*c+a*u;const E=t.split(" ").filter(v=>v.length>2),T=n.split(" ").filter(v=>v.length>2),k=E.length===1&&T.length===1,y=r<8;if(k&&y&&f<.75&&f>.3){const v=rf(t,n,i),w=v.insertions+v.deletions+v.substitutions,_=t.length===n.length;w===1&&!_||_&&w===2||(f*=.7)}return f}function af(s,e){const t=s.split(/\s+/).filter(l=>l.length>0),n=e.split(/\s+/).filter(l=>l.length>0),i=Math.abs(t.length-n.length),r=Math.abs(s.length-e.length),o=Math.max(s.length,e.length);if(i===0&&r===0)return 1;let a=1;if(i>=2){const l=Math.max(t.length,n.length),c=i/l;a*=Math.max(.85,1-c*.15)}if(i===1&&r>=6){const l=r/o;a*=Math.max(.1,1-l*.9)}return a}function Ha(s,e){let t=s.parentElement;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}function ja(s){let e=0,t=s;for(;t.parentElement;)e++,t=t.parentElement;return e}function lf(s){const e=new Map;s.forEach(n=>{const i=gn(n).trim();if(!i)return;const r=e.get(i);if(!r)e.set(i,n);else{const o=Ha(n,r),a=Ha(r,n);if(o)e.set(i,n);else if(!a){const l=ja(n),c=ja(r);l>c&&e.set(i,n)}}});const t={textToElement:e,originalCount:s.length,deduplicatedCount:e.size};return H.trace(`Deduplicated ${t.originalCount} elements to ${t.deduplicatedCount} unique texts`),t}function Za(s,e){const t=lf(s);return e&&e.push(`Deduplicated candidates: ${t.originalCount} elements -> ${t.deduplicatedCount} unique texts`),Array.from(t.textToElement.values())}async function cf(s){throw new Error("AIServiceHandler not initialized with service class")}async function uf(s,e,t=5e3){return new Promise((n,i)=>{const r=we.createChannel(),o=r.getPort1();o.start();let a=!1;const l=setTimeout(()=>{a||(a=!0,o.close(),i(new Error(`AI request timeout after ${t}ms`)))},t);o.addMessageListener(async f=>{if(!a){a=!0,clearTimeout(l),o.close();const E=f;E.error?i(new Error(E.error)):n(E.result)}});const c={type:Kt.AI_REQUEST,payload:{operation:s,params:e}},u=window.parent===window;H.trace(`Sending AI request: ${s} from ${u?"TOP FRAME":"IFRAME"}`,e),we.sendToCurrentFrame(c,r.getPort2())})}async function hf(s,e,t,n){const i={targetText:s,candidates:e,threshold:t,contextTexts:n};return window.parent===window?(H.trace("Calling AI handler directly (same-frame)",i),cf()):uf("findBestTextMatch",i)}function Tr(s,e,t){const n={attempt:"",result:"","no-match":""},i={attempt:`Attempting AI text matching in ${e} strategy with:`,result:`AI matching result in ${e}:`,"no-match":`No match found in ${e}:`};H.trace(`${n[s]} ${i[s]}`,t)}async function Ga(s,e,t,n="AI",i){const r=[],o=new Map;for(let a=0;a<s.length;a++){const l=s[a],c=gn(l);c&&c.trim()!==""&&(r.push(c.trim()),o.set(r.length-1,l))}if(r.length===0)return t.push("No text content found in candidate elements for AI matching"),null;try{Tr("attempt",n,{targetText:e,candidatesCount:r.length});const a=await hf(e,r,.3,i);if(Tr("result",n,a),a==null)return t.push("AI matching returned null result"),null;let l=null;for(let c=0;c<r.length;c++)if(r[c]===a.text){l=o.get(c)??null;break}return l==null?(t.push("AI matched text but element not found"),Tr("no-match",n,{targetText:e,message:`No element found for matched text "${a.text}"`}),null):(t.push(`AI Match found - Text: "${a.text}", Score: ${a.score.toFixed(4)}`),l)}catch(a){return a instanceof Error&&t.push(`AI matching failed: ${a.message}`),null}}const xr={weights:{text:.7,position:.3,refinements:{tag:.4,attributes:.3,siblings:.2,parent:.1}},thresholds:{minimum:.3,default:.5,highPosition:.8}},df=p.object({weights:p.object({text:p.number().min(0).max(1),position:p.number().min(0).max(1),refinements:p.object({tag:p.number().min(0).max(1),attributes:p.number().min(0).max(1),siblings:p.number().min(0).max(1),parent:p.number().min(0).max(1)})}),thresholds:p.object({minimum:p.number().min(0).max(1),default:p.number().min(0).max(1),highPosition:p.number().min(0).max(1)})}),ff=p.object({settings:df.optional(),ignoreInvisibleResults:p.boolean().default(!1),isAiServiceAvailable:p.boolean().default(!1),betaSettings:Va.optional()}).default({settings:xr,ignoreInvisibleResults:!1,isAiServiceAvailable:!1});class qa{constructor(e){const t=ff.parse(e);this.weights=t.settings?.weights??xr.weights,this.thresholds=t.settings?.thresholds??xr.thresholds,this.ignoreInvisibleResults=t.ignoreInvisibleResults,this.shouldUseAiTextMatching=t.isAiServiceAvailable,this.betaSettings=t.betaSettings}async findWithinSpecificDOM(e,t=document){const n=["Strategy Gamma",`Weights: text=${this.weights.text}, position=${this.weights.position}`,`Refinements: tag=${this.weights.refinements.tag}, attributes=${this.weights.refinements.attributes}, siblings=${this.weights.refinements.siblings}, parent=${this.weights.refinements.parent}`,`Thresholds: minimum=${this.thresholds.minimum}, default=${this.thresholds.default}, highPosition=${this.thresholds.highPosition}`];H.trace("Strategy Gamma - Configuration",{weights:this.weights,thresholds:this.thresholds});const i=this.getDeepestElement(e);if(i.manualTexts!=null&&i.manualTexts.length<=0||i.manualTexts==null&&i.text.length<=0)return n.push("No text content available, falling back to Beta strategy"),new Ss({settings:this.betaSettings}).findWithinSpecificDOM(e,t);const r=this.buildPositionPath(e),o=i.manualTexts?.join(", ")??i.text;n.push(`Target text: ${o}`,`Position path: ${JSON.stringify(r)}`),H.trace("Strategy Gamma - Target",{targetText:o,positionPath:r});const a=await this.findMatches(t,i,r,n,e);let l=a;return this.ignoreInvisibleResults&&(l=a.filter(c=>ut(c.element)),n.push(`ignoreInvisibleResults is enabled, filtering out ${a.length-l.length} invisible matches`)),{element:l[0]?.element??null,debugInformation:n}}async findMatches(e,t,n,i,r){if(t.manualTexts!=null){const o=t.manualTexts.map(async c=>this.findMatchesForText(e,t,c,n,i,r));return(await Promise.all(o)).flat().sort((c,u)=>u.similarity-c.similarity)}return this.findMatchesForText(e,t,t.text,n,i,r)}async findMatchesForText(e,t,n,i,r,o){const l=Array.from(e.querySelectorAll("*")).map(async f=>{const E=new yn(f);if(!E.text)return null;const T=of(E.text,n);if(T<this.thresholds.minimum)return null;const k=this.getPositionMatch(E,i),y=this.calculatePrimaryScore(T,k);if(y<this.getThreshold(k))return null;const v=this.calculateRefinementScore(E,t),w=y*.8+v*.2,_=af(vi(E.text),vi(n)),A=w*_,L=this.getThreshold(k);return A<L?null:(r.push(`Match found - Text: ${E.text}, Text Similarity: ${T.toFixed(4)}, Position: ${k.toFixed(4)}, Primary Score: ${y.toFixed(4)}, Refinement Score: ${v.toFixed(4)}, Word Penalty: ${_.toFixed(4)}, Threshold: ${L.toFixed(4)}, Final Score: ${A.toFixed(4)}`),H.trace("Strategy Gamma - Match found",{text:E.text,textScore:T,positionScore:k,primaryScore:y,refinementScore:v,wordCountPenalty:_,threshold:L,finalScore:A}),{element:f,similarity:A})}),u=(await _a(l)).filter(f=>f.status==="fulfilled").map(f=>f.value).filter(f=>f!==null).sort((f,E)=>E.similarity-f.similarity);return u.length>0?u:this.shouldUseAiTextMatching?(r.push("No traditional matches found, trying AI semantic matching"),this.findMatchesWithAI(e,t,n,i,r,o)):(r.push("AI text matching not available"),[])}async findMatchesWithAI(e,t,n,i,r,o){const a=Array.from(e.querySelectorAll("*")).filter(c=>c.tagName.toUpperCase()!=="SCRIPT"&&c.tagName.toUpperCase()!=="STYLE").filter(c=>new yn(c).text.trim());if(a.length===0)return r.push("No text content found for AI matching"),[];const l=Za(a,r);if(l.length===0)return r.push("No text content found in candidate elements for AI matching"),[];try{const c=Ra(o);r.push(`Context texts collected: ${c.length} texts`);const u=await Ga(l,n,r,"Gamma",c);if(!u)return[];const f=new yn(u),E=this.getPositionMatch(f,i),T=this.calculatePrimaryScore(.8,E),k=this.calculateFinalScore(T,f,t);return r.push(`Position: ${E.toFixed(4)}, Final Score: ${k.toFixed(4)}`),[{element:u,similarity:k}]}catch(c){return c instanceof Error&&r.push(`AI matching failed: ${c.message}`),[]}}calculatePrimaryScore(e,t){return e*this.weights.text+t*this.weights.position}getThreshold(e){return e>this.thresholds.highPosition?this.thresholds.minimum:this.thresholds.default}calculateRefinementScore(e,t){return this.matchTag(e,t)*this.weights.refinements.tag+this.matchAttributes(e,t)*this.weights.refinements.attributes+this.matchSiblings(e,t)*this.weights.refinements.siblings+this.matchParent(e,t)*this.weights.refinements.parent}calculateFinalScore(e,t,n){const i=this.calculateRefinementScore(t,n);return e*.8+i*.2}matchTag(e,t){return t.tagName&&e.tagName===t.tagName.toLowerCase()?1:0}matchAttributes(e,t){if(!t.attributes.length)return 1;const n=t.attributes.filter(o=>!o.ignored).map(o=>({comparison:o.comparison,name:o.name,value:o.modifiedValue??o.value}));let i=0,r=0;return n.forEach(o=>{r++;const a=e.attributes.find(l=>l.name===o.name);if(a){if(ka(o.name)){if(o.comparison==="contains"){a.value.includes(o.value)&&(i+=1);return}const l=Na(o.value,a.value);i+=l;return}if(o.comparison==="contains"){a.value.includes(o.value)&&(i+=1);return}a.value===o.value&&(i+=1)}}),r>0?i/r:1}matchSiblings(e,t){return t.siblings.length?t.siblings.filter(i=>e.siblings.some(r=>r.tagName===i.tagName&&(!i.text||r.text===i.text))).length/t.siblings.length:1}matchParent(e,t){return!t.tagName||t.tagName==="body"||e.parent?.tagName===t.tagName.toLowerCase()?1:0}getPositionMatch(e,t){const n=this.buildElementPath(e);let i=0;const r=Math.max(t.length,n.length);for(let o=1;o<=Math.min(t.length,n.length);o++){const a=t[t.length-o],l=n[n.length-o];if(a.tagName===l.tagName){const c=Math.abs(a.position-l.position);i+=c===0?1:1/(c+1)}}return i/r}buildElementPath(e){const t=[];let n=e.element;for(;n.parentElement;){const i=Array.from(n.parentElement.children);t.unshift({position:i.indexOf(n),tagName:n.tagName.toLowerCase()}),n=n.parentElement}return t}buildPositionPath(e){const t=[];let n=e;for(;n;)n.position!==null&&n.tagName&&t.push({position:n.position,tagName:n.tagName.toLowerCase()}),n=n.children??null;return t}getDeepestElement(e){let t=e;for(;t.children;)t=t.children;return t}}function pf(s){const e=s.attributes.find(t=>t.name==="id")?.value;return e!=null?CSS.escape(e):null}function mf(s){const e=s.attributes.find(t=>t.name==="class")?.value??null;return e!=null?e.split(" ").filter(t=>t.trim().length>0).map(CSS.escape):null}function gf(s){return s.attributes.reduce((e,t)=>(["id","class"].includes(t.name)||e.push(`[${t.name}='${t.value.replace(/'/g,"\\'")}']`),e),[])}var Zn=(s=>(s.ID="id",s.CLASS="class",s.ATTRIBUTE="attribute",s.TEXT="text",s.POSITION="position",s))(Zn||{});function bi(s,e=["id","class","attribute","text","position"]){const t=[s.tagName];if(s.position!=null&&e.includes("position")&&t.push(`:nth-child(${s.position+1})`),e.includes("id")){const n=pf(s);n!=null&&t.push(`#${n}`)}if(e.includes("class")){const n=mf(s);n!=null&&n.length>0&&t.push(`.${n.join(".")}`)}if(e.includes("attribute")){const n=gf(s);t.push(...n)}return s.text.length>0&&e.includes("text")&&t.push(`:contains(${s.text.split(`
`)[0].slice(0,128)})`),s.children!=null&&(t.push(" > "),t.push(bi(s.children,e))),t.join("")}class Ka{findWithinSpecificDOM(e,t){const n=["Strategy Alpha"],i=bi(e);n.push(i);let r=Xt(i,t);if(r.length===0){const o=bi(e,[Zn.POSITION,Zn.ATTRIBUTE,Zn.TEXT]);n.push(o),r=Xt(o,t)}if(r.length===0){const o=bi(e,[Zn.POSITION,Zn.TEXT]);n.push(o),r=Xt(o,t)}return{element:r[0]??null,debugInformation:n}}}class yf{findWithinSpecificDOM(e,t){let n=e;for(;n.children!=null;)n=n.children;let i=null;const r=["Manual CSS paths strategy"];if(n.manualCssPaths.length===0)return r.push("No manual CSS paths defined, returning null"),{element:i,debugInformation:r};const o=[...n.manualCssPaths];for(;i==null&&o.length>0;){const a=o.shift();if(a==null){H.warn("Trying to find element with Manual CSS paths strategy, the list of paths contains a null element");break}r.push(a);const l=Xt(a,t);if(l.length===0){r.push(o.length===0?"No elements found, returning null":"No elements found, trying next css path");continue}if(l.length===1){i=l[0];break}if(l.length>1){r.push(o.length===0?"Multiple elements found, returning null":"Multiple elements found, trying next css path");continue}}return{element:i,debugInformation:r}}}const vf=p.object({attributes_blacklist:p.array(p.string()).default([]),attributes_ordering:p.array(p.string()).optional()}).default({attributes_blacklist:[]}),bf=p.object({settings:vf.optional(),ignoreInvisibleResults:p.boolean().default(!1),isAiServiceAvailable:p.boolean().default(!1)}).default({});class wf{constructor(e){const t=bf.parse(e);this.attributesBlacklist=t.settings?.attributes_blacklist??[],this.shouldUseAiTextMatching=t.isAiServiceAvailable,this.attributesOrdering=Aa(t.settings?.attributes_ordering),this.ignoreInvisibleResults=t.ignoreInvisibleResults}async findWithinSpecificDOM(e,t){let n=null;const i=["Strategy Delta"],r=gi(e,this.attributesBlacklist);if(r.length===0){if(i.push("There is no attributes to try, either because there is no attribute or because all attributes are ignored"),i.push("Trying to find the target element with the tag name"),n=this.findTargetWithTagName(t??document,e),n===null)return i.push("No element found, returning null"),{element:null,debugInformation:i};const a=ht(e).text?.trim();if(a&&a.length>0){const l=gn(n).trim();if(l!==a)return i.push(`Tag name fallback found element but text mismatch: found "${l}", expected "${a}"`),{element:null,debugInformation:i}}return i.push("Found one target element with the tag name, returning it"),{element:n,debugInformation:i}}const o=r.map(a=>a.name==="class"?a.value.split(/\s+/).map(l=>({comparison:a.comparison,name:"class",value:l})).filter(l=>l.value.trim()!==""):a).flat().sort(La(this.attributesOrdering));for(let a=0;a<o.length&&n==null;a++){const l=o[a],c=yi(l);i.push(`Trying selector: ${c}`);let u=Xt(c,t);if(i.push(`Found ${u.length} elements with that selector`),this.ignoreInvisibleResults){const f=u.length;u=u.filter(T=>ut(T));const E=u.length;i.push(`Filtered out ${f-E} invisible elements, ${E} remaining.`)}if(u.length===1){const f=u[0];if(this.validateElementMatch(f,e,i)){i.push("Found exactly 1 element, validation passed"),n=f;break}else i.push("Found 1 element but validation failed, continuing search")}if(u.length>1&&(i.push(`Found ${u.length} elements with single attribute, trying to select best element`),n=await this.selectBestElement(u,e,i),n!==null))break}if(n==null&&o.length>1){i.push("Single attributes failed, trying combined selectors");for(let a=2;a<=Math.min(4,o.length)&&n==null;a++)for(let l=0;l<=o.length-a&&n==null;l++){const u=o.slice(l,l+a).map(E=>yi(E)).join("");i.push(`Trying combined selector: ${u}`);const f=Xt(u,t);if(f.length===1){const E=f[0];if(this.validateElementMatch(E,e,i)){i.push("Found exactly 1 element with combined selector, validation passed"),n=E;break}else i.push("Found 1 element but validation failed, continuing search")}if(f.length>1&&(i.push(`Combined selector still found ${f.length} elements, trying to select best element`),n=await this.selectBestElement(f,e,i),n!==null))break}}if(n===null&&(n=this.findTargetWithTagName(t??document,e),n!==null)){const a=ht(e).text?.trim();if(a&&a.length>0){const l=gn(n).trim();l!==a&&(i.push(`Tag name fallback found element but text mismatch: found "${l}", expected "${a}"`),n=null)}}return n!==null&&i.push("Found one target element with the tag name, returning it"),{element:n,debugInformation:i}}validateElementMatch(e,t,n){const i=ht(t);if(e.tagName.toLowerCase()!==i.tagName.toLowerCase())return n.push(`Tag name mismatch: found ${e.tagName.toLowerCase()}, expected ${i.tagName.toLowerCase()}`),!1;const r=i.text?.trim();if(r&&r.length>0){const l=gn(e).trim();if(l!==r)return n.push(`Text mismatch: found "${l}", expected "${r}"`),!1}const o=gi(t,this.attributesBlacklist),a=[];for(const l of o){const c=e.getAttribute(l.name);if(c===null){a.push(l.name);continue}let u=!1;if(l.comparison==="contains"?u=c.includes(l.value):l.name==="class"?u=c.split(/\s+/).includes(l.value):u=c===l.value,!u)return n.push(`Attribute ${l.name} value mismatch: found "${c}", expected "${l.value}"`),!1}return a.length>0?(n.push(`Missing attributes: ${a.join(", ")}`),!1):(n.push("All validations passed"),!0)}async selectBestElement(e,t,n){const i=e.filter(u=>u.tagName.toLocaleLowerCase()===ht(t).tagName);n.push(`Found ${i.length} elements with the right tag name`);const o=ht(t).text?.trim();let a=i;if(o&&o.length>0){const u=i.filter(f=>gn(f).trim()===o);if(n.push(`Found ${u.length} elements with matching text "${o}"`),u.length>0)a=u;else return n.push("No elements match the required text, returning null"),null}if(a.length===1)return a[0];let l=a;const c=[new $a(t,n),new Ba(t,this.attributesBlacklist,n),new za(t,n)];for(ht(t).position!==null&&c.push(new Fa(t,n));l.length>1&&c.length>0;){const u=c.shift();n.push(`Trying to elect the best element using ${u.name}`),l=u.getWinners(l)}if(l.length===1)return n.push("Found the best element, returning it"),l[0];if(l.length>1&&o&&o.length>0)if(!this.shouldUseAiTextMatching)n.push("AI text matching not available");else{n.push(`${l.length} elements remain after traditional scoring, trying AI text matching`);const u=Za(l,n);if(u.length>0){const f=Ra(t),E=await Ga(u,o,n,"Delta",f);if(E)return E}}return n.push(`There are still ${l.length} elements after trying all selection methods, returning null`),null}findTargetWithTagName(e,t){const n=ht(t);if(e instanceof DocumentFragment){const r=e.querySelectorAll(n.tagName);return r.length===1?r[0]:null}const i=e.getElementsByTagName(n.tagName);return i.length===1?i[0]:null}}function Sr(s,e=8,t={entropy:3.5,compression:.8,distribution:.3,runLength:1.8,finalScore:.65}){if(s.length<e)return{isRandom:!1,scores:{entropy:0,compressionRatio:0,charDistribution:0,runLength:0,final:0}};if(new Set(s.split("")).size===1)return{isRandom:!1,scores:{entropy:0,compressionRatio:0,charDistribution:0,runLength:0,final:0}};if(s.length>=6){const y=s.substring(0,2);let v=!0;for(let w=0;w<s.length-1;w+=2)if(s.substring(w,w+2)!==y){v=!1;break}if(v)return{isRandom:!1,scores:{entropy:.2,compressionRatio:.1,charDistribution:.2,runLength:.1,final:.15}}}if(s.length>=5){let y=!0;for(let v=1;v<s.length;v++)if(s.charCodeAt(v)!==s.charCodeAt(v-1)+1){y=!1;break}if(y)return{isRandom:!1,scores:{entropy:.3,compressionRatio:.2,charDistribution:.3,runLength:.2,final:.25}}}if(s.length>=6){let y=!0;const v=s.split("").map(w=>/[a-zA-Z]/.test(w));for(let w=2;w<v.length;w++)if(v[w]!==v[w-2]){y=!1;break}if(y&&v[0]!==v[1]){const w=1.1538461538461537,_={entropy:.8/w,compressionRatio:.7/w,charDistribution:.8/w,runLength:.7/w,final:.75};return{isRandom:_.final>t.finalScore,scores:_}}}if(s.includes(" ")){const y=s.split(/\s+/);if(y.length>3){const v=s.replace(/\s+/g,"").length/y.length;if(v>=2&&v<=10&&(s.match(/[a-zA-Z]/g)??[]).length/s.length>.6)return{isRandom:!1,scores:{entropy:.5,compressionRatio:.5,charDistribution:.5,runLength:.5,final:.5}}}}const n={};for(const y of s)n[y]=(n[y]||0)+1;let i=0;for(const y in n){const v=n[y]/s.length;i-=v*Math.log2(v)}const r=Object.keys(n).length,o=Math.log2(r),a=o>0?i/o:0,l=Ef(s),c=r/Math.min(s.length,256),u=_f(s),f={entropy:.35,compression:.3,distribution:.15,runLength:.2},E=a*f.entropy+l*f.compression+c*f.distribution+u*f.runLength,T={entropy:a,compressionRatio:l,charDistribution:c,runLength:u,final:E};return{isRandom:u<.3?!1:E>t.finalScore,scores:T}}function Ef(s){const e={};for(let i=1;i<=Math.min(8,Math.floor(s.length/2));i++)for(let r=0;r<=s.length-i;r++){const o=s.substring(r,r+i);e[o]=(e[o]||0)+1}let t=0;for(const i in e)e[i]>1&&i.length>1&&(t+=e[i]*i.length);const n=t/(s.length*2);return Math.max(0,Math.min(1,1-n))}function _f(s){if(s.length<=1)return 0;const e=[];let[t]=s,n=1;for(let T=1;T<s.length;T++)s[T]===t?n++:(e.push(n),t=s[T],n=1);e.push(n);const i=e.length,r=Math.max(...e),o=e.reduce((T,k)=>T+k,0)/i,a=Math.min(1,r/(s.length/2)),l=Math.min(1,(o-1)/3),u=Math.min(1,i/s.length)*.3+(1-a)*.4+(1-l)*.3,f=new Set(s.split("")).size,E=Math.max(0,1-f/Math.min(10,s.length));return Math.max(0,Math.min(1,u-E))}const Cs={dynamicId:[/^[0-9a-f]{8}(-[0-9a-f]{4}){3}-[0-9a-f]{12}$/i,/^[0-9a-f]{32}$/i,/^id_[0-9a-f]{5,}$/i,/^[a-z]+-[0-9a-f]{6,}$/i,/^[a-z]+_[0-9]{3,}$/i,/^el-[0-9]+$/i,/^[a-z]{1,3}[0-9]{4,}$/i,/^id[0-9]{3,}$/i,/^[a-z]+-[0-9]+-[0-9a-f]+$/i,/^[a-z]{1,2}-[a-z]{1,2}-[0-9a-f]{4,}$/i,/^[a-z]+-[0-9]{10,}$/i,/^[a-z]+[0-9]+-[0-9a-f]{5,}$/i,/^[a-z]+\/[a-z]+\/[0-9a-f]+$/i],stableId:[/^[a-z]+(-[a-z]+){0,3}$/,/^[a-z]+(_[a-z]+){0,3}$/,/^[a-z][a-zA-Z0-9]{1,15}$/,/^(header|footer|main|nav|sidebar|content)$/,/^(container|wrapper|root|app)$/,/^form-[a-z]+$/,/^section-[a-z]+$/,/^tab-[a-z]+$/,/^(login|signup|contact|search)-[a-z]*$/,/^btn-[a-z]+$/,/^[a-z]+-panel$/,/^page-[a-z]+$/,/^[a-z]+-view$/],stableClass:[/^(btn|button)(-[a-z]+)?$/,/^(container|wrapper|row|col)(-[a-z0-9]+)?$/,/^(header|footer|nav|sidebar|main|content)$/,/^(text|font|bg|border|m|p)(-[a-z0-9]+)?$/,/^(sm|md|lg|xl):[a-z0-9-]+$/,/^(flex|grid|block|inline|hidden)$/,/^(active|disabled|selected|open|closed)$/,/^(animate|transition|transform)(-[a-z]+)?$/,/^(rounded|shadow|opacity|z)(-[a-z0-9]+)?$/],unstableClass:[/^[a-z]_[a-zA-Z0-9]{5,}$/,/^[a-z][A-Z0-9][a-zA-Z0-9]{3,}$/,/^jsx-[a-zA-Z0-9_-]{4,}$/,/^[a-z]{1,3}[0-9]{3,}$/,/^([a-z]+-)?[a-f0-9]{4,}$/,/^_[a-zA-Z0-9]{5,}$/,/^[a-z]+-[a-zA-Z0-9]{8,}$/],frameworkGeneratedClass:[/^css-[a-zA-Z0-9]+$/,/^[a-z][a-z0-9]?[0-9a-f]{4,}$/,/^(MUI|Mui)-[a-zA-Z0-9-]+$/,/^(mantine|chakra)-[a-zA-Z0-9-]+$/,/^(svelte|ng|vue|react)-[a-zA-Z0-9-]+$/,/^__[a-zA-Z0-9_-]+$/,/^[a-z]+-module_[a-zA-Z0-9]+$/,/^data-v-[a-f0-9]+$/]},Gn={potentiallyDynamicAttrs:new Set(["id","name","key","data-id","data-test","data-testid","data-uid","data-v-","guid","uuid","token","hash","nonce"]),generallyStableAttrs:new Set(["class","type","role","aria-label","title","alt","rel","href","src","target","method","action","aria-labelledby","aria-describedby","aria-controls","aria-expanded","aria-haspopup","aria-hidden","aria-live","aria-atomic","for","name","value","placeholder","required","disabled","readonly","autocomplete"]),stableElements:new Set(["header","footer","nav","main","article","section","aside","h1","h2","h3","h4","h5","h6","ul","ol","table","form","fieldset","legend","figure","figcaption","details","summary"]),lessStableElements:new Set(["div","span","p","a","button","input","img","li","tr","td"]),commonWords:new Set(["header","footer","sidebar","menu","nav","content","main","button","form","input","section","container","wrapper","tab","panel","modal","dialog","alert","banner","card","item","list","grid","table","row","column","cell","page","view","screen","app","root","login","logout","signup","register","contact","about","home","search","user","profile","account","admin","dashboard","settings"])},Is={stabilityV1:{id:.3,classes:.25,attributes:.2,structure:.15,semantics:.1}},Xa={id:{finalScore:.6},classes:{finalScore:.55}};function Rs(s,e){return e.some(t=>t.test(s))}function Ya(s,e){const t={id:e?.stability_v1?.subscore_weights?.id??Is.stabilityV1.id,classes:e?.stability_v1?.subscore_weights?.classes??Is.stabilityV1.classes,attributes:e?.stability_v1?.subscore_weights?.attributes??Is.stabilityV1.attributes,structure:e?.stability_v1?.subscore_weights?.structure??Is.stabilityV1.structure,semantics:e?.stability_v1?.subscore_weights?.semantics??Is.stabilityV1.semantics},n={id:Tf(s),classes:xf(s),attributes:Sf(s),structure:Cf(s),semantics:If(s)};let i=0;for(const a in n)i+=n[a]*t[a];n.id>.7&&n.classes>.7&&(i+=.1),n.structure>.8&&n.semantics>.7&&(i+=.1);const r=Math.max(0,Math.min(1,(i-.3)*(1/.4))),o=Math.pow(r,.8);return Math.round(o*100)/100}function Tf(s){const e=s.attributes.find(u=>u.name==="id");if(!e||e.ignored||!e.value||e.value.length===0)return .5;const t=e.value;let i=Sr(t,5,Xa.id).isRandom?.2:.7;Rs(t,Cs.dynamicId)&&(i=Math.min(i,.15)),Rs(t,Cs.stableId)&&(i=Math.max(i,.85)),t.length>20?i=Math.min(i,.4):t.length>10&&t.length<=20?i=Math.min(i,.6):t.length<=10&&t.length>3&&(i+=.1);const o=(t.match(/\d/g)??[]).length/t.length;o>.5?i=Math.min(i,.3):o>.3&&(i=Math.min(i,.5)),(t.match(/[^a-zA-Z0-9_-]/g)??[]).length>0&&(i=Math.min(i,.4));const l=t.toLowerCase().split(/[-_]/);let c=0;for(const u of l)Gn.commonWords.has(u)&&c++;return c>0&&(i=Math.max(i,.5+c/l.length*.4)),/[a-z]+-\d{1,2}$/.test(t)&&(i=Math.max(i,.6)),i}function xf(s){const e=s.attributes.find(y=>y.name==="class");if(!e||e.ignored||!e.value||e.value.length===0)return .5;const t=k(e.value.split(" "));let n=0;for(const y of t){let v=.5;const w=Sr(y,5,Xa.classes);w.isRandom&&(v=.3-(w.scores.final-.55)*.5),Rs(y,Cs.stableClass)&&(v=Math.max(v,.8)),Rs(y,Cs.unstableClass)&&(v=Math.min(v,.2)),Rs(y,Cs.frameworkGeneratedClass)&&(v=Math.min(v,.3)),y.length>20&&(v=Math.min(v,.4)),/^[a-z]+(-[a-z]+){0,3}$/.test(y)&&(v=Math.max(v,.7)),/^[a-z]+[0-9]{1,2}$/.test(y)&&(v=Math.max(v,.6)),/[A-Z]/.test(y)&&(v=Math.min(v,.4)),/_{2,}/.test(y)&&(v=Math.min(v,.3));const _=Math.min(1.5,.5+y.length/20);n+=v*_}const i=new Set(t.map(y=>{const v=y.match(/^([a-z-]+)-/);return v?v[1]:""}).filter(y=>y)),r=i.size>0?Math.max(.2,1-i.size/t.length*.8):.5,o=t.map(y=>y.length),a=o.reduce((y,v)=>y+v,0)/o.length,l=o.reduce((y,v)=>y+Math.abs(v-a),0)/o.length,c=l<2?.3:Math.min(1,l/10),u=.7,f=.15,E=.15,T=u+f+E;return(n/(t.length||1)*u+r*f+c*E)/T;function k(y){return Array.from(new Set(y))}}function Sf(s){const e=s.attributes.filter(i=>!i.ignored);if(e.length===0)return .5;let t=0,n=0;for(const i of e){const{name:r,value:o}=i;let a=1;(r==="id"||r==="data-id"||r==="key")&&(a=2);let l;Gn.generallyStableAttrs.has(r)?l=.8:Array.from(Gn.potentiallyDynamicAttrs).some(c=>r===c||r.startsWith(c))?l=.3:l=.5,!Gn.generallyStableAttrs.has(r)&&o&&o.length>5&&Sr(o,5).isRandom&&(l=Math.min(l,.4)),t+=l*a,n+=a}return n>0?t/n:.5}function Cf(s){const e=s.tagName.toLowerCase();return Gn.stableElements.has(e)?.9:Gn.lessStableElements.has(e)?.6:.4}function If(s){let e=.4;i(s,"role")&&(e+=.3),(i(s,"aria-label")||i(s,"aria-labelledby"))&&(e+=.2),i(s,"title")&&(e+=.1);const t=s.text?.trim()??"";t.length>0&&!/^\d+$/.test(t)&&(e+=.1);const n=Array.from(s.attributes).filter(r=>r.name.startsWith("data-"));for(const r of n)if(/data-(role|type|purpose|function|section|component)/i.test(r.name)){e+=.1;break}return Math.min(1,e);function i(r,o){return r.attributes.some(a=>a.name===o)}}class Rf{constructor({beta:e,pivot:t}={}){this.betaStrategy=new Ss({settings:e}),this.settings=t}findWithinSpecificDOM(e,t){const n=["Strategy Pivot"],i=this.findPivotElement(e);n.push(`Searching for pivot ${l(i)} element using Beta strategy`);const{element:r,debugInformation:o}=this.betaStrategy.findWithinSpecificDOM({...i,children:void 0},t);if(n.push(...o),!r)return n.push("Failed to find pivot element in the DOM"),{element:null,debugInformation:n};n.push("Found pivot element, trying to find the target element");const a=this.findTargetElement(r,i);if(a===null)return n.push("Failed finding the target element from the pivot element"),{element:null,debugInformation:n};return n.push("Successfully found target element using pivot strategy"),{element:a,debugInformation:n};function l(c){let u=c.tagName;return c.attributes?.length>0&&c.attributes.forEach(f=>{u+=`[${f.name}="${f.value}"]`}),u}}getTargetJSONDomElement(e){let t=e;for(;t.children;)t=t.children;return t}findPivotElement(e){const t=Of(e,this.settings),n=Af(t),i=this.getTargetJSONDomElement(n);if(i.scores?.stabilityV1===void 0)return i;let r=n,o=i;for(;r;)r.scores?.stabilityV1!==void 0&&o.scores?.stabilityV1!==void 0&&r.scores.stabilityV1>=o.scores.stabilityV1&&(o=r),r=r.children;return o}findTargetElement(e,t){let n=e,i=t;if(!i.children)return n;for(;i.children;){if(i=i.children,i.position==null)return null;const r=n.children[i.position];if(r===void 0)return null;n=r}return n}}function Af(s){const t=structuredClone(s),n=o(s);let i=t,r=n;for(;i.children;)i.scores?.stabilityV1&&(i.scores.stabilityV1*=Math.pow(.96,r)),i=i.children,r--;return t;function o(a){let l=0;for(;a.children;)a=a.children,l++;return l}}function Of(s,e){const t=structuredClone(s);let n=t;for(;n.children;)n.scores={stabilityV1:Ya(n,e)},n=n.children;return n.scores={stabilityV1:Ya(n,e)},t}const Lf=p.object({strategies:p.array(p.string()),strategies_settings:p.object({beta:p.any().optional(),delta:p.any().optional(),pivot:p.any().optional(),gamma:p.any().optional()}).nullable(),isAiServiceAvailable:p.boolean().default(!1)}).nullable(),Mf=["manual_css_paths","alpha","beta","gamma","delta","pivot"],Nf="beta",kf=s=>s?s.includes("manual_css_paths")?s:["manual_css_paths",...s]:["manual_css_paths",Nf],Pf=({optionsV3:s,ignoreInvisibleResults:e})=>{const t=Lf.parse(s);function n(i){switch(i){case"beta":return t?.strategies_settings?.beta;case"delta":return t?.strategies_settings?.delta;case"pivot":return t?.strategies_settings?.pivot;case"gamma":return t?.strategies_settings?.gamma;default:return}}return new Zd(kf(t?.strategies).map(i=>{switch(i){case"beta":return new Ss({settings:n("beta"),ignoreInvisibleResults:e});case"gamma":return H.trace("Creating Gamma strategy with settings",{rawSettings:n("gamma")}),new qa({settings:n("gamma"),ignoreInvisibleResults:e,isAiServiceAvailable:t?.isAiServiceAvailable,betaSettings:n("beta")});case"delta":return new wf({settings:n("delta"),ignoreInvisibleResults:e,isAiServiceAvailable:t?.isAiServiceAvailable});case"alpha_then_beta":return H.trace("alpha_then_beta is deprecated"),[new Ka,new Ss({settings:n("beta")})];case"gamma_then_beta":return H.trace("gamma_then_beta is deprecated"),[new qa({settings:n("gamma"),ignoreInvisibleResults:e,isAiServiceAvailable:t?.isAiServiceAvailable,betaSettings:n("beta")}),new Ss({settings:n("beta")})];case"manual_css_paths":return new yf;case"pivot":return new Rf({beta:n("beta"),pivot:n("pivot")});case"alpha":default:return new Ka}}).flat())};p.object({version:p.string(),json:Ia,strategies:p.union([p.array(p.string()),p.string()]).optional().nullable(),strategy:p.union([p.array(p.string()),p.string()]).optional().nullable()}).transform(s=>{let e=[];const t=s.strategies??s.strategy;t!=null&&(e=typeof t=="string"?t.split(";").map(r=>r.trim()):t,s.strategies==null&&s.strategy!=null&&delete s.strategy);const n=[];e.forEach(r=>{r.includes("_then_")?n.push(...r.split("_then_")):n.push(r)});const i=Array.from(new Set(n.filter(r=>Mf.some(o=>o===r))));if(i.length===0)return{...s,strategies:[]};if(!i.includes("manual_css_paths"))i.unshift("manual_css_paths");else if(i.indexOf("manual_css_paths")!==0){const r=i.indexOf("manual_css_paths");i.splice(r,1),i.unshift("manual_css_paths")}return{...s,strategies:i}}).parse.bind(void 0);class Ja{constructor(e){this.abortController=null,this.highlight=null,this.isInViewport=null,this.id=ze(),this.element=e,this.start()}start(){if(this.abortController==null){this.abortController=new AbortController,this.abortController.signal.addEventListener("abort",()=>{this.abortController=null},{once:!0});const e=this.onMessage.bind(this);Rt.addMessageListener((t,n)=>{if(Qa(t)&&t.observableId===this.id&&t.type===ce.OBSERVE){n?.start();const i=r=>{n?.postMessage(r)};n?.addMessageListener(async r=>{e(r,i)}),this.observe(i),i({type:X.OBSERVE_ACK})}},this.abortController.signal),Rt.addMessageListener(t=>{e(t,()=>{})},this.abortController.signal)}}stop(){this.detachHighlight(),this.abortController?.abort()}onMessage(e,t){if(Qa(e)&&e.observableId===this.id)switch(e.type){case ce.FOCUS:{this.focus(),t({type:X.FOCUS,requestId:e.requestId});return}case ce.RECT:{t({type:X.RECT,requestId:e.requestId,payload:{rect:this.getRect()}});return}case ce.TEXT:{t({type:X.TEXT,requestId:e.requestId,payload:{text:this.text()}});return}case ce.ATTRIBUTES:{t({type:X.ATTRIBUTES,requestId:e.requestId,payload:{attributes:this.attributes()}});return}case ce.TAG_NAME:{t({type:X.TAG_NAME,requestId:e.requestId,payload:{tagName:this.tagName()}});return}case ce.IN_VIEWPORT:{t({type:X.IN_VIEWPORT,requestId:e.requestId,payload:{inViewport:this.visible()}});return}case ce.RENDERED:{t({type:X.RENDERED,requestId:e.requestId,payload:{rendered:this.rendered()}});return}case ce.STOP:this.stop()}if(e&&typeof e=="object"&&"type"in e&&"payload"in e)switch(e.type){case ce.SHOW_HIGHLIGHT:{const n=e.payload;n.observableId===this.id&&this.attachHighlight(n);break}case ce.HIDE_HIGHLIGHT:{e.payload.observableId===this.id&&this.detachHighlight();break}case ce.ATTACH_BEACON:{const n=e.payload;n.observableId===this.id&&this.attachBeacon(n,t);break}}}attachBeacon(e,t){const n=Df(this.element,e.options);t({type:X.BEACON_ATTACHED,payload:{beaconId:n.id}})}setupResizeListener(e){window.addEventListener("resize",()=>{const t=this.getRect();e({type:X.RECT,payload:{rect:t}}),this.highlight&&this.highlight.show(t)},{signal:this.abortController?.signal})}setupChangeListener(e,t){let n=null;const i=u=>{e({type:X.CHANGE})},r=()=>{this.element.removeEventListener("change",i,{capture:!0}),n!==null&&clearInterval(n)};t?.addEventListener("abort",r),this.element.addEventListener("change",i,{once:!0,capture:!0});let o=l(this.element),a=c(this.element);n=setInterval(()=>{const u=l(this.element),f=c(this.element);(o!==u||a!==f)&&(o=u,a=f,i())},150);function l(u){return"value"in u&&typeof u.value=="string"?u.value:""}function c(u){return u instanceof HTMLElement?u.innerText:""}}setupInputListener(e){this.element.addEventListener("input",()=>{e({type:X.INPUT,payload:{value:this.text()}})})}setupScrollListener(e){Rt.addMessageListener(n=>{if(n.type===Kt.SCROLL){const i=this.getRect();e({type:X.RECT,payload:{rect:i}}),this.highlight&&this.highlight.show(i)}},this.abortController?.signal);let t=this.element;for(;t!=null;)t.addEventListener("scroll",()=>{const n=this.getRect();e({type:X.RECT,payload:{rect:n}}),this.highlight&&this.highlight.show(n)},{signal:this.abortController?.signal}),t=t.parentElement??t.shadowRoot?.parentElement??void 0;window.addEventListener("scroll",()=>{const n=this.getRect();e({type:X.RECT,payload:{rect:n}}),this.highlight&&this.highlight.show(n)},{signal:this.abortController?.signal})}setupUserEventListeners(e){const t={mouseover:X.HOVER,click:X.CLICK,focus:X.FOCUS,blur:X.BLUR,mouseenter:X.MOUSE_ENTER,mouseleave:X.MOUSE_LEAVE,mousedown:X.MOUSE_DOWN};Object.keys(t).forEach(n=>{this.element.addEventListener(n,()=>{e({type:t[n]})},{signal:this.abortController?.signal,capture:!0})})}setupIntersectionObserver(e){const t=new IntersectionObserver(n=>{const i=n[0].isIntersecting;(this.isInViewport===null||this.isInViewport!==i)&&(this.isInViewport=i,e({type:X.IN_VIEWPORT,payload:{inViewport:i}}));const r=this.getRect();e({type:X.RECT,payload:{rect:r}})});t.observe(this.element),this.abortController?.signal.addEventListener("abort",()=>{t.disconnect()},{once:!0})}setupMutationObserver(e){const t=()=>{e({type:X.RECT,payload:{rect:this.getRect()}})},n=new MutationObserver(t.bind(this));n.observe(this.element,{attributes:!0,childList:!0,subtree:!0}),this.abortController?.signal.addEventListener("abort",()=>{n.disconnect()},{once:!0})}setupRemovedMutationObserver(e){if(this.element.parentElement==null)return;const t=o=>{o.forEach(a=>{if(a.removedNodes.length>0){const l=Array.from(a.removedNodes);(l.includes(this.element)||l.some(c=>c.contains(this.element)))&&(e({type:X.REMOVED}),this.abortController?.abort())}})},n=new MutationObserver(t.bind(this)),i=this.element.getRootNode(),r=i instanceof ShadowRoot?i:Zt(document);n.observe(r,{childList:!0,subtree:!0}),this.abortController?.signal.addEventListener("abort",()=>{n.disconnect()},{once:!0})}observe(e){return this.setupIntersectionObserver(e),this.setupMutationObserver(e),this.setupRemovedMutationObserver(e),this.setupResizeListener(e),this.setupScrollListener(e),this.setupInputListener(e),this.setupChangeListener(e,this.abortController?.signal),this.setupUserEventListeners(e),!0}getRect(){return this.element.getBoundingClientRect()}visible(){return dn(this.element)}rendered(){return ut(this.element)}text(){return this.element instanceof HTMLInputElement?this.element.value:this.element.textContent}attributes(){return Array.from(this.element.attributes).reduce((e,t)=>(e[t.name]=t.value,e),{})}tagName(){return this.element.tagName}focus(){this.element.scrollIntoView({behavior:"smooth",block:"center"})}attachHighlight(e){this.detachHighlight(),this.highlight=new cr({color:e.color,type:e.type,selector:e.selector}),this.highlight.attachToElement(this.element)}detachHighlight(){this.highlight?.hide(),this.highlight=null}}function Qa(s){return p.object({observableId:p.string(),type:p.string()}).safeParse(s).success}function Df(s,e){const t=aa(s,e),n=t.element;if(!(n instanceof Element))throw new Error("createBeaconObservable requires beacon.element to be an Element");const i=new Ja(n),r=i.stop.bind(i);return i.stop=()=>{t.unmount(),r()},i}const $f=p.object({strategy:p.enum(["regular","xpath"]).optional(),context:p.object({enabled:p.boolean().optional(),levels:p.number().optional(),bonus:p.unknown().optional()}).catch({}),dynamicIframes:p.boolean().optional(),trustSpecificity:p.boolean().optional(),validation:p.object({enabled:p.boolean().optional(),threshold:p.number().optional(),mode:p.enum(["regular","xpath","dynamic"]).optional(),validators:p.array(p.object({enabled:p.boolean().catch(!0),name:p.enum(["nth","position","dimensions","attributes"]),weight:p.number(),options:p.record(p.union([p.string(),p.unknown()])).catch({})})).optional()}).catch({}),cssClassesBlacklist:p.array(p.string()).catch([]),eventsToBlock:p.array(p.string()).catch([]),pathExtensions:p.array(p.string()).catch([]),iframesSettings:p.record(p.union([p.string(),p.unknown()])).optional(),useTexts:p.boolean().optional(),projectRigidity:p.number().optional(),useCssClassesInPath:p.boolean().optional(),modifiers:p.array(p.object({enabled:p.boolean(),name:p.literal("keywords"),options:p.object({words:p.array(p.string()).optional()})})).catch([]),useIdSelector:p.boolean().optional(),postMessagesAdditionalProperties:p.array(p.unknown()).catch([])}).optional();p.object({paths:p.array(p.object({value:p.string(),active:p.boolean()})),settings:$f,pathElement:p.object({id:p.string().nullable().catch(null),elementType:p.string().optional(),classList:p.array(p.object({value:p.string(),active:p.boolean()})),attributesList:p.array(p.object({value:p.string(),active:p.boolean()})),texts:p.array(p.object({value:p.string(),active:p.boolean()}))}),iframes:p.array(p.array(p.object({value:p.string(),active:p.boolean()}))),validationData:p.object({position:p.object({top:p.number(),right:p.number(),bottom:p.number(),left:p.number()}).optional(),width:p.number().optional(),height:p.number().optional(),nthPosition:p.number().nullable().optional(),attributes:p.record(p.union([p.string(),p.number()])).catch({})}).nullable().optional(),isPivot:p.boolean().catch(!1),pivotOptions:p.object({nthTagIndex:p.number(),tagName:p.string(),targetPositionComparedToPivot:p.enum(["after","before"])}).nullable().catch(null),contextElements:p.array(p.object({path:p.string(),proximity:p.number(),level:p.number().nullable()})).catch([]),contextEnabled:p.boolean().catch(!1)});function el(s){if(s.length<=0)throw new Error("nodes is empty");let e=s.shift();for(;s.length>0;){const t=s.shift();t!=null&&(e={...t,children:e??void 0})}if(e==null)throw new Error("nextNode is null");return e}function Bf(s){let e=s;const t=[];for(;e!=null;){const{children:r,...o}=e;if(t.unshift(o),n(e)||i(e))return{current:el(t),remaining:r};e=r??null}return{current:el(t)};function n(r){return r.tagName==="iframe"||r.tagName==="frame"}function i(r){return r.shadowRoot===!0}}class wi{constructor(){we.addMessageListener(async(e,t)=>{e.type==="FIND"&&await wi.findObservableElement(e.payload.json,document,e.payload.options).then(n=>{t?.postMessage(n)})})}static async find(e,t){const n=await wi.findObservableElement(e,document,t);return n.id!=null?{element:new hi(n.id),debugInformation:n.debugInformation}:{element:null,debugInformation:n.debugInformation??[]}}static async findObservableElement(e,t,n){const{current:i,remaining:r}=Bf(e),{element:o,debugInformation:a}=await Pf(n).findWithinSpecificDOM(i,t);if(o==null)return{id:null,debugInformation:a};if(o.shadowRoot!=null&&r!=null){const c=await this.findObservableElement(r,o.shadowRoot,n);return tl(o),{id:c.id,debugInformation:[...a,"Shadow DOM found, finding remaining",...c.debugInformation]}}if(Xe(o)&&r!=null){const c=await Ff(r,o,n);return o instanceof HTMLIFrameElement&&tl(o),{id:c.id,debugInformation:[...a,"Iframe found, finding remaining",...c.debugInformation]}}return{id:new Ja(o).id,debugInformation:a}}}async function Ff(s,e,t){try{return await we.requestFromFrame(e,{type:"FIND",payload:{json:s,options:t}})}catch{return{id:null,debugInformation:[]}}}function tl(s){let e=s;for(;e!=null;)e.addEventListener("scroll",()=>{Rt.broadcastToChildFrames({type:Kt.SCROLL})}),e=e.parentElement}const zf=()=>{new wi,new Rt};function Cr(s){const e=new Uint8Array(s??8);return crypto.getRandomValues(e),e.reduce((t,n)=>t+n.toString(16),"")}function nl(s){if(typeof s=="object"&&s!==null)return s;let t={};if(typeof s=="string")try{t=JSON.parse(s)}catch{}return t}const[Ir,Je,Vf]=(()=>{let s=null;return[()=>s!==null?s.id:null,()=>s,i=>{s=i}]})();class Ei{constructor(e,t,n=null){this._id=(i=>{const r=new Uint8Array(i);return crypto.getRandomValues(r),r.reduce((o,a)=>o+a.toString(16),"")})(4),this._to=e,this._payload=t,this._inResponseTo=n}setAction(e){this._payload.action=e}setValue(e){this._payload.value=e}setPayload(e){this._payload=e}send(e=!0){return this._to!==null?this._sendToCross(e):this._sendToMain(e)}_sendToMain(e=!0){const t=()=>{const n=JSON.stringify({action:"CROSS_RESPONSE",from:Ir(),to:this._to,messageId:this._id,inResponseTo:this._inResponseTo,payload:this._payload});return we.sendToParentFrame(n),null};return e?new Promise(n=>{const i=Je();if(i===null){n(null);return}const r=i.onMessage(o=>{o._inResponseTo===this._id&&(n(o),r())});t()}):t()}_sendToCross(e=!0){const t=()=>(xt.setItem("local:CROSS_ACTION",{messageId:this._id,from:Ir(),to:this._to,inResponseTo:this._inResponseTo,payload:this._payload}),null);return e?new Promise(n=>{const i=Je();if(i===null){n(null);return}const r=i.onMessage(o=>{o._inResponseTo===this._id&&(n(o),r())});t()}):t()}}class Wf{constructor(e,t,n,i){this._id=e,this._from=t,this._inResponseTo=i,this.value=n.value,this.action=n.action,this.payload=n}createResponse(e){return new Ei(this._from,e,this._id)}}class At{static find(e){const t=At.instanciate(e);t.setCrossResolver(At.crossResolver);const n=At.convertOptions(e),i=new AbortController;setTimeout(()=>{i.abort()},50);let r=[];t.awaitAll(...n,i.signal).then(({matches:o,iframes:a})=>(r=a??[],o.length===0?null:o[0].element instanceof Ts?o[0]:o.find(l=>ut(l.element.dom)))).then(o=>{const a=Je();if(o==null||a==null)return e.createResponse({action:"FIND_RESPONSE",value:{success:!1}}).send(!1);if(o.element instanceof Ts){const l=o.element;a.crossResults[l.resultId]={match:o,iframes:r};const c={success:!0,resultId:l.resultId,crossId:l.crossId,score:o.score.value,boxing:l.boxing,DOM:l.domInfo};e.createResponse({action:"FIND_RESPONSE",value:c}).send(!1)}else{const l=o.element,c=Cr(4),u=At.elementToJSON(l.dom);a.results[c]={element:l.dom,iframes:r},r.filter(Xe).forEach(E=>{const T=E.getBoundingClientRect();u.boxing.top+=T.top,u.boxing.right+=T.left,u.boxing.bottom+=T.top,u.boxing.left+=T.left});const f={success:!0,resultId:c,crossId:Ir(),score:o.score.value,...u};e.createResponse({action:"FIND_RESPONSE",value:f}).send(!1)}}).catch(o=>{H.error(o,"[CROSS FINDER ERROR]"),e.createResponse({action:"FIND_RESPONSE",value:{success:!1,error:o.message}}).send(!1)})}static instanciate(e){const t=xa.defaultOptions,n=e.value.options,i={nth:Id,position:Ad,attributes:Ld,dimensions:Od},r={nth:Ud,keywords:zd,generated:wr};return n.validators=(n.validators??[]).map(({name:o,...a})=>i[o]?new i[o]:null).filter(sl),n.modifiers=(n.modifiers??[]).map(({name:o,...a})=>r[o]?new r[o]:null).filter(sl),new xa({...t,...n})}static async crossResolver(e,t,n,i,r,o,a){const l=Je();if(l==null)throw new Error("Unexpected error: Cross is null");const c=l.children.filter(E=>E.depth()===E.depth()+(a??0)),u=e.getOptions(),f={options:u,selectors:t.map(E=>E.path),iframes:(n??[]).map(E=>E.map(T=>T.path)),context:u.contextEnabled?At.prepareContext(i):null,validationData:u.validationEnabled?o:null,rigidity:r};return await Promise.all(c.map(async({crossId:E})=>await At.searchInCross(E,f))).then(E=>E.filter(T=>T!=null))}static convertOptions(e){const t=e.value,n=t.selectors.map(a=>new Ie(a)),i=(t.iframes??[]).map(a=>a.map(l=>new Ie(l)));let r;if(t.context!=null){const a=t.context._elements.map(l=>({selector:new Ie(l.selector),proximity:l.proximity,level:l.level??void 0}));r=new xs(a,t.context._bonus)}let o;if(t.rigidity!=null){const a=t.rigidity.pathElement;o={...t.rigidity,pathElement:new mn(a._elementType,a._id??null,a._classList??[],a._attributesList??[],a._texts??[])}}return[n,i,r,o,t.validationData]}static elementToJSON(e){const{top:t,right:n,bottom:i,left:r,width:o,height:a,x:l,y:c}=e.getBoundingClientRect(),u={top:t,right:n,bottom:i,left:r,width:o,height:a,x:l,y:c},f={};return e.tagName.toLowerCase()==="input"&&(f.type=e.getAttribute("type")),{DOM:{id:e.id,classList:Array.from(e.classList),tagName:e.tagName.toLowerCase(),attributes:f},boxing:u}}static prepareContext(e){return e==null?{_bonus:0,_elements:[]}:{_bonus:e.bonus,_elements:e.elements.map(t=>{switch(t.proximity){case pi.DYNAMIC:return{selector:t.selector.path,proximity:t.proximity,level:t.level};default:return{proximity:t.proximity,selector:t.selector.path}}})}}static async searchInCross(e,t){return await new Promise(n=>{let i=!1;new Ei(e,{action:"START_FINDER"}).send().then(()=>i=!0).then(async()=>await new Ei(e,{action:"FIND",value:t}).send()).then(o=>{o.value.success?n(o.value):n(null)}),setTimeout(()=>{i||n(null)},150)})}}function sl(s){return s!=null}class Rr{static setupTrigger(e){switch(e.value.triggerType){case"hover":return this._hover(e);case"appear":this._appear(e);break;case"disappear":return this._disappear(e);case"change":return this._change(e);case"input":return this._input(e);case"remove":return this._remove(e);case"click":case"focus":case"blur":case"mousedown":case"mouseleave":return this._simpleTrigger(e.value.triggerType,e)}}static getBoxing(e){const t=Je();if(t==null)throw new Error("Cross is not initialized");const n=t.getResultById(e.value.resultId);if(n==null)return;const i=n.element,r=n.iframes??[],o=i.getBoundingClientRect(),a={top:o.top,right:o.right,bottom:o.bottom,left:o.left,width:o.width,height:o.height,x:o.x,y:o.y};r.filter(Xe).forEach(l=>{const c=l.getBoundingClientRect(),u=window.getComputedStyle(l),f=parseInt(u.borderTopWidth),E=parseInt(u.borderLeftWidth),T=parseInt(u.paddingTop),k=parseInt(u.paddingLeft);a.top+=c.top+(isNaN(f)?0:f)+(isNaN(T)?0:T),a.right+=c.left,a.bottom+=c.top,a.left+=c.left+(isNaN(E)?0:E)+(isNaN(k)?0:k)}),e.createResponse({action:"RETURN_BOXING",value:{boxing:a,resultId:e.value.resultId}}).send(!1)}static scrollIntoView(e){const t=Je(),{element:n}=t?.getResultById(e.value)??{};if(n!=null)n.scrollIntoView({behavior:"smooth",block:"center"});else if(t?.crossResults[e.value]!=null){const i=t.crossResults[e.value].iframes;i.length>0&&i[i.length-1].scrollIntoView({behavior:"smooth",block:"center"})}}static _hover(e){return this._simpleTrigger("mouseover",e)}static _appear(e){const{element:t}=Je()?.getResultById(e.value.resultId)??{};if(t==null)return;const n=()=>{if(dn(t)){if(this._respond(e),!e.value.once){const i=()=>{dn(t)?setTimeout(i,150):n()};setTimeout(i,150)}}else setTimeout(n,150)};n()}static _disappear(e){const{element:t}=Je()?.getResultById(e.value.resultId)??{};if(t==null)return null;const n=()=>{if(dn(t))setTimeout(n,150);else if(this._respond(e),!e.value.once){const i=()=>{dn(t)?n():setTimeout(i,150)};setTimeout(i,150)}};n()}static _change(e){const{element:t}=Je()?.getResultById(e.value.resultId)??{};if(t==null)return null;const n="value"in t?t.value:null,i=t.innerText,r=()=>{"value"in t&&t.value!==n||t.innerText!==i?this._respond(e):setTimeout(r,150)};r()}static _input(e){const{element:t}=Je()?.getResultById(e.value.resultId)??{};if(t==null)return null;let n;const i=()=>{clearTimeout(n),n=setTimeout(()=>{this._respond(e,"value"in t?t.value:null),e.value.once&&t.removeEventListener("keyup",i)},250)};t.addEventListener("keyup",i,{once:!!e.value.once})}static _remove(e){const{element:t}=Je()?.getResultById(e.value?.resultId)??{};if(!(t instanceof HTMLElement))return null;const n=new MutationObserver(i=>{i.forEach(r=>{if(r.removedNodes.length>0){const o=Array.from(r.removedNodes);(o.includes(t)||o.some(a=>a.contains(t)))&&(this._respond(e),n.disconnect())}})});return n.observe(document.body,{childList:!0,subtree:!0}),()=>{n.disconnect()}}static _simpleTrigger(e,t){const{element:n}=Je()?.getResultById(t.value.resultId)??{};if(n==null)return null;const i=!!t.value.once;n.addEventListener(e,()=>{this._respond(t)},{once:i})}static _respond(e,t=null){e.value.once?e.createResponse({action:"TRIGGER",value:t}).send(!1):new Ei(null,{action:"TRIGGER",streamId:e.payload.streamId,value:t}).send(!1)}static _parents(e,t=[]){return t.push(e),e.parentElement!=null?this._parents(e.parentElement,t):t}}const He=class He{constructor(e,t){const n=Je();if(n==null)throw new Error("Cross window is null, use setCross() before creating a cross beacon");this.container=e,this.window=n,this.targetId=t.value.targetId,this.options=t.value.options,this.spacing=5,this.beaconId=Cr(),this.listeners=[];const i=this.window?.getResultById(this.targetId);if(i==null)throw new Error("Could not find a result with the given targetId");this.target=i.element,this.element=this._createElement(),this.window.results[this.beaconId]={element:this.element,iframes:i.iframes};const r=At.elementToJSON(this.element);i.iframes.filter(Xe).forEach(o=>{const a=o.getBoundingClientRect();r.boxing.top+=a.top,r.boxing.right+=a.left,r.boxing.bottom+=a.top,r.boxing.left+=a.left}),t.createResponse({action:"CREATE_BEACON_RESPONSE",value:{targetId:this.targetId,beaconId:this.beaconId,...r}}).send(!1),He._instances.push(this)}render(){const e=this._getPosition();for(const t in e)this.element.style.setProperty(t,e[t]);this.element.style.visibility="hidden",this.container.appendChild(this.element),this.element.style.visibility="visible",this._setupScroll()}unmount(){this.element.remove(),this.listeners.splice(0).forEach(e=>{e()})}handleMessage(e){e.value.action==="render"?this.render():e.value.action==="unmount"&&this.unmount()}_createElement(){const e=document.createElement("div");e.setAttribute("style",this._beaconInlineStyles());let t="";switch(this.options.icon){case"info":t=He.ICON_INFO;break;case"question":t=He.ICON_QUESTION;break;case"danger":t=He.ICON_DANGER;break;case"message":t=He.ICON_MESSAGE;break;case"smiley":t=He.ICON_SMILEY;break}if(e.innerHTML+=t,e.querySelector("svg")?.setAttribute("style",this._svgInlineStyles()),e.style.visibility="hidden",this.options.label){const n=document.createElement("span");n.innerText=this.options.label,n.setAttribute("style",this._textInlineStyles()),e.appendChild(n)}return e}_beaconInlineStyles(){const e={small:20,medium:26,large:32},t={small:10,medium:13,large:16},n={top:"translateX(-50%) translateY(-100%) !important",right:"translateY(-50%) !important",bottom:"translateX(-50%) !important",left:"translateX(-100%) translateY(-50%) !important"},i=`${e[this.options.size??"medium"]}px`,r=`${t[this.options.size??"medium"]}px`,o=this.options.color??"#157ad8",a=this.options.text_color??"#fff",l=n[this.options.position];return`
			z-index: 2147483647 !important;
			display: inline-block !important;
			height: ${i} !important;
			min-width: ${i} !important;
			margin: 0 !important; padding: 0 !important;

			color: ${a};
			line-height: ${i} !important;
			font-family: Helvetica, Arial, sans-serif;

			background-color: ${o};

			border-radius: ${r} !important;

			overflow: hidden !important;
			cursor: pointer !important;

			transform: ${l};
		`.replace(/\n/g,"").replace(/\t/g,"")}_svgInlineStyles(){const t={small:{width:"20px",height:"14px",marginTop:"3px"},medium:{width:"26px",height:"18px",marginTop:"4px"},large:{width:"32px",height:"22px",marginTop:"5px"}}[this.options.size??"medium"];return`
			float: left !important;
			width: ${t.width} !important; height: ${t.height} !important;
			margin-top: ${t.marginTop} !important;

			background: none !important;
			box-shadow: none !important;
		`.replace(/\n/g,"").replace(/\t/g,"")}_textInlineStyles(){const t={small:{padding:"0 7px 0 0",fontSize:"12px"},medium:{padding:"0 12px 0 0",fontSize:"14px"},large:{padding:"0 15px 0 0",fontSize:"14px"}}[this.options.size??"medium"];return`
			display: block !important;
			float: left !important;
			padding: ${t.padding} !important;

			font-size: ${t.fontSize} !important;
			font-weight: normal !important;
		`.replace(/\n/g,"").replace(/\t/g,"")}_getPosition(){let e="auto";const t="auto",n="auto";let i="auto";const r="fixed",o=this.target.getBoundingClientRect();switch(this.options.position){case"top":i=`${o.left+o.width/2}px`,e=`${o.top-this.spacing}px`;break;case"right":i=`${o.left+o.width+this.spacing}px`,e=`${o.top+o.height/2}px`;break;case"bottom":i=`${o.left+o.width/2}px`,e=`${o.top+o.height+this.spacing}px`;break;case"left":i=`${o.left-this.spacing}px`,e=`${o.top+o.height/2}px`;break}return{top:e,right:t,bottom:n,left:i,position:r}}_setupScroll(){[window].concat(il(this.target)).forEach(t=>this.listeners.push(this._addScrollListener(t,()=>{const n=this._getPosition();for(const i in n)this.element.style.setProperty(i,n[i])})))}_addScrollListener(e,t){return e.addEventListener("scroll",t),()=>{e.removeEventListener("scroll",t)}}};He._instances=[],He.ICON_INFO='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path style="fill: currentColor;" d="M12.79,15.2A7.34,7.34,0,0,1,8.6,17.82c-.69,0-1.22-.47-.72-2.57L9.12,9.91c.12-.59.15-.83,0-.83a4.56,4.56,0,0,0-1.45.83l-.34-.67c1.72-1.59,3.48-2.52,4.34-2.52.69,0,.81.93.48,2.36l-1.36,5.53c-.17.69-.1.93.07.93a3.65,3.65,0,0,0,1.53-1ZM13.1,3.41a1.84,1.84,0,0,1-1.81,1.85c-.83,0-1.31-.54-1.33-1.47A1.81,1.81,0,0,1,11.77,2,1.29,1.29,0,0,1,13.1,3.41Z"/></svg>',He.ICON_SMILEY='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path style="fill: currentColor;" d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.507 13.941c-1.512 1.195-3.174 1.931-5.506 1.931-2.334 0-3.996-.736-5.508-1.931l-.493.493c1.127 1.72 3.2 3.566 6.001 3.566 2.8 0 4.872-1.846 5.999-3.566l-.493-.493zm-9.007-5.941c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5-.672-1.5-1.5-1.5zm7 0c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5-.672-1.5-1.5-1.5z"/></svg>',He.ICON_QUESTION='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" ><path style="fill: currentColor;" d="M5.71,8a4.2,4.2,0,0,1,4.34-4.41c3.36,0,4.45,2.09,4.45,3.45,0,3.41-2.95,2.95-3.25,5.11v.68H8.83v-.8c.25-3.1,2.92-2.81,2.86-4.74a1.4,1.4,0,0,0-1.52-1.61C8.89,5.71,8.33,6.77,8.33,8Zm2.87,5.9h2.81v2.75H8.58Z"/></svg>',He.ICON_MESSAGE='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.625 511.625"><path style="fill: currentColor;" d="M432.497,157.859c-18.216-22.387-42.959-40.071-74.224-53.049c-31.265-12.976-65.42-19.466-102.456-19.466 c-27.627,0-54.038,3.832-79.233,11.497c-25.196,7.665-46.9,18.024-65.115,31.078c-18.218,13.054-32.71,28.574-43.488,46.559 c-10.779,17.986-16.167,36.847-16.167,56.58c0,22.767,6.866,44.099,20.604,63.982c13.738,19.882,32.519,36.58,56.352,50.09 c-1.671,6.068-3.645,11.84-5.921,17.299c-2.277,5.465-4.326,9.947-6.147,13.438c-1.823,3.491-4.288,7.363-7.402,11.614 c-3.109,4.249-5.462,7.246-7.056,8.99c-1.592,1.746-4.211,4.635-7.855,8.651c-3.641,4.026-5.995,6.644-7.056,7.859 c-0.154,0.071-0.76,0.758-1.822,2.046c-1.062,1.289-1.594,1.934-1.594,1.934l-1.366,2.047c-0.76,1.14-1.101,1.86-1.027,2.158 c0.077,0.298-0.074,1.061-0.454,2.272c-0.381,1.219-0.342,2.13,0.113,2.738v0.228c0.61,2.733,1.938,4.933,3.986,6.599 c2.048,1.669,4.365,2.354,6.944,2.046c9.868-1.215,18.519-2.877,25.956-5.006c39.769-10.174,74.681-28.535,104.733-55.102 c11.381,1.214,22.386,1.822,33.012,1.822c37.034,0,71.189-6.489,102.456-19.472c31.268-12.976,56.009-30.66,74.221-53.044 c18.218-22.378,27.324-46.781,27.324-73.191C459.813,204.645,450.708,180.243,432.497,157.859z"/></svg>',He.ICON_DANGER='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 792"><path style="fill: currentColor;" d="M306,522.51c21.559,0,39.503-16.516,41.319-38l28.028-334.747c1.631-19.415-4.951-38.607-18.13-52.942 C344.056,82.505,325.468,74.347,306,74.347c-19.47,0-38.056,8.158-51.219,22.474c-13.181,14.335-19.76,33.527-18.128,52.942 l28.028,334.747C266.496,505.994,284.441,522.51,306,522.51z"/><path style="fill: currentColor;" d="M306,576.316c-30.198,0-54.669,24.469-54.669,54.668s24.471,54.668,54.669,54.668c30.197,0,54.669-24.469,54.669-54.668 S336.197,576.316,306,576.316z"/></svg>';let _i=He;function il(s,e=[]){return s===null?e:(e.push(s),s.parentElement!=null?il(s.parentElement,e):e)}async function Uf(s,e={}){if(ac()){const t=await fetch(s,{method:"GET",headers:e});return{body:await t.json(),status:t.status,statusText:t.statusText,headers:Object.fromEntries(t.headers.entries())}}return await Ln.runtime.sendMessage({action:"BACKGROUND_FETCH_V2",data:{url:s,options:{method:"GET",headers:e}}})}function Hf(s){throw new Error("Environment variables have not been set up. Please call setupExtensionEnv or setupDirectEnv first.")}const jf=3600*1e3;async function Zf(){H.debug("Getting the configuration");const s=await xt.getItem("local:configurationCache");let e,t;try{if(s!=null&&typeof s=="string"){const r=JSON.parse(s);t=r.timestamp,e=r.configuration}}catch(r){H.debug(r,{serialized:s},"A configuration was found in the cache, but an error occurred while parsing it, ignoring the cache")}const n=t==null||Date.now()-t>jf;if(e!==void 0&&!n)return H.debug({configuration:e,timestamp:t},"Using the cached configuration"),e;e!==void 0&&n&&H.debug({configuration:e,timestamp:t},"A configuration was found in the cache, but it is expired, ignoring it");const i=await qf();return xt.setItem("local:configurationCache",JSON.stringify({configuration:i,timestamp:Date.now()})),i}async function Gf(){try{const s=await xt.getItem("managed:configKey");return typeof s=="string"?s:null}catch(s){return H.warn(s,"An error occurred while trying to get the configKey from the cache, returning 'null' as a fallback"),null}}async function qf(){const s=await Gf();if(s==null)return H.debug("The extension is not managed by a Group Policy, returning 'null' for the configuration"),null;H.debug({configKey:s},"A configKey was found, fetching the configuration from the API");const e=new URLSearchParams({key:s});try{const{body:{success:t,configuration:n}}=await Uf(`${Hf("PLAYER_URL")}/configuration?${e.toString()}`,{"Content-Type":"application/x-www-form-urlencoded"});if(!t)throw new Error(`An error occurred while fetching the configuration from the API with configKey: "${s}"`);return n}catch(t){throw new Error(`Error while retrieving configuration from API: ${t.message}`)}}let Ar;async function rl(){if(Ar===void 0){const s=await Zf();Ar=s!=null&&"player_disabled"in s&&s.player_disabled===!0}return Ar}class Kf{constructor(e){this.depth=null,this.storageNamespace="local",this.results={},this.crossResults={},this.children=[],this.listeners=[],this.eventListeners={},this.observer=!1,this.container=e,this.id=Cr(8),xt.watch("local:CROSS_ACTION",t=>{if(t==null||typeof t!="object")return;const{messageId:n,from:i,to:r,inResponseTo:o,payload:a}=t;if(r!==this.id)return;const l=new Wf(n,i,a,o);switch(this.listeners.forEach(c=>{c(l)}),l.action){case"SET_DEPTH":this.setDepth(l);break;case"START_FINDER":l.createResponse({action:"START_FINDER_RESPONSE",value:!0}).send();break;case"FIND":At.find(l);break;case"SETUP_TRIGGER":Rr.setupTrigger(l);break;case"GET_BOXING":Rr.getBoxing(l);break;case"SCROLL_INTO_VIEW":Rr.scrollIntoView(l);break;case"IS_IN_VIEWPORT":{const c=this.getResultById(l.value)?.element;l.createResponse({action:"RESPOND_IS_IN_VIEWPORT",value:c==null?!1:dn(c)}).send(!1);break}case"IS_RENDERED":{const c=this.getResultById(l.value)?.element;l.createResponse({action:"RESPOND_RENDERED",value:c==null?!1:ut(c)}).send(!1);break}case"GET_TEXT":this.getText(l);break;case"CREATE_BEACON":new _i(this.container,l);break;case"BEACON_CONTROL":(()=>{const c=_i._instances.find(u=>u.beaconId===l.value.beaconId);c?.handleMessage(l)})();break}}),this.resolveDepth()}resolveDepth(){const e=JSON.stringify({action:"CROSS_DETERMINE_DEPTH",crossId:this.id,depth:1,width:window.innerWidth,height:window.innerHeight}),t=()=>{we.sendToParentFrame(e),setTimeout(()=>{this.depth==null&&t()},150)};rl().then(n=>{n?H.info("Player is disabled, not sending cross depth message"):t()}).catch(n=>{H.warn(n,"Error while checking if player is disabled")})}onMessage(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}}forward(e,t){rl().then(n=>{n?H.info("Player is disabled, cross forwarding cross is off"):we.addMessageListener(async i=>{this._actionFilter(i,e)&&new Promise(r=>{r(t(nl(i)))}).then(r=>{const o=JSON.stringify(r);we.sendToParentFrame(o)})})}).catch(n=>{H.warn(n,"Error while checking if player is disabled, cross forwarding is off")})}_actionFilter(e,t){try{const n=nl(e);return n!==null&&typeof n=="object"&&"action"in n&&n.action===t}catch(n){return H.debug(n,"Error while filtering message"),!1}}setDepth(e){this.depth=e.value}getText(e){const{element:t}=this.getResultById(e.value)??{},n=i=>{e.createResponse({action:"RESPOND_GET_TEXT",value:i}).send(!1)};t===void 0?n(""):t.tagName.toLowerCase()==="input"||t.tagName.toLowerCase()==="textarea"||t.tagName.toLowerCase()==="select"?n(t.value):n(t.innerText)}getResultById(e){return this.results[e]}pushCrossChild(e,t){this.children.findIndex(n=>n.crossId===e)>=0||(this.children.push({crossId:e,depth:()=>t+(this.depth??0)}),this.eventListeners.newChild!==void 0&&this.eventListeners.newChild.forEach(n=>{n(e)}))}addListener(e,t){return typeof t!="function"?()=>{}:(this.eventListeners[e]!==void 0?this.eventListeners[e].push(t):this.eventListeners[e]=[t],()=>{this.removeListener(e,t)})}removeListener(e,t){this.eventListeners[e]!==void 0&&(this.eventListeners[e]=this.eventListeners[e].filter(n=>n!==t))}}const Xf={matches:["<all_urls>"],registration:"runtime",async main(s){if(!window.lemonLearningCrossContentScriptAlreadyInjected&&(window.lemonLearningCrossContentScriptAlreadyInjected=!0,window.location.host!=="www.adpnet.esp.adp.com"&&window.location.host!=="www.linkedin.com"&&window.parent!==window)){let e=function(){Ln.runtime.sendMessage({action:"SHOULD_LAUNCH_LL_CROSS"}).then(n=>{n===null||typeof n!="object"||!("launch_ll_player"in n)||t(n.launch_ll_player)})},t=function(n=!1){if(!n)return;const i=new Kf(Zt());i.forward("CROSS_DETERMINE_DEPTH",r=>(i.pushCrossChild(r.crossId,r.depth),{...r,depth:r.depth+1})),i.forward("CROSS_RESPONSE",r=>{if(r.payload.action==="RETURN_BOXING"){const{resultId:o}=r.payload.value;i.crossResults[o]!==void 0&&i.crossResults[o].iframes.filter(Xe).forEach(a=>{const l=a.getBoundingClientRect();r.payload.value.boxing.top+=l.top,r.payload.value.boxing.right+=l.left,r.payload.value.boxing.bottom+=l.top,r.payload.value.boxing.left+=l.left})}return r}),Vf(i)};zf(),Ln.runtime.onMessage.addListener((n,i)=>{i.id===Ln.runtime.id&&(typeof n!="object"||n===null||typeof n.action=="string"&&n.action==="EXECUTE_LL_LAUNCH_CROSS"&&e())}),e()}}};function Ti(s,...e){}const Yf={debug:(...s)=>Ti(console.debug,...s),log:(...s)=>Ti(console.log,...s),warn:(...s)=>Ti(console.warn,...s),error:(...s)=>Ti(console.error,...s)};class Or extends Event{constructor(e,t){super(Or.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=t}static EVENT_NAME=Lr("wxt:locationchange")}function Lr(s){return`${Ln?.runtime?.id}:cross:${s}`}function Jf(s){let e,t;return{run(){e==null&&(t=new URL(location.href),e=s.setInterval(()=>{let n=new URL(location.href);n.href!==t.href&&(window.dispatchEvent(new Or(n,t)),t=n)},1e3))}}}class xi{constructor(e,t){this.contentScriptName=e,this.options=t,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=Lr("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=Jf(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return Ln.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,t){const n=setInterval(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(e,t){const n=setTimeout(()=>{this.isValid&&e()},t);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(e){const t=requestAnimationFrame((...n)=>{this.isValid&&e(...n)});return this.onInvalidated(()=>cancelAnimationFrame(t)),t}requestIdleCallback(e,t){const n=requestIdleCallback((...i)=>{this.signal.aborted||e(...i)},t);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(e,t,n,i){t==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(t.startsWith("wxt:")?Lr(t):t,n,{...i,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Yf.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:xi.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const t=e.data?.type===xi.SCRIPT_STARTED_MESSAGE_TYPE,n=e.data?.contentScriptName===this.contentScriptName,i=!this.receivedMessageIds.has(e.data?.messageId);return t&&n&&i}listenForNewerScripts(e){let t=!0;const n=i=>{if(this.verifyScriptStartedEvent(i)){this.receivedMessageIds.add(i.data.messageId);const r=t;if(t=!1,r&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}}function Up(){}function Si(s,...e){}const Qf={debug:(...s)=>Si(console.debug,...s),log:(...s)=>Si(console.log,...s),warn:(...s)=>Si(console.warn,...s),error:(...s)=>Si(console.error,...s)};return(async()=>{try{const{main:s,...e}=Xf,t=new xi("cross",e);return await s(t)}catch(s){throw Qf.error('The content script "cross" crashed on startup!',s),s}})()})();
cross;